<!DOCTYPE html>
<html lang="zh" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Go æ¡†æ¶ Iris æ–‡æ¡£ | liiqii</title>
<meta name="keywords" content="">
<meta name="description" content="Go æ¡†æ¶ Iris æ–‡æ¡£ç¿»è¯‘ï¼ŒIrisæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„è½¯ä»¶ã€‚">
<meta name="author" content="liiqii">
<link rel="canonical" href="https://liiqii.github.io/posts/tech/go/go_iris/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.css" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.js" onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://liiqii.github.io/img/icon.jpg">
<link rel="icon" type="image/png" sizes="16x16" href="https://liiqii.github.io/img/icon.jpg">
<link rel="icon" type="image/png" sizes="32x32" href="https://liiqii.github.io/img/icon.jpg">
<link rel="apple-touch-icon" href="https://liiqii.github.io/img/icon.jpg">
<link rel="mask-icon" href="https://liiqii.github.io/img/icon.jpg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
<script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.3/dist/jquery.min.js"></script>



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = ""; 
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<meta property="og:title" content="Go æ¡†æ¶ Iris æ–‡æ¡£" />
<meta property="og:description" content="Go æ¡†æ¶ Iris æ–‡æ¡£ç¿»è¯‘ï¼ŒIrisæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„è½¯ä»¶ã€‚" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://liiqii.github.io/posts/tech/go/go_iris/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-10-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-10-10T00:00:00+00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Go æ¡†æ¶ Iris æ–‡æ¡£"/>
<meta name="twitter:description" content="Go æ¡†æ¶ Iris æ–‡æ¡£ç¿»è¯‘ï¼ŒIrisæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„è½¯ä»¶ã€‚"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [

        {
          "@type": "ListItem",
          "position":  1 ,
          "name": "ğŸ“šæ–‡ç« ",
          "item": "https://liiqii.github.io/posts/"
        },

        {
          "@type": "ListItem",
          "position":  2 ,
          "name": "ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯",
          "item": "https://liiqii.github.io/posts/tech/"
        }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "Go æ¡†æ¶ Iris æ–‡æ¡£",
      "item": "https://liiqii.github.io/posts/tech/go/go_iris/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Go æ¡†æ¶ Iris æ–‡æ¡£",
  "name": "Go æ¡†æ¶ Iris æ–‡æ¡£",
  "description": "Go æ¡†æ¶ Iris æ–‡æ¡£ç¿»è¯‘ï¼ŒIrisæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„è½¯ä»¶ã€‚",
  "keywords": [
    ""
  ],
  "articleBody": "è½¬è‡ªï¼šIris\nå®‰è£… Irisæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„è½¯ä»¶ã€‚\nå”¯ä¸€çš„è¦æ±‚æ˜¯ Go ç¼–ç¨‹è¯­è¨€ï¼Œç‰ˆæœ¬ 1.20 åŠæ›´é«˜ç‰ˆæœ¬ã€‚\n$ mkdir myapp $ cd myapp $ go mod init myapp $ go get github.com/kataras/iris/v12@latest å°†å…¶å¯¼å…¥åˆ°ä»£ç ä¸­ï¼š\nimport \"github.com/kataras/iris/v12\" æ•…éšœ æ’é™¤ å¦‚æœåœ¨å®‰è£…è¿‡ç¨‹ä¸­é‡åˆ°ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¡®ä¿è®¾ç½®äº†æœ‰æ•ˆçš„ GOPROXY ç¯å¢ƒå˜é‡ã€‚\ngo env -w GOPROXY=https://goproxy.io,direct å¦‚æœä¸Šè¿°æ–¹æ³•å‡æ— æ•ˆï¼Œè¯·æ¸…ç† go æ¨¡å—ç¼“å­˜ï¼š\ngo clean --modcache å¿«é€Ÿå…¥é—¨ # assume the following codes in main.go file $ cat main.go package main import \"github.com/kataras/iris/v12\" func main() { app := iris.New() booksAPI := app.Party(\"/books\") { booksAPI.Use(iris.Compression) // GET: http://localhost:8080/books booksAPI.Get(\"/\", list) // POST: http://localhost:8080/books booksAPI.Post(\"/\", create) } app.Listen(\":8080\") } // Book example. type Book struct { Title string `json:\"title\"` } func list(ctx iris.Context) { books := []Book{ {\"Mastering Concurrency in Go\"}, {\"Go Design Patterns\"}, {\"Black Hat Go\"}, } ctx.JSON(books) // TIP: negotiate the response between server's prioritizes // and client's requirements, instead of ctx.JSON: // ctx.Negotiation().JSON().MsgPack().Protobuf() // ctx.Negotiate(books) } func create(ctx iris.Context) { var b Book err := ctx.ReadJSON(\u0026b) // TIP: use ctx.ReadBody(\u0026b) to bind // any type of incoming data instead. if err != nil { ctx.StopWithProblem(iris.StatusBadRequest, iris.NewProblem(). Title(\"Book creation failure\").DetailErr(err)) // TIP: use ctx.StopWithError(code, err) when only // plain text responses are expected on errors. return } println(\"Received Book: \" + b.Title) ctx.StatusCode(iris.StatusCreated) } MVC ç­‰æ•ˆé¡¹ï¼š\nimport \"github.com/kataras/iris/v12/mvc\" m := mvc.New(booksAPI) m.Handle(new(BookController)) type BookController struct { /* dependencies */ } // GET: http://localhost:8080/books func (c *BookController) Get() []Book { return []Book{ {\"Mastering Concurrency in Go\"}, {\"Go Design Patterns\"}, {\"Black Hat Go\"}, } } // POST: http://localhost:8080/books func (c *BookController) Post(b Book) int { println(\"Received Book: \" + b.Title) return iris.StatusCreated } è¿è¡Œæ‚¨çš„é¸¢å°¾èŠ±ç½‘ç»œæœåŠ¡å™¨ï¼š\n$ go run main.go \u003e Now listening on: http://localhost:8080 \u003e Application started. Press CTRL+C to shut down. åˆ—è¡¨ä¹¦ï¼š\n$ curl --header 'Accept-Encoding:gzip' http://localhost:8080/books [ { \"title\": \"Mastering Concurrency in Go\" }, { \"title\": \"Go Design Patterns\" }, { \"title\": \"Black Hat Go\" } ] åˆ›å»ºæ–°å›¾ä¹¦ï¼š\n$ curl -i -X POST \\ --header 'Content-Encoding:gzip' \\ --header 'Content-Type:application/json' \\ --data \"{\\\"title\\\":\\\"Writing An Interpreter In Go\\\"}\" \\ http://localhost:8080/books \u003e HTTP/1.1 201 Created è¿™å°±æ˜¯é”™è¯¯å“åº”çš„æ ·å­ï¼š\n$ curl -X POST --data \"{\\\"title\\\" \\\"not valid one\\\"}\" \\ http://localhost:8080/books \u003e HTTP/1.1 400 Bad Request { \"status\": 400, \"title\": \"Book creation failure\" \"detail\": \"invalid character '\\\"' after object key\", } åŸºå‡† Irisä½¿ç”¨muxieçš„è‡ªå®šä¹‰ç‰ˆæœ¬ã€‚\næŸ¥çœ‹æ‰€æœ‰åŸºå‡†\nğŸ“– ä½¿ç”¨ int çš„åŠ¨æ€å‚æ•°è§¦å‘ 200000 ä¸ªè¯·æ±‚ï¼Œå°† JSON ä½œä¸ºè¯·æ±‚æ­£æ–‡å‘é€ï¼Œå¹¶æ¥æ”¶ JSON ä½œä¸ºå“åº”ã€‚\nåå­— è¯­è¨€ è¦æ±‚/ç§’ å»¶è¿Ÿ ååé‡ å®Œæˆæ—¶é—´ è™¹è†œ å» 238954 521.69ä¹Œç§’ 64.15å…†å­—èŠ‚ 0.84ç§’ ç´é…’ å» 229665 541.96ä¹Œç§’ 62.86å…†å­—èŠ‚ 0.87ç§’ æ±  å» 228072 545.78ä¹Œç§’ 62.61å…†å­—èŠ‚ 0.88ç§’ å›æ³¢ å» 224491 553.84ä¹Œç§’ 61.70å…†å­—èŠ‚ 0.89ç§’ é©¬æå°¼é…’ å» 198166 627.46ä¹Œç§’ 54.47å…†å­—èŠ‚ 1.01ç§’ èŒ¶éš¼ C# 163486 766.90ä¹Œç§’ 47.42å…†å­—èŠ‚ 1.23ç§’ æ°´ç‰› å» 102478 1.22æ¯«ç§’ 28.14å…†å­—èŠ‚ 1.95ç§’ ç§‘é˜¿ çˆªå“‡è¯­ 48425 2.56æ¯«ç§’ 15.39å…†å­—èŠ‚ 4.14ç§’ è¡¨è¾¾ çˆªå“‡è¯­ 23622 5.25æ¯«ç§’ 9.04å…†å­—èŠ‚ 8.41ç§’ æ¥å£ç¤ºä¾‹ æ‚¨å¯ä»¥åœ¨ Iris ç¤ºä¾‹å­˜å‚¨åº“ä¸­æ‰¾åˆ°è®¸å¤šéšæ—¶å¯ä»¥è¿è¡Œçš„ç¤ºä¾‹ã€‚\nä½¿ç”¨è·å–ã€å‘å¸ƒã€æ”¾ç½®ã€ä¿®è¡¥ã€åˆ é™¤å’Œé€‰é¡¹ func main() { // Creates an iris application with default middleware: // Default with \"debug\" Logger Level. // Localization enabled on \"./locales\" directory // and HTML templates on \"./views\" or \"./templates\" directory. // It runs with the AccessLog on \"./access.log\", // Recovery (crash-free) and Request ID middleware already attached. app := iris.Default() app.Get(\"/someGet\", getting) app.Post(\"/somePost\", posting) app.Put(\"/somePut\", putting) app.Delete(\"/someDelete\", deleting) app.Patch(\"/somePatch\", patching) app.Header(\"/someHead\", head) app.Options(\"/someOptions\", options) app.Listen(\":8080\") } è·¯å¾„ä¸­çš„å‚æ•° func main() { app := iris.Default() // This handler will match /user/john but will not match /user/ or /user app.Get(\"/user/{name}\", func(ctx iris.Context) { name := ctx.Params().Get(\"name\") ctx.Writef(\"Hello %s\", name) }) // However, this one will match /user/john/ and also /user/john/send // If no other routers match /user/john, it will redirect to /user/john/ app.Get(\"/user/{name}/{action:path}\", func(ctx iris.Context) { name := ctx.Params().Get(\"name\") action := ctx.Params().Get(\"action\") message := name + \" is \" + action ctx.WriteString(message) }) // For each matched request Context will hold the route definition app.Post(\"/user/{name:string}/{action:path}\", func(ctx iris.Context) { ctx.GetCurrentRoute().Tmpl().Src == \"/user/{name:string}/{action:path}\" // true }) app.Listen(\":8080\") } å†…ç½®å¯ç”¨å‚æ•°ç±»å‹ï¼š\nå‚æ•°ç±»å‹ å»ç±»å‹ éªŒè¯ æ£€ç´¢å¸®åŠ©ç¨‹åº :string å­—ç¬¦ä¸² ä»»ä½•ï¼ˆå•è·¯å¾„æ®µï¼‰ Params().Get :uuid å­—ç¬¦ä¸² uuidv4 æˆ– v1ï¼ˆå•è·¯å¾„æ®µï¼‰ Params().Get :int å›½é™… -9223372036854775808 åˆ° 9223372036854775807 ï¼ˆx64ï¼‰ æˆ– -2147483648 åˆ° 2147483647 ï¼ˆx32ï¼‰ï¼Œå–å†³äºä¸»æœºæ¶æ„ Params().GetInt :int8 å›½é™…8 -128 åˆ° 127 Params().GetInt8 :int16 å›½é™…16 -32768 åˆ° 32767 Params().GetInt16 :int32 å›½é™…32 -2147483648 åˆ° 2147483647 Params().GetInt32 :int64 å›½é™…64 -9223372036854775808 åˆ° 9223372036854775807 Params().GetInt64 :uint ä¹Œå› ç‰¹ 0 åˆ° 18446744073709551615 ï¼ˆx64ï¼‰ æˆ– 0 åˆ° 4294967295 ï¼ˆx32ï¼‰ï¼Œå–å†³äºä¸»æœºæ¶æ„ Params().GetUint :uint8 uint8 0 åˆ° 255 Params().GetUint8 :uint16 uint16 0 åˆ° 65535 Params().GetUint16 :uint32 uint32 0 åˆ° 4294967295 Params().GetUint32 :uint64 uint64 0 åˆ° 18446744073709551615 Params().GetUint64 :bool å¸ƒå°” â€œ1â€æˆ–â€œtâ€æˆ–â€œTâ€æˆ–â€œçœŸâ€æˆ–â€œçœŸâ€æˆ–â€œçœŸâ€æˆ–â€œ0â€æˆ–â€œfâ€æˆ–â€œFâ€æˆ–â€œå‡â€æˆ–â€œå‡â€æˆ–â€œå‡â€ Params().GetBool :alphabetical å­—ç¬¦ä¸² å°å†™æˆ–å¤§å†™å­—æ¯ Params().Get :file å­—ç¬¦ä¸² å°å†™æˆ–å¤§å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ ï¼ˆ_ï¼‰ã€çŸ­åˆ’çº¿ ï¼ˆ-ï¼‰ã€ç‚¹ ï¼ˆ.ï¼‰ å¹¶ä¸”æ²¡æœ‰ç©ºæ ¼æˆ–å…¶ä»–å¯¹æ–‡ä»¶åæ— æ•ˆçš„ç‰¹æ®Šå­—ç¬¦ Params().Get :path å­—ç¬¦ä¸² ä»»ä½•å†…å®¹éƒ½å¯ä»¥ç”¨æ–œæ ï¼ˆè·¯å¾„æ®µï¼‰åˆ†éš”ï¼Œä½†åº”è¯¥æ˜¯è·¯ç”±è·¯å¾„çš„æœ€åä¸€éƒ¨åˆ† Params().Get :mail å­—ç¬¦ä¸² æœªç»åŸŸéªŒè¯çš„ç”µå­é‚®ä»¶ Params().Get :email å­—ç¬¦ä¸² å…·æœ‰åŸŸéªŒè¯åŠŸèƒ½çš„ç”µå­é‚®ä»¶ Params().Get :date å­—ç¬¦ä¸² å¹´/æœˆ/æ—¥æ ¼å¼ï¼Œä¾‹å¦‚ /åšå®¢/{å‚æ•°ï¼šæ—¥æœŸ} åŒ¹é… /åšå®¢/2022/04/21 Params().GetTimeå’ŒParams().SimpleDate :weekday uint ï¼ˆ0-6ï¼‰ æˆ–å­—ç¬¦ä¸² æ—¶é—´ä¸²ã€‚å·¥ä½œæ—¥é•¿åç§°æ ¼å¼ï¼ˆâ€œæ˜ŸæœŸæ—¥â€åˆ°â€œæ˜ŸæœŸä¸€â€æˆ–â€œæ˜ŸæœŸæ—¥â€åˆ°â€œæ˜ŸæœŸä¸€â€ï¼‰æ ¼å¼ï¼Œä¾‹å¦‚ /schedule/{paramï¼šweekday} åŒ¹é… /schedule/æ˜ŸæœŸä¸€ Params().GetWeekday æ›´å¤šç¤ºä¾‹å¯åœ¨ä»¥ä¸‹ä½ç½®æ‰¾åˆ°ï¼š_examples/è·¯ç”±ã€‚\næŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•° func main() { app := iris.Default() // Query string parameters are parsed using the existing underlying request object. // The request responds to a url matching: /welcome?firstname=Jane\u0026lastname=Doe app.Get(\"/welcome\", func(ctx iris.Context) { firstname := ctx.URLParamDefault(\"firstname\", \"Guest\") lastname := ctx.URLParam(\"lastname\") // shortcut for ctx.Request().URL.Query().Get(\"lastname\") ctx.Writef(\"Hello %s %s\", firstname, lastname) }) app.Listen(\":8080\") } å¤šéƒ¨åˆ†/ä¹Œä¼¦ç¼–ç å½¢å¼ func main() { app := iris.Default() app.Post(\"/form_post\", func(ctx iris.Context) { message := ctx.PostValue(\"message\") nick := ctx.PostValueDefault(\"nick\", \"anonymous\") ctx.JSON(iris.Map{ \"status\": \"posted\", \"message\": message, \"nick\": nick, }) }) app.Listen(\":8080\") } å†æ¯”å¦‚ï¼šæŸ¥è¯¢+å¸–å­è¡¨å• POST /post?id=1234\u0026page=1 HTTP/1.1 Content-Type: application/x-www-form-urlencoded name=kataras\u0026message=this_is_great func main() { app := iris.Default() app.Post(\"/post\", func(ctx iris.Context) { id, err := ctx.URLParamInt(\"id\", 0) if err != nil { ctx.StopWithError(iris.StatusBadRequest, err) return } page := ctx.URLParamIntDefault(\"page\", 0) name := ctx.PostValue(\"name\") message := ctx.PostValue(\"message\") ctx.Writef(\"id: %d; page: %d; name: %s; message: %s\", id, page, name, message) }) app.Listen(\":8080\") } id: 1234; page: 1; name: kataras; message: this_is_great (adsbygoogle = window.adsbygoogle || []).push({});\næŸ¥è¯¢å’Œå‘å¸ƒè¡¨å•å‚æ•° POST /post?id=a\u0026id=b\u0026id=c\u0026name=john\u0026name=doe\u0026name=kataras Content-Type: application/x-www-form-urlencoded func main() { app := iris.Default() app.Post(\"/post\", func(ctx iris.Context) { ids := ctx.URLParamSlice(\"id\") names, err := ctx.PostValues(\"name\") if err != nil { ctx.StopWithError(iris.StatusBadRequest, err) return } ctx.Writef(\"ids: %v; names: %v\", ids, names) }) app.Listen(\":8080\") } ids: [a b c], names: [john doe kataras] ä¸Šä¼ æ–‡ä»¶ å•ä¸ªæ–‡ä»¶ const maxSize = 8 * iris.MB func main() { app := iris.Default() app.Post(\"/upload\", func(ctx iris.Context) { // Set a lower memory limit for multipart forms (default is 32 MiB) ctx.SetMaxRequestBodySize(maxSize) // OR // app.Use(iris.LimitRequestBodySize(maxSize)) // OR // OR iris.WithPostMaxMemory(maxSize) // single file file, fileHeader, err:= ctx.FormFile(\"file\") if err != nil { ctx.StopWithError(iris.StatusBadRequest, err) return } // Upload the file to specific destination. dest := filepath.Join(\"./uploads\", fileHeader.Filename) ctx.SaveFormFile(fileHeader, dest) ctx.Writef(\"File: %s uploaded!\", fileHeader.Filename) }) app.Listen(\":8080\") } å¦‚ä½•ï¼šcurl\ncurl -X POST http://localhost:8080/upload \\ -F \"file=@/Users/kataras/test.zip\" \\ -H \"Content-Type: multipart/form-data\" å¤šä¸ªæ–‡ä»¶ è¯·å‚é˜…è¯¦ç»†çš„ç¤ºä¾‹ä»£ç ã€‚\nfunc main() { app := iris.Default() app.Post(\"/upload\", func(ctx iris.Context) { files, n, err := ctx.UploadFormFiles(\"./uploads\") if err != nil { ctx.StopWithStatus(iris.StatusInternalServerError) return } ctx.Writef(\"%d files of %d total size uploaded!\", len(files), n)) }) app.Listen(\":8080\", iris.WithPostMaxMemory(8 * iris.MB)) } å¦‚ä½•ï¼šcurl\ncurl -X POST http://localhost:8080/upload \\ -F \"upload[]=@/Users/kataras/test1.zip\" \\ -F \"upload[]=@/Users/kataras/test2.zip\" \\ -H \"Content-Type: multipart/form-data\" å¯¹è·¯çº¿è¿›è¡Œåˆ†ç»„ func main() { app := iris.Default() // Simple group: v1 v1 := app.Party(\"/v1\") { v1.Post(\"/login\", loginEndpoint) v1.Post(\"/submit\", submitEndpoint) v1.Post(\"/read\", readEndpoint) } // Simple group: v2 v2 := app.Party(\"/v2\") { v2.Post(\"/login\", loginEndpoint) v2.Post(\"/submit\", submitEndpoint) v2.Post(\"/read\", readEndpoint) } app.Listen(\":8080\") } é»˜è®¤ä¸å¸¦ä¸­é—´ä»¶çš„ç©ºç™½å…‰åœˆ ç”¨\napp := iris.New() è€Œä¸æ˜¯\n// Default with \"debug\" Logger Level. // Localization enabled on \"./locales\" directory // and HTML templates on \"./views\" or \"./templates\" directory. // It runs with the AccessLog on \"./access.log\", // Recovery and Request ID middleware already attached. app := iris.Default() ä½¿ç”¨ä¸­é—´ä»¶ package main import ( \"github.com/kataras/iris/v12\" \"github.com/kataras/iris/v12/middleware/recover\" ) func main() { // Creates an iris application without any middleware by default app := iris.New() // Global middleware using `UseRouter`. // // Recovery middleware recovers from any panics and writes a 500 if there was one. app.UseRouter(recover.New()) // Per route middleware, you can add as many as you desire. app.Get(\"/benchmark\", MyBenchLogger(), benchEndpoint) // Authorization group // authorized := app.Party(\"/\", AuthRequired()) // exactly the same as: authorized := app.Party(\"/\") // per group middleware! in this case we use the custom created // AuthRequired() middleware just in the \"authorized\" group. authorized.Use(AuthRequired()) { authorized.Post(\"/login\", loginEndpoint) authorized.Post(\"/submit\", submitEndpoint) authorized.Post(\"/read\", readEndpoint) // nested group testing := authorized.Party(\"testing\") testing.Get(\"/analytics\", analyticsEndpoint) } // Listen and serve on 0.0.0.0:8080 app.Listen(\":8080\") } (adsbygoogle = window.adsbygoogle || []).push({});\nåº”ç”¨ç¨‹åºæ–‡ä»¶è®°å½•å™¨ func main() { app := iris.Default() // Logging to a file. // Colors are automatically disabled when writing to a file. f, _ := os.Create(\"iris.log\") app.Logger().SetOutput(f) // Use the following code if you need to write the logs // to file and console at the same time. // app.Logger().AddOutput(os.Stdout) app.Get(\"/ping\", func(ctx iris.Context) { ctx.WriteString(\"pong\") }) app.Listen(\":8080\") } æ§åˆ¶æ—¥å¿—è¾“å‡ºç€è‰² é»˜è®¤æƒ…å†µä¸‹ï¼Œæ§åˆ¶å°ä¸Šçš„æ—¥å¿—è¾“å‡ºåº”æ ¹æ®æ£€æµ‹åˆ°çš„ TTY è¿›è¡Œç€è‰²ã€‚\nè‡ªå®šä¹‰å…³å¡æ ‡é¢˜ï¼Œæ–‡æœ¬ï¼Œé¢œè‰²å’Œæ ·å¼ã€‚\nå¯¼å…¥å’Œ ï¼šgolog``pio\nimport ( \"github.com/kataras/golog\" \"github.com/kataras/pio\" // [...] ) è·å–è¦è‡ªå®šä¹‰çš„çº§åˆ«ï¼Œä¾‹å¦‚ï¼šDebugLevel\nlevel := golog.Levels[golog.DebugLevel] æ‚¨å¯ä»¥å®Œå…¨æ§åˆ¶ä»–çš„æ–‡å­—ã€æ ‡é¢˜å’Œé£æ ¼ï¼š\n// The Name of the Level // that named (lowercased) will be used // to convert a string level on `SetLevel` // to the correct Level type. Name string // AlternativeNames are the names that can be referred to this specific log level. // i.e Name = \"warn\" // AlternativeNames = []string{\"warning\"}, it's an optional field, // therefore we keep Name as a simple string and created this new field. AlternativeNames []string // Tha Title is the prefix of the log level. // See `ColorCode` and `Style` too. // Both `ColorCode` and `Style` should be respected across writers. Title string // ColorCode a color for the `Title`. ColorCode int // Style one or more rich options for the `Title`. Style []pio.RichOption ç¤ºä¾‹ä»£ç ï¼š\nlevel := golog.Levels[golog.DebugLevel] level.Name = \"debug\" // default level.Title = \"[DBUG]\" // default level.ColorCode = pio.Yellow // default è¦æ›´æ”¹è¾“å‡ºæ ¼å¼ï¼š\napp.Logger().SetFormat(\"json\", \" \") æ³¨å†Œè‡ªå®šä¹‰æ ¼å¼åŒ–ç¨‹åºï¼š\napp.Logger().RegisterFormatter(new(myFormatter)) å˜Ÿå˜Ÿã€‚æ ¼å¼åŒ–ç¨‹åºç•Œé¢å¦‚ä¸‹æ‰€ç¤ºï¼š\n// Formatter is responsible to print a log to the logger's writer. type Formatter interface { // The name of the formatter. String() string // Set any options and return a clone, // generic. See `Logger.SetFormat`. Options(opts ...interface{}) Formatter // Writes the \"log\" to \"dest\" logger. Format(dest io.Writer, log *Log) bool } è¦æ›´æ”¹æ¯ä¸ªçº§åˆ«çš„è¾“å‡ºå’Œæ ¼å¼ï¼š\napp.Logger().SetLevelOutput(\"error\", os.Stderr) app.Logger().SetLevelFormat(\"json\") è¯·æ±‚æ—¥å¿—è®°å½• æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°çš„åº”ç”¨ç¨‹åºè®°å½•å™¨ç”¨äºè®°å½•ä¸åº”ç”¨ç¨‹åºç›¸å…³çš„ä¿¡æ¯å’Œé”™è¯¯ã€‚å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬åœ¨ä¸‹é¢çœ‹åˆ°çš„è®¿é—®è®°å½•å™¨ç”¨äºè®°å½•ä¼ å…¥çš„HTTPè¯·æ±‚å’Œå“åº”ã€‚\npackage main import ( \"os\" \"github.com/kataras/iris/v12\" \"github.com/kataras/iris/v12/middleware/accesslog\" ) // Read the example and its comments carefully. func makeAccessLog() *accesslog.AccessLog { // Initialize a new access log middleware. ac := accesslog.File(\"./access.log\") // Remove this line to disable logging to console: ac.AddOutput(os.Stdout) // The default configuration: ac.Delim = '|' ac.TimeFormat = \"2006-01-02 15:04:05\" ac.Async = false ac.IP = true ac.BytesReceivedBody = true ac.BytesSentBody = true ac.BytesReceived = false ac.BytesSent = false ac.BodyMinify = true ac.RequestBody = true ac.ResponseBody = false ac.KeepMultiLineError = true ac.PanicLog = accesslog.LogHandler // Default line format if formatter is missing: // Time|Latency|Code|Method|Path|IP|Path Params Query Fields|Bytes Received|Bytes Sent|Request|Response| // // Set Custom Formatter: ac.SetFormatter(\u0026accesslog.JSON{ Indent: \" \", HumanTime: true, }) // ac.SetFormatter(\u0026accesslog.CSV{}) // ac.SetFormatter(\u0026accesslog.Template{Text: \"{{.Code}}\"}) return ac } func main() { ac := makeAccessLog() defer ac.Close() // Close the underline file. app := iris.New() // Register the middleware (UseRouter to catch http errors too). app.UseRouter(ac.Handler) app.Get(\"/\", indexHandler) app.Listen(\":8080\") } func indexHandler(ctx iris.Context) { ctx.WriteString(\"OK\") } é˜…è¯»æ›´å¤šç¤ºä¾‹ï¼š_examples/logging/request-loggerã€‚\n(adsbygoogle = window.adsbygoogle || []).push({});\næ¨¡å‹ç»‘å®šå’ŒéªŒè¯ è‹¥è¦å°†è¯·æ±‚æ­£æ–‡ç»‘å®šåˆ°ç±»å‹ä¸­ï¼Œè¯·ä½¿ç”¨æ¨¡å‹ç»‘å®šã€‚æˆ‘ä»¬ç›®å‰æ”¯æŒç»‘å®šã€ã€ã€ã€å’Œæ ‡å‡†è¡¨å•å€¼ï¼ˆfoo=bar\u0026boo=bazï¼‰ã€‚JSON``JSONProtobuf``Protobuf``MsgPack``XML``YAML\nReadJSON(outPtr interface{}) error ReadJSONProtobuf(ptr proto.Message, opts ...ProtoUnmarshalOptions) error ReadProtobuf(ptr proto.Message) error ReadMsgPack(ptr interface{}) error ReadXML(outPtr interface{}) error ReadYAML(outPtr interface{}) error ReadForm(formObject interface{}) error ReadQuery(ptr interface{}) error ä½¿ç”¨ æ—¶ï¼ŒIris ä¼šå°è¯•æ ¹æ®å†…å®¹ç±»å‹æ ‡å¤´æ¨æ–­ç»‘å®šç¨‹åºã€‚å¦‚æœæ‚¨ç¡®å®šè¦ç»‘å®šçš„å†…å®¹ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç‰¹å®šæ–¹æ³•ï¼Œä¾‹å¦‚ æˆ–å’Œç­‰ReadBody``ReadXXX``ReadJSON``ReadProtobuf\nReadBody(ptr interface{}) error æ˜æ™ºçš„æ˜¯ï¼ŒIrisæ²¡æœ‰å†…ç½®çš„æ•°æ®éªŒè¯åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œå®ƒç¡®å®å…è®¸æ‚¨é™„åŠ ä¸€ä¸ªéªŒè¯å™¨ï¼Œè¯¥éªŒè¯å™¨å°†è‡ªåŠ¨è°ƒç”¨è¯¸å¦‚ ï¼Œ â€¦.åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ go-playground/validator/v10 è¿›è¡Œè¯·æ±‚æ­£æ–‡éªŒè¯ã€‚ReadJSON``ReadXML\nè¯·æ³¨æ„ï¼Œæ‚¨éœ€è¦åœ¨è¦ç»‘å®šçš„æ‰€æœ‰å­—æ®µä¸Šè®¾ç½®ç›¸åº”çš„ç»‘å®šæ ‡è®°ã€‚ä¾‹å¦‚ï¼Œä» JSON ç»‘å®šæ—¶ï¼Œè®¾ç½® .json:\"fieldname\"\næ‚¨è¿˜å¯ä»¥æŒ‡å®šç‰¹å®šå­—æ®µä¸ºå¿…å¡«å­—æ®µã€‚å¦‚æœå­—æ®µåœ¨ç»‘å®šæ—¶ç”¨ç©ºå€¼ä¿®é¥°ï¼Œå¹¶ä¸”å€¼ä¸ºç©ºï¼Œåˆ™ä¼šè¿”å›é”™è¯¯ã€‚binding:\"required\"\npackage main import ( \"fmt\" \"github.com/kataras/iris/v12\" \"github.com/go-playground/validator/v10\" ) func main() { app := iris.New() app.Validator = validator.New() userRouter := app.Party(\"/user\") { userRouter.Get(\"/validation-errors\", resolveErrorsDocumentation) userRouter.Post(\"/\", postUser) } app.Listen(\":8080\") } // User contains user information. type User struct { FirstName string `json:\"fname\" validate:\"required\"` LastName string `json:\"lname\" validate:\"required\"` Age uint8 `json:\"age\" validate:\"gte=0,lte=130\"` Email string `json:\"email\" validate:\"required,email\"` FavouriteColor string `json:\"favColor\" validate:\"hexcolor|rgb|rgba\"` Addresses []*Address `json:\"addresses\" validate:\"required,dive,required\"` } // Address houses a users address information. type Address struct { Street string `json:\"street\" validate:\"required\"` City string `json:\"city\" validate:\"required\"` Planet string `json:\"planet\" validate:\"required\"` Phone string `json:\"phone\" validate:\"required\"` } type validationError struct { ActualTag string `json:\"tag\"` Namespace string `json:\"namespace\"` Kind string `json:\"kind\"` Type string `json:\"type\"` Value string `json:\"value\"` Param string `json:\"param\"` } func wrapValidationErrors(errs validator.ValidationErrors) []validationError { validationErrors := make([]validationError, 0, len(errs)) for _, validationErr := range errs { validationErrors = append(validationErrors, validationError{ ActualTag: validationErr.ActualTag(), Namespace: validationErr.Namespace(), Kind: validationErr.Kind().String(), Type: validationErr.Type().String(), Value: fmt.Sprintf(\"%v\", validationErr.Value()), Param: validationErr.Param(), }) } return validationErrors } func postUser(ctx iris.Context) { var user User err := ctx.ReadJSON(\u0026user) if err != nil { // Handle the error, below you will find the right way to do that... if errs, ok := err.(validator.ValidationErrors); ok { // Wrap the errors with JSON format, the underline library returns the errors as interface. validationErrors := wrapValidationErrors(errs) // Fire an application/json+problem response and stop the handlers chain. ctx.StopWithProblem(iris.StatusBadRequest, iris.NewProblem(). Title(\"Validation error\"). Detail(\"One or more fields failed to be validated\"). Type(\"/user/validation-errors\"). Key(\"errors\", validationErrors)) return } // It's probably an internal JSON error, let's dont give more info here. ctx.StopWithStatus(iris.StatusInternalServerError) return } ctx.JSON(iris.Map{\"message\": \"OK\"}) } func resolveErrorsDocumentation(ctx iris.Context) { ctx.WriteString(\"A page that should document to web developers or users of the API on how to resolve the validation errors\") } æ ·å“è¯·æ±‚\n{ \"fname\": \"\", \"lname\": \"\", \"age\": 45, \"email\": \"mail@example.com\", \"favColor\": \"#000\", \"addresses\": [{ \"street\": \"Eavesdown Docks\", \"planet\": \"Persphone\", \"phone\": \"none\", \"city\": \"Unknown\" }] } ç¤ºä¾‹å“åº”\n{ \"title\": \"Validation error\", \"detail\": \"One or more fields failed to be validated\", \"type\": \"http://localhost:8080/user/validation-errors\", \"status\": 400, \"fields\": [ { \"tag\": \"required\", \"namespace\": \"User.FirstName\", \"kind\": \"string\", \"type\": \"string\", \"value\": \"\", \"param\": \"\" }, { \"tag\": \"required\", \"namespace\": \"User.LastName\", \"kind\": \"string\", \"type\": \"string\", \"value\": \"\", \"param\": \"\" } ] } æœ‰å…³æ¨¡å‹éªŒè¯çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®ï¼šhttps://github.com/go-playground/validator/blob/master/_examples\nç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸² è¯¥æ–¹æ³•ä»…ç»‘å®šæŸ¥è¯¢å‚æ•°ï¼Œè€Œä¸ç»‘å®šå¸–å­æ•°æ®ï¼Œè€Œæ˜¯ç”¨äºç»‘å®šå¸–å­æ•°æ®ã€‚ReadQuery``ReadForm\npackage main import \"github.com/kataras/iris/v12\" type Person struct { Name string `url:\"name,required\"` Address string `url:\"address\"` } func main() { app := iris.Default() app.Any(\"/\", index) app.Listen(\":8080\") } func index(ctx iris.Context) { var person Person if err := ctx.ReadQuery(\u0026person); err!=nil { ctx.StopWithError(iris.StatusBadRequest, err) return } ctx.Application().Logger().Infof(\"Person: %#+v\", person) ctx.WriteString(\"Success\") } ç»‘å®šä»»ä½• æ ¹æ®å®¢æˆ·ç«¯å‘é€æ•°æ®çš„å†…å®¹ç±»å‹å°†è¯·æ±‚æ­£æ–‡ç»‘å®šåˆ°â€œptrâ€ï¼Œä¾‹å¦‚ JSONã€XMLã€YAMLã€MessagePackã€Protobufã€Form å’Œ URL Queryã€‚\npackage main import ( \"time\" \"github.com/kataras/iris/v12\" ) type Person struct { Name string `form:\"name\" json:\"name\" url:\"name\" msgpack:\"name\"` Address string `form:\"address\" json:\"address\" url:\"address\" msgpack:\"address\"` Birthday time.Time `form:\"birthday\" time_format:\"2006-01-02\" time_utc:\"1\" json:\"birthday\" url:\"birthday\" msgpack:\"birthday\"` CreateTime time.Time `form:\"createTime\" time_format:\"unixNano\" json:\"create_time\" url:\"create_time\" msgpack:\"createTime\"` UnixTime time.Time `form:\"unixTime\" time_format:\"unix\" json:\"unix_time\" url:\"unix_time\" msgpack:\"unixTime\"` } func main() { app := iris.Default() app.Any(\"/\", index) app.Listen(\":8080\") } func index(ctx iris.Context) { var person Person if err := ctx.ReadBody(\u0026person); err!=nil { ctx.StopWithError(iris.StatusBadRequest, err) return } ctx.Application().Logger().Infof(\"Person: %#+v\", person) ctx.WriteString(\"Success\") } æµ‹è¯•å®ƒï¼š\n$ curl -X GET \"localhost:8085/testing?name=kataras\u0026address=xyz\u0026birthday=1992-03-15\u0026createTime=1562400033000000123\u0026unixTime=1562400033\" ç»‘å®šç½‘å€è·¯å¾„å‚æ•° package main import \"github.com/kataras/iris/v12\" type myParams struct { Name string `param:\"name\"` Age int `param:\"age\"` Tail []string `param:\"tail\"` } // All parameters are required, as we already know, // the router will fire 404 if name or int or tail are missing. func main() { app := iris.Default() app.Get(\"/{name}/{age:int}/{tail:path}\", func(ctx iris.Context) { var p myParams if err := ctx.ReadParams(\u0026p); err != nil { ctx.StopWithError(iris.StatusInternalServerError, err) return } ctx.Writef(\"myParams: %#v\", p) }) app.Listen(\":8088\") } è¯·æ±‚\n$ curl -v http://localhost:8080/kataras/27/iris/web/framework (adsbygoogle = window.adsbygoogle || []).push({});\nç»‘å®šæ ‡å¤´ package main import \"github.com/kataras/iris/v12\" type myHeaders struct { RequestID string `header:\"X-Request-Id,required\"` Authentication string `header:\"Authentication,required\"` } func main() { app := iris.Default() r.GET(\"/\", func(ctx iris.Context) { var hs myHeaders if err := ctx.ReadHeaders(\u0026hs); err != nil { ctx.StopWithError(iris.StatusInternalServerError, err) return } ctx.JSON(hs) }) app.Listen(\":8080\") } è¯·æ±‚\ncurl -H \"x-request-id:373713f0-6b4b-42ea-ab9f-e2e04bc38e73\" -H \"authentication: Bearer my-token\" \\ http://localhost:8080 å“åº”\n{ \"RequestID\": \"373713f0-6b4b-42ea-ab9f-e2e04bc38e73\", \"Authentication\": \"Bearer my-token\" } â€œç»‘å®š HTML â€å¤é€‰æ¡† package main import \"github.com/kataras/iris/v12\" func main() { app := iris.New() app.RegisterView(iris.HTML(\"./templates\", \".html\")) app.Get(\"/\", showForm) app.Post(\"/\", handleForm) app.Listen(\":8080\") } func showForm(ctx iris.Context) { if err := ctx.View(\"form.html\"); err!=nil { ctx.HTML(\"%s\", err.Error()) return } } type formExample struct { Colors []string `form:\"colors[]\"` // or just \"colors\". } func handleForm(ctx iris.Context) { var form formExample err := ctx.ReadForm(\u0026form) if err != nil { ctx.StopWithError(iris.StatusBadRequest, err) return } ctx.JSON(iris.Map{\"Colors\": form.Colors}) } templates/form.html\nCheck one or more colors\nRed Green Blue å“åº”\n{ \"Colors\": [ \"red\", \"green\", \"blue\" ] } JSONã€JSONPã€XMLã€Markdownã€YAML å’Œ MsgPack æ¸²æŸ“ è¯¦ç»†ç¤ºä¾‹å¯åœ¨æ­¤å¤„æ‰¾åˆ°ã€‚\nfunc main() { app := iris.New() // iris.Map is an alias of map[string]interface{} app.Get(\"/json\", func(ctx iris.Context) { ctx.JSON(iris.Map{\"message\": \"hello\", \"status\": iris.StatusOK}) }) // Use Secure field to prevent json hijacking. // It prepends `\"while(1),\"` to the body when the data is array. app.Get(\"/json_secure\", func(ctx iris.Context) { response := []string{\"val1\", \"val2\", \"val3\"} options := iris.JSON{Indent: \"\", Secure: true} ctx.JSON(response, options) // Will output: while(1);[\"val1\",\"val2\",\"val3\"] }) // Use ASCII field to generate ASCII-only JSON // with escaped non-ASCII characters. app.Get(\"/json_ascii\", func(ctx iris.Context) { response := iris.Map{\"lang\": \"GO-è™¹è†œ\", \"tag\": \"\n\"} options := iris.JSON{Indent: \" \", ASCII: true} ctx.JSON(response, options) /* Will output: { \"lang\": \"GO-\\u8679\\u819c\", \"tag\": \"\\u003cbr\\u003e\" } */ }) // Normally, JSON replaces special HTML characters with their unicode entities. // If you want to encode such characters literally, // you SHOULD set the UnescapeHTML field to true. app.Get(\"/json_raw\", func(ctx iris.Context) { options := iris.JSON{UnescapeHTML: true} ctx.JSON(iris.Map{ \"html\": \"Hello, world!\", }, options) // Will output: {\"html\":\"Hello, world!\"} }) app.Get(\"/json_struct\", func(ctx iris.Context) { // You also can use a struct. var msg struct { Name string `json:\"user\"` Message string Number int } msg.Name = \"Mariah\" msg.Message = \"hello\" msg.Number = 42 // Note that msg.Name becomes \"user\" in the JSON. // Will output: {\"user\": \"Mariah\", \"Message\": \"hello\", \"Number\": 42} ctx.JSON(msg) }) app.Get(\"/jsonp\", func(ctx iris.Context) { ctx.JSONP(iris.Map{\"hello\": \"jsonp\"}, iris.JSONP{Callback: \"callbackName\"}) }) app.Get(\"/xml\", func(ctx iris.Context) { ctx.XML(iris.Map{\"message\": \"hello\", \"status\": iris.StatusOK}) }) app.Get(\"/markdown\", func(ctx iris.Context) { ctx.Markdown([]byte(\"# Hello Dynamic Markdown -- iris\")) }) app.Get(\"/yaml\", func(ctx iris.Context) { ctx.YAML(iris.Map{\"message\": \"hello\", \"status\": iris.StatusOK}) }) app.Get(\"/msgpack\", func(ctx iris.Context) { u := User{ Firstname: \"John\", Lastname: \"Doe\", City: \"Neither FBI knows!!!\", Age: 25, } ctx.MsgPack(u) }) // Render using jsoniter instead of the encoding/json: app.Listen(\":8080\", iris.WithOptimizations) } æ™®ç½—æ‰˜å¸ƒå¤« Iris æ”¯æŒåŸç”Ÿ protobuf with å’Œ protobuf to JSON ç¼–ç å’Œè§£ç ã€‚Protobuf\npackage main import ( \"app/protos\" \"github.com/kataras/iris/v12\" ) func main() { app := iris.New() app.Get(\"/\", send) app.Get(\"/json\", sendAsJSON) app.Post(\"/read\", read) app.Post(\"/read_json\", readFromJSON) app.Listen(\":8080\") } func send(ctx iris.Context) { response := \u0026protos.HelloReply{Message: \"Hello, World!\"} ctx.Protobuf(response) } func sendAsJSON(ctx iris.Context) { response := \u0026protos.HelloReply{Message: \"Hello, World!\"} options := iris.JSON{ Proto: iris.ProtoMarshalOptions{ AllowPartial: true, Multiline: true, Indent: \" \", }, } ctx.JSON(response, options) } func read(ctx iris.Context) { var request protos.HelloRequest err := ctx.ReadProtobuf(\u0026request) if err != nil { ctx.StopWithError(iris.StatusBadRequest, err) return } ctx.Writef(\"HelloRequest.Name = %s\", request.Name) } func readFromJSON(ctx iris.Context) { var request protos.HelloRequest err := ctx.ReadJSONProtobuf(\u0026request) if err != nil { ctx.StopWithError(iris.StatusBadRequest, err) return } ctx.Writef(\"HelloRequest.Name = %s\", request.Name) } æä¾›é™æ€æ–‡ä»¶ func main() { app := iris.New() app.Favicon(\"./resources/favicon.ico\") app.HandleDir(\"/assets\", iris.Dir(\"./assets\")) app.Listen(\":8080\") } è¯¥æ–¹æ³•æ¥å—ç¬¬ä¸‰ä¸ªå¯é€‰å‚æ•°ï¼šHandleDir``DirOptions\ntype DirOptions struct { // Defaults to \"/index.html\", if request path is ending with **/*/$IndexName // then it redirects to **/*(/) which another handler is handling it, // that another handler, called index handler, is auto-registered by the framework // if end developer does not managed to handle it by hand. IndexName string // PushTargets filenames (map's value) to // be served without additional client's requests (HTTP/2 Push) // when a specific request path (map's key WITHOUT prefix) // is requested and it's not a directory (it's an `IndexFile`). // // Example: // \"/\": { // \"favicon.ico\", // \"js/main.js\", // \"css/main.css\", // } PushTargets map[string][]string // PushTargetsRegexp like `PushTargets` but accepts regexp which // is compared against all files under a directory (recursively). // The `IndexName` should be set. // // Example: // \"/\": regexp.MustCompile(\"((.*).js|(.*).css|(.*).ico)$\") // See `iris.MatchCommonAssets` too. PushTargetsRegexp map[string]*regexp.Regexp // Cache to enable in-memory cache and pre-compress files. Cache DirCacheOptions // When files should served under compression. Compress bool // List the files inside the current requested directory if `IndexName` not found. ShowList bool // If `ShowList` is true then this function will be used instead // of the default one to show the list of files of a current requested directory(dir). // See `DirListRich` package-level function too. DirList DirListFunc // Files downloaded and saved locally. Attachments Attachments // Optional validator that loops through each requested resource. AssetValidator func(ctx *context.Context, name string) bool } è¯¦ç»†äº†è§£æ–‡ä»¶æœåŠ¡å™¨ã€‚\n(adsbygoogle = window.adsbygoogle || []).push({});\nä»ä¸Šä¸‹æ–‡ä¸­æä¾›æ•°æ® SendFile(filename string, destinationName string) error SendFileWithRate(src, destName string, limit float64, burst int) error ç”¨æ³•\nå¼ºåˆ¶å°†æ–‡ä»¶å‘é€åˆ°å®¢æˆ·ç«¯ï¼š\nfunc handler(ctx iris.Context) { src := \"./files/first.zip\" ctx.SendFile(src, \"client.zip\") } å°†ä¸‹è½½é€Ÿåº¦é™åˆ¶ä¸º ~50Kb/sï¼Œçªå‘ 100KBï¼š\nfunc handler(ctx iris.Context) { src := \"./files/big.zip\" // optionally, keep it empty to resolve the filename based on the \"src\". dest := \"\" limit := 50.0 * iris.KB burst := 100 * iris.KB ctx.SendFileWithRate(src, dest, limit, burst) } ServeContent(content io.ReadSeeker, filename string, modtime time.Time) ServeContentWithRate(content io.ReadSeeker, filename string, modtime time.Time, limit float64, burst int) ServeFile(filename string) error ServeFileWithRate(filename string, limit float64, burst int) error ç”¨æ³•\nfunc handler(ctx iris.Context) { ctx.ServeFile(\"./public/main.js\") } æ¨¡æ¿æ¸²æŸ“ Iriså¼€ç®±å³ç”¨æ”¯æŒ8ä¸ªæ¨¡æ¿å¼•æ“ï¼Œå¼€å‘è€…ä»ç„¶å¯ä»¥ä½¿ç”¨ä»»ä½•å¤–éƒ¨golangæ¨¡æ¿å¼•æ“ï¼Œ å°±åƒä¸€ä¸ª.Context.ResponseWriter()``io.Writer\næ‰€æœ‰æ¨¡æ¿å¼•æ“å…±äº«ä¸€ä¸ªé€šç”¨ APIï¼Œå³ ä½¿ç”¨åµŒå…¥èµ„æºã€å¸ƒå±€å’Œç‰¹å®šäºå‚ä¸æ–¹çš„å¸ƒå±€ã€æ¨¡æ¿åŠŸèƒ½ã€éƒ¨åˆ†æ¸²æŸ“ç­‰è¿›è¡Œè§£æã€‚\n# åå­— è§£æ å™¨ 1 .HTML ç½‘é¡µ/æ¨¡æ¿ 2 å— å¡å¡”æ‹‰æ–¯/æ–¹å— 3 å§œæˆˆ å¼—æ´›æ–½/è“¬æˆˆ2 4 å¸•æ ¼ å°ä¸‘/ç¿¡ç¿  5 è½¦æŠŠ è‰¾é»˜é‡Œå…‹/é›·è’™å¾· 6 ç¥ç€ eknkc/ç¥ç€è‰² 7 å™´æ°£æ©Ÿ äº‘å¥—ä»¶/å–·æ°”æœº 8 é«˜æ‰‹ çº¦è¥¿/è‰¾æ–¯ ç¤ºä¾‹åˆ—è¡¨ã€‚\nåŸºå‡†åˆ—è¡¨ã€‚\nè§†å›¾å¼•æ“å¯ä»¥æŒ‰ç¼”çº¦æ–¹æ³¨å†Œã€‚è¦æ³¨å†Œè§†å›¾å¼•æ“ï¼Œè¯·ä½¿ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„æ–¹æ³•ã€‚Application/Party.RegisterView(ViewEngine)\nä»æ‰©å±•åä¸ºâ€œ.htmlâ€çš„â€œ./viewsâ€æ–‡ä»¶å¤¹ä¸­åŠ è½½æ‰€æœ‰æ¨¡æ¿ï¼Œå¹¶ä½¿ç”¨æ ‡å‡†åŒ…è§£æå®ƒä»¬ã€‚html/template\n// [app := iris.New...] tmpl := iris.HTML(\"./views\", \".html\") app.RegisterView(tmpl) è‹¥è¦å‘ˆç°æˆ–æ‰§è¡Œè§†å›¾ï¼Œè¯·ä½¿ç”¨ä¸»è·¯ç”±å¤„ç†ç¨‹åºä¸­çš„æ–¹æ³•ã€‚Context.View\nif err := ctx.View(\"hi.html\"); err!=nil { ctx.HTML(\"%s\", err.Error()) return } è¦é€šè¿‡ä¸­é—´ä»¶æˆ–ä¸»å¤„ç†ç¨‹åºåœ¨è§†å›¾ä¸­å°† Go å€¼ä¸é”®å€¼æ¨¡å¼ç»‘å®šï¼Œè¯·ä½¿ç”¨ go å€¼ä¹‹å‰çš„æ–¹æ³•ã€‚Context.ViewData``Context.View\nç»‘å®šï¼šä¸ .{{.message}}``\"Hello world!\"\nctx.ViewData(\"message\", \"Hello world!\") æ ¹ç»‘å®šï¼š\nif err := ctx.View(\"user-page.html\", User{}); err!=nil { ctx.HTML(\"%s\", err.Error()) return } // root binding as {{.Name}} è¦**æ·»åŠ æ¨¡æ¿å‡½æ•°ï¼Œ**è¯·ä½¿ç”¨é¦–é€‰è§†å›¾å¼•æ“çš„æ–¹æ³•ã€‚AddFunc\n// func name, input arguments, render value tmpl.AddFunc(\"greet\", func(s string) string { return \"Greetings \" + s + \"!\" }) è¦åœ¨æ¯ä¸ªè¯·æ±‚ä¸Šé‡æ–°åŠ è½½ï¼Œè¯·è°ƒç”¨è§†å›¾å¼•æ“çš„æ–¹æ³•ã€‚Reload\ntmpl.Reload(true) è¦ä½¿ç”¨åµŒå…¥å¼æ¨¡æ¿è€Œä¸ä¾èµ–äºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œè¯·ä½¿ç”¨ go-bindata å¤–éƒ¨å·¥å…·ï¼Œå¹¶å°†å…¶ç”Ÿæˆçš„å‡½æ•°ä¼ é€’ç»™é¦–é€‰è§†å›¾å¼•æ“çš„ç¬¬ä¸€ä¸ªè¾“å…¥å‚æ•°ã€‚AssetFile()\ntmpl := iris.HTML(AssetFile(), \".html\") ç¤ºä¾‹ä»£ç ï¼š\n// file: main.go package main import \"github.com/kataras/iris/v12\" func main() { app := iris.New() // Parse all templates from the \"./views\" folder // where extension is \".html\" and parse them // using the standard `html/template` package. tmpl := iris.HTML(\"./views\", \".html\") // Set custom delimeters. tmpl.Delims(\"{{\", \"}}\") // Enable re-build on local template files changes. tmpl.Reload(true) // Default template funcs are: // // - {{ urlpath \"myNamedRoute\" \"pathParameter_ifNeeded\" }} // - {{ render \"header.html\" . }} // and partial relative path to current page: // - {{ render_r \"header.html\" . }} // - {{ yield . }} // - {{ current }} // Register a custom template func: tmpl.AddFunc(\"greet\", func(s string) string { return \"Greetings \" + s + \"!\" }) // Register the view engine to the views, // this will load the templates. app.RegisterView(tmpl) // Method: GET // Resource: http://localhost:8080 app.Get(\"/\", func(ctx iris.Context) { // Bind: {{.message}} with \"Hello world!\" ctx.ViewData(\"message\", \"Hello world!\") // Render template file: ./views/hi.html if err := ctx.View(\"hi.html\"); err!=nil { ctx.HTML(\"%s\", err.Error()) return } }) app.Listen(\":8080\") } Hi Page {{.message}} {{greet \"to you\"}} åœ¨ http://localhost:8080 å¤„æ‰“å¼€æµè§ˆå™¨é€‰é¡¹å¡ã€‚\næ¸²æŸ“çš„ç»“æœå°†å¦‚ä¸‹æ‰€ç¤ºï¼š\nHi Page Hello world! Greetings to you! å¤šæ¨¡æ¿ Iris å…è®¸æ¯ä¸ªåº”ç”¨ç¨‹åºæ³¨å†Œæ— é™æ•°é‡çš„è§†å›¾å¼•æ“ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ‚¨è¿˜å¯ä»¥ä¸ºæ¯ä¸ªæ´¾å¯¹æˆ–é€šè¿‡ä¸­é—´ä»¶æ³¨å†Œä¸€ä¸ªè§†å›¾å¼•æ“ï¼\n// Register a view engine per group of routes. adminGroup := app.Party(\"/admin\") adminGroup.RegisterView(iris.Blocks(\"./views/admin\", \".html\")) é€šè¿‡ä¸­é—´ä»¶ func middleware(views iris.ViewEngine) iris.Handler { return func(ctx iris.Context) { ctx.ViewEngine(views) ctx.Next() } } ç”¨æ³•\n// Register a view engine on-fly for the current chain of handlers. views := iris.Blocks(\"./views/on-fly\", \".html\") views.Load() app.Get(\"/\", setViews(views), onFly) é‡ å®šå‘ å‘å‡º HTTP é‡å®šå‘å¾ˆå®¹æ˜“ã€‚æ”¯æŒå†…éƒ¨å’Œå¤–éƒ¨ä½ç½®ã€‚æˆ‘ä»¬æ‰€è¯´çš„ä½ç½®æ˜¯æŒ‡è·¯å¾„ã€å­åŸŸã€åŸŸç­‰ã€‚\nä»å¤„ç†ç¨‹åº app.Get(\"/\", func(ctx iris.Context) { ctx.Redirect(\"https://go.dev/dl\", iris.StatusMovedPermanently) }) ä»å¼€æœºè‡ªæ£€å‘å‡º HTTP é‡å®šå‘ã€‚\napp.Post(\"/\", func(ctx iris.Context) { ctx.Redirect(\"/login\", iris.StatusFound) }) ä»å¤„ç†ç¨‹åºå‘å‡ºæœ¬åœ°è·¯ç”±å™¨é‡å®šå‘ï¼Œä½¿ç”¨æˆ–ç±»ä¼¼å¦‚ä¸‹ã€‚Application.ServeHTTPC``Exec()\napp.Get(\"/test\", func(ctx iris.Context) { r := ctx.Request() r.URL.Path = \"/test2\" ctx.Application().ServeHTTPC(ctx) // OR // ctx.Exec(\"GET\", \"/test2\") }) app.Get(\"/test2\", func(ctx iris.Context) { ctx.JSON(iris.Map{\"hello\": \"world\"}) }) å…¨çƒ ä½¿ç”¨æˆ‘ä»¬éƒ½å–œæ¬¢çš„è¯­æ³•ã€‚\nimport \"github.com/kataras/iris/v12/middleware/rewrite\" func main() { app := iris.New() // [...routes] redirects := rewrite.Load(\"redirects.yml\") app.WrapRouter(redirects) app.Listen(\":80\") } è¯¥æ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š\"redirects.yml\"\nRedirectMatch: # Redirects /seo/* to /* - 301 /seo/(.*) /$1 # Redirects /docs/v12* to /docs - 301 /docs/v12(.*) /docs # Redirects /old(.*) to / - 301 /old(.*) / # Redirects http or https://test.* to http or https://newtest.* - 301 ^(http|https)://test.(.*) $1://newtest.$2 # Handles /*.json or .xml as *?format=json or xml, # without redirect. See /users route. # When Code is 0 then it does not redirect the request, # instead it changes the request URL # and leaves a route handle the request. - 0 /(.*).(json|xml) /$1?format=$2 # Redirects root domain to www. # Creation of a www subdomain inside the Application is unnecessary, # all requests are handled by the root Application itself. PrimarySubdomain: www å®Œæ•´çš„ä»£ç å¯ä»¥åœ¨é‡å†™ä¸­é—´ä»¶ç¤ºä¾‹ä¸­æ‰¾åˆ°ã€‚\nè‡ªå®šä¹‰ä¸­é—´ä»¶ func Logger() iris.Handler { return func(ctx iris.Context) { t := time.Now() // Set a shared variable between handlers ctx.Values().Set(\"framework\", \"iris\") // before request ctx.Next() // after request latency := time.Since(t) log.Print(latency) // access the status we are sending status := ctx.GetStatusCode() log.Println(status) } } func main() { app := iris.New() app.Use(Logger()) app.Get(\"/test\", func(ctx iris.Context) { // retrieve a value set by the middleware. framework := ctx.Values().GetString(\"framework\") // it would print: \"iris\" log.Println(framework) }) app.Listen(\":8080\") } (adsbygoogle = window.adsbygoogle || []).push({});\nä½¿ç”¨åŸºæœ¬èº«ä»½éªŒè¯ HTTP åŸºæœ¬èº«ä»½éªŒè¯æ˜¯å¯¹ Web èµ„æºå®æ–½è®¿é—®æ§åˆ¶çš„æœ€ç®€å•æŠ€æœ¯ï¼Œå› ä¸ºå®ƒä¸éœ€è¦ Cookieã€ä¼šè¯æ ‡è¯†ç¬¦æˆ–ç™»å½•é¡µé¢;ç›¸åï¼ŒHTTP åŸºæœ¬èº«ä»½éªŒè¯ä½¿ç”¨ HTTP æ ‡å¤´ä¸­çš„æ ‡å‡†å­—æ®µã€‚\nåŸºæœ¬èº«ä»½éªŒè¯ä¸­é—´ä»¶åŒ…å«åœ¨ Iris æ¡†æ¶ä¸­ï¼Œå› æ­¤æ— éœ€å•ç‹¬å®‰è£…ã€‚\n1. å¯¼å…¥ä¸­é—´ä»¶\nimport \"github.com/kataras/iris/v12/middleware/basicauth\" 2. ä½¿ç”¨å…¶ç»“æ„é…ç½®ä¸­é—´ä»¶ï¼šOptions\nopts := basicauth.Options{ Allow: basicauth.AllowUsers(map[string]string{ \"username\": \"password\", }), Realm: \"Authorization Required\", ErrorHandler: basicauth.DefaultErrorHandler, // [...more options] } 3. åˆå§‹åŒ–ä¸­é—´ä»¶ï¼š\nauth := basicauth.New(opts) 3.1 ä»¥ä¸Šæ­¥éª¤ä¸å‡½æ•°ç›¸åŒï¼šDefault\nauth := basicauth.Default(map[string]string{ \"username\": \"password\", }) 3.2 ä½¿ç”¨è‡ªå®šä¹‰ç”¨æˆ·åˆ‡ç‰‡ï¼š\n// The struct value MUST contain a Username and Passwords fields // or GetUsername() string and GetPassword() string methods. type User struct { Username string Password string } // [...] auth := basicauth.Default([]User{...}) 3.3 ä»æ–‡ä»¶åŠ è½½ç”¨æˆ· æˆ–è€…ï¼Œå¯†ç ä½¿ç”¨ pkg.go.dev/golang.org/x/crypto/bcrypt åŒ…è¿›è¡ŒåŠ å¯†ï¼š\nauth := basicauth.Load(\"users.yml\", basicauth.BCRYPT) 3.3.1 ä½¿ç”¨ï¼ˆæ¨èï¼‰ä¹Ÿå¯ä»¥å®ç°ç›¸åŒçš„ç›®çš„ï¼šOptions\nopts := basicauth.Options{ Allow: basicauth.AllowUsersFile(\"users.yml\", basicauth.BCRYPT), Realm: basicauth.DefaultRealm, // [...more options] } auth := basicauth.New(opts) å…¶ä¸­å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼šusers.yml\n- username: kataras password: $2a$10$Irg8k8HWkDlvL0YDBKLCYee6j6zzIFTplJcvZYKA.B8/clHPZn2Ey # encrypted of kataras_pass role: admin - username: makis password: $2a$10$3GXzp3J5GhHThGisbpvpZuftbmzPivDMo94XPnkTnDe7254x7sJ3O # encrypted of makis_pass role: member 4. æ³¨å†Œä¸­é—´ä»¶ï¼š\n// Register to all matched routes // under a Party and its children. app.Use(auth) // OR/and register to all http error routes. app.UseError(auth) // OR register under a path prefix of a specific Party, // including all http errors of this path prefix. app.UseRouter(auth) // OR register to a specific Route before its main handler. app.Post(\"/protected\", auth, routeHandler) 5. æ£€ç´¢ç”¨æˆ·åå’Œå¯†ç ï¼š\nfunc routeHandler(ctx iris.Context) { username, password, _ := ctx.Request().BasicAuth() // [...] } 5.1 æ£€ç´¢ User å€¼ï¼ˆå½“æ‚¨åœ¨ä»¥ä¸‹ä½ç½®æ³¨å†Œè‡ªå®šä¹‰ç”¨æˆ·ç»“æ„çš„ä¸€éƒ¨åˆ†æ—¶å¾ˆæœ‰ç”¨ï¼‰ï¼šOptions.AllowUsers\nfunc routeHandler(ctx iris.Context) { user := ctx.User().(*iris.SimpleUser) // user.Username // user.Password } åœ¨ _examples/auth ä¸­é˜…è¯»æ›´å¤šæˆæƒå’Œèº«ä»½éªŒè¯ç¤ºä¾‹ã€‚\nä¸­é—´ä»¶ä¸­çš„ Goroutines åœ¨ä¸­é—´ä»¶æˆ–å¤„ç†ç¨‹åºä¸­å¯åŠ¨æ–°çš„ Goroutines æ—¶ï¼Œæ‚¨ä¸åº”è¯¥ä½¿ç”¨å…¶ä¸­çš„åŸå§‹ä¸Šä¸‹æ–‡ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨åªè¯»å‰¯æœ¬ã€‚\nfunc main() { app := iris.Default() app.Get(\"/long_async\", func(ctx iris.Context) { // create a clone to be used inside the goroutine ctxCopy := ctx.Clone() go func() { // simulate a long task with time.Sleep(). 5 seconds time.Sleep(5 * time.Second) // note that you are using the copied context \"ctxCopy\", IMPORTANT log.Printf(\"Done! in path: %s\", ctxCopy.Path()) }() }) app.Get(\"/long_sync\", func(ctx iris.Context) { // simulate a long task with time.Sleep(). 5 seconds time.Sleep(5 * time.Second) // since we are NOT using a goroutine, we do not have to copy the context log.Printf(\"Done! in path: %s\", ctx.Path()) }) app.Listen(\":8080\") } è‡ªå®šä¹‰ HTTP é…ç½® åœ¨ _examples/http-server æ–‡ä»¶å¤¹ä¸­å¯ä»¥æ‰¾åˆ°è¶…è¿‡ 12 ä¸ªæœ‰å…³ http æœåŠ¡å™¨é…ç½®çš„ç¤ºä¾‹ã€‚\nç›´æ¥ä½¿ç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼šhttp.ListenAndServe()\nfunc main() { app := iris.New() // [...routes] if err := app.Build(); err!=nil{ panic(err) } http.ListenAndServe(\":8080\", app) } è¯·æ³¨æ„ï¼Œåœ¨å°†å…¶ç”¨ä½œ .Build``http.Handler\nå†æ¯”å¦‚ï¼š\nfunc main() { app := iris.New() // [...routes] app.Build() srv := \u0026http.Server{ Addr: \":8080\", Handler: app, ReadTimeout: 10 * time.Second, WriteTimeout: 10 * time.Second, MaxHeaderBytes: 1 \u003c\u003c 20, } srv.ListenAndServe() } ä½†æ˜¯ï¼Œæ‚¨å¾ˆå°‘éœ€è¦å…·æœ‰ IRIS çš„å¤–éƒ¨å®ä¾‹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½• tcp ä¾¦å¬å™¨ã€http æœåŠ¡å™¨æˆ–é€šè¿‡æ–¹æ³•è‡ªå®šä¹‰å‡½æ•°è¿›è¡Œä¾¦å¬ã€‚http.Server``Application.Run\napp.Run(iris.Listener(l net.Listener)) // listen using a custom net.Listener app.Run(iris.Server(srv *http.Server)) // listen using a custom http.Server app.Run(iris.Addr(addr string)) // the app.Listen is a shortcut of this method. app.Run(iris.TLS(addr string, certFileOrContents, keyFileOrContents string)) // listen TLS. app.Run(iris.AutoTLS(addr, domain, email string)) // listen using letsencrypt (see below). // and any custom function that returns an error: app.Run(iris.Raw(f func() error)) å¥—æ¥å­—åˆ†ç‰‡ æ­¤é€‰é¡¹å…è®¸åœ¨å¤š CPU æœåŠ¡å™¨ä¸Šçº¿æ€§æ‰©å±•æœåŠ¡å™¨æ€§èƒ½ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… https://www.nginx.com/blog/socket-sharding-nginx-release-1-9-1/ã€‚ä½¿ç”¨é…ç½®å™¨å¯ç”¨ã€‚iris.WithSocketSharding\nç¤ºä¾‹ä»£ç ï¼š\npackage main import ( \"time\" \"github.com/kataras/iris/v12\" ) func main() { startup := time.Now() app := iris.New() app.Get(\"/\", func(ctx iris.Context) { s := startup.Format(ctx.Application().ConfigurationReadOnly().GetTimeFormat()) ctx.Writef(\"This server started at: %s\\n\", s) }) app.Listen(\":8080\", iris.WithSocketSharding) // or app.Run(..., iris.WithSocketSharding) } æ”¯æŒè®©æˆ‘ä»¬åŠ å¯† 1 è¡Œ LetsEncrypt HTTPS æœåŠ¡å™¨çš„ç¤ºä¾‹ã€‚\npackage main import ( \"log\" \"github.com/iris-gonic/autotls\" \"github.com/kataras/iris/v12\" ) func main() { app := iris.Default() // Ping handler app.Get(\"/ping\", func(ctx iris.Context) { ctx.WriteString(\"pong\") }) app.Run(iris.AutoTLS(\":443\", \"example.com example2.com\", \"mail@example.com\")) } è‡ªå®šä¹‰ TLS ç¤ºä¾‹ï¼ˆæ‚¨ä¹Ÿå¯ä»¥ç»‘å®šè‡ªåŠ¨è¯ä¹¦ç®¡ç†å™¨ï¼‰ï¼š\napp.Run( iris.TLS(\":443\", \"\", \"\", func(su *iris.Supervisor) { su.Server.TLSConfig = \u0026tls.Config{ /* your custom fields */ }, }), ) æ‰€æœ‰æ–¹æ³•ï¼ˆå¦‚ï¼šAddrï¼ŒTLSï¼ŒAutoTLSï¼ŒServerï¼ŒListenerå’Œe.t.cï¼‰éƒ½æ¥å—å¯å˜å‚æ•°ï¼Œä»¥åœ¨æ„å»ºçŠ¶æ€ä¸Šé…ç½®httpæœåŠ¡å™¨å®ä¾‹ã€‚iris.Runner``func(*iris.Supervisor)\nä½¿ç”¨é¸¢å°¾èŠ±è¿è¡Œå¤šä¸ªæœåŠ¡ package main import ( \"log\" \"net/http\" \"time\" \"github.com/kataras/iris/v12\" \"github.com/kataras/iris/v12/middleware/recover\" \"golang.org/x/sync/errgroup\" ) var g errgroup.Group func startApp1() error { app := iris.New().SetName(\"app1\") app.Use(recover.New()) app.Get(\"/\", func(ctx iris.Context) { app.Get(\"/\", func(ctx iris.Context) { ctx.JSON(iris.Map{ \"code\": iris.StatusOK, \"message\": \"Welcome server 1\", }) }) }) app.Build() return app.Listen(\":8080\") } func startApp2() error { app := iris.New().SetName(\"app2\") app.Use(recover.New()) app.Get(\"/\", func(ctx iris.Context) { ctx.JSON(iris.Map{ \"code\": iris.StatusOK, \"message\": \"Welcome server 2\", }) }) return app.Listen(\":8081\") } func main() { g.Go(startApp1) g.Go(startApp2) if err := g.Wait(); err != nil { log.Fatal(err) } } é€šè¿‡åŒ…ç®¡ç†å¤šä¸ªé¸¢å°¾èŠ±å®ä¾‹ã€‚åœ¨æ­¤å¤„é˜…è¯»æ›´å¤šå†…å®¹ã€‚apps\n(adsbygoogle = window.adsbygoogle || []).push({});\næ­£å¸¸å…³æœºæˆ–é‡å¯ æœ‰å‡ ç§æ–¹æ³•å¯ç”¨äºæ‰§è¡Œæ­£å¸¸å…³æœºæˆ–é‡æ–°å¯åŠ¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸“é—¨ä¸ºæ­¤æ„å»ºçš„ç¬¬ä¸‰æ–¹åŒ…ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•ã€‚å¯ä»¥åœ¨æ­¤å¤„æ‰¾åˆ°ç¤ºä¾‹ã€‚app.Shutdown(context.Context)\nä½¿ç”¨ CTRL/CMD+C åœ¨ CTRL/CMD+C ä¸Šæ³¨å†Œäº‹ä»¶ï¼širis.RegisterOnInterrupt\nidleConnsClosed := make(chan struct{}) iris.RegisterOnInterrupt(func() { timeout := 10 * time.Second ctx, cancel := stdContext.WithTimeout(stdContext.Background(), timeout) defer cancel() // close all hosts. app.Shutdown(ctx) close(idleConnsClosed) }) // [...] app.Listen(\":8080\", iris.WithoutInterruptHandler, iris.WithoutServerError(iris.ErrServerClosed)) \u003c-idleConnsClosed ä½¿ç”¨æ¨¡æ¿æ„å»ºå•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ æ‚¨å¯ä»¥ä½¿ç”¨ [go-bindata][https://github.com/go-bindata/go-bindata] çš„ç”Ÿæˆå‡½æ•°å°†æœåŠ¡å™¨æ„å»ºåˆ°åŒ…å«æ¨¡æ¿çš„å•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚AssetFile\n$ go get -u github.com/go-bindata/go-bindata/... $ go-bindata -fs -prefix \"templates\" ./templates/... $ go run . ç¤ºä¾‹ä»£ç ï¼š\nfunc main() { app := iris.New() tmpl := iris.HTML(AssetFile(), \".html\") tmpl.Layout(\"layouts/layout.html\") tmpl.AddFunc(\"greet\", func(s string) string { return \"Greetings \" + s + \"!\" }) app.RegisterView(tmpl) // [...] } åœ¨_examples/è§†å›¾ä¸­æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹ã€‚\nå°è¯•å°†èº«ä½“ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä¸­ ç»‘å®šè¯·æ±‚æ­£æ–‡çš„å¸¸è§„æ–¹æ³•æ¶ˆè€—ï¼Œå®ƒä»¬ ä¸èƒ½å¤šæ¬¡è°ƒç”¨ï¼Œé™¤éå°†é…ç½®å™¨ä¼ é€’ç»™ ã€‚ctx.Request().Body``iris.WithoutBodyConsumptionOnUnmarshal``app.Run/Listen\npackage main import \"github.com/kataras/iris/v12\" func main() { app := iris.New() app.Post(\"/\", logAllBody, logJSON, logFormValues, func(ctx iris.Context) { // body, err := os.ReadAll(ctx.Request().Body) once or body, err := ctx.GetBody() // as many times as you need. if err != nil { ctx.StopWithError(iris.StatusInternalServerError, err) return } if len(body) == 0 { ctx.WriteString(`The body was empty.`) } else { ctx.WriteString(\"OK body is still:\\n\") ctx.Write(body) } }) app.Listen(\":8080\", iris.WithoutBodyConsumptionOnUnmarshal) } func logAllBody(ctx iris.Context) { body, err := ctx.GetBody() if err == nil \u0026\u0026 len(body) \u003e 0 { ctx.Application().Logger().Infof(\"logAllBody: %s\", string(body)) } ctx.Next() } func logJSON(ctx iris.Context) { var p interface{} if err := ctx.ReadJSON(\u0026p); err == nil { ctx.Application().Logger().Infof(\"logJSON: %#+v\", p) } ctx.Next() } func logFormValues(ctx iris.Context) { values := ctx.FormValues() if values != nil { ctx.Application().Logger().Infof(\"logFormValues: %v\", values) } ctx.Next() } å¯ä»¥ä½¿ç”¨ å°†ç»“æ„ç»‘å®šåˆ°åŸºäºå®¢æˆ·ç«¯å†…å®¹ç±»å‹çš„è¯·æ±‚ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨å†…å®¹åå•†ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼šReadBody\npackage main import ( \"github.com/kataras/iris/v12\" ) func main() { app := newApp() // See main_test.go for usage. app.Listen(\":8080\") } func newApp() *iris.Application { app := iris.New() // To automatically decompress using gzip: // app.Use(iris.GzipReader) app.Use(setAllowedResponses) app.Post(\"/\", readBody) return app } type payload struct { Message string `json:\"message\" xml:\"message\" msgpack:\"message\" yaml:\"Message\" url:\"message\" form:\"message\"` } func readBody(ctx iris.Context) { var p payload // Bind request body to \"p\" depending on the content-type that client sends the data, // e.g. JSON, XML, YAML, MessagePack, Protobuf, Form and URL Query. err := ctx.ReadBody(\u0026p) if err != nil { ctx.StopWithProblem(iris.StatusBadRequest, iris.NewProblem().Title(\"Parser issue\").Detail(err.Error())) return } // For the sake of the example, log the received payload. ctx.Application().Logger().Infof(\"Received: %#+v\", p) // Send back the payload depending on the accept content type and accept-encoding of the client, // e.g. JSON, XML and so on. ctx.Negotiate(p) } func setAllowedResponses(ctx iris.Context) { // Indicate that the Server can send JSON, XML, YAML and MessagePack for this request. ctx.Negotiation().JSON().XML().YAML().MsgPack() // Add more, allowed by the server format of responses, mime types here... // If client is missing an \"Accept: \" header then default it to JSON. ctx.Negotiation().Accept.JSON() ctx.Next() } (adsbygoogle = window.adsbygoogle || []).push({});\nHTTP2 æœåŠ¡å™¨æ¨é€ å®Œæ•´çš„ç¤ºä¾‹ä»£ç å¯ä»¥åœ¨ _examples/response-writer/http2push ä¸­æ‰¾åˆ°ã€‚\næœåŠ¡å™¨æ¨é€è®©æœåŠ¡å™¨æŠ¢å…ˆâ€œæ¨é€â€ç½‘ç«™èµ„äº§ åˆ°å®¢æˆ·ç«¯ï¼Œè€Œæ— éœ€ç”¨æˆ·æ˜ç¡®è¯·æ±‚å®ƒä»¬ã€‚ è°¨æ…ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€æˆ‘ä»¬çŸ¥é“ç”¨æˆ·è¦å»çš„å†…å®¹ éœ€è¦ä»–ä»¬è¯·æ±‚çš„é¡µé¢ã€‚\npackage main import ( \"net/http\" \"github.com/kataras/iris/v12\" ) func main() { app := iris.New() app.Get(\"/\", pushHandler) app.Get(\"/main.js\", simpleAssetHandler) app.Run(iris.TLS(\"127.0.0.1:443\", \"mycert.crt\", \"mykey.key\")) // $ openssl req -new -newkey rsa:4096 -x509 -sha256 \\ // -days 365 -nodes -out mycert.crt -keyout mykey.key } func pushHandler(ctx iris.Context) { // The target must either be an absolute path (like \"/path\") or an absolute // URL that contains a valid host and the same scheme as the parent request. // If the target is a path, it will inherit the scheme and host of the // parent request. target := \"/main.js\" if pusher, ok := ctx.ResponseWriter().Naive().(http.Pusher); ok { err := pusher.Push(target, nil) if err != nil { if err == iris.ErrPushNotSupported { ctx.StopWithText(iris.StatusHTTPVersionNotSupported, \"HTTP/2 push not supported.\") } else { ctx.StopWithError(iris.StatusInternalServerError, err) } return } } ctx.HTML(``, target) } func simpleAssetHandler(ctx iris.Context) { ctx.ServeFile(\"./public/main.js\") } è®¾ç½®å¹¶è·å–é¥¼å¹² å®‰å…¨ Cookieã€ç¼–ç å’Œè§£ç ã€ä¼šè¯ï¼ˆå’Œä¼šè¯ç¼©æ”¾ï¼‰ã€é—ªå­˜æ¶ˆæ¯ç­‰å¯ä»¥åœ¨ _examples/cookie å’Œ _examples/ä¼šè¯ç›®å½•ä¸­æ‰¾åˆ°ã€‚\nimport \"github.com/kataras/iris/v12\" func main() { app := iris.Default() app.Get(\"/cookie\", func(ctx iris.Context) { value := ctx.GetCookie(\"my_cookie\") if value == \"\" { value = \"NotSet\" ctx.SetCookieKV(\"my_cookie\", value) // Alternatively: ctx.SetCookie(\u0026http.Cookie{...}) ctx.SetCookie(\"\", \"test\", 3600, \"/\", \"localhost\", false, true) } ctx.Writef(\"Cookie value: %s \\n\", cookie) }) app.Listen(\":8080\") } å¦‚æœè¦è®¾ç½®è‡ªå®šä¹‰è·¯å¾„ï¼š\nctx.SetCookieKV(name, value, iris.CookiePath(\"/custom/path/cookie/will/be/stored\")) å¦‚æœå¸Œæœ›ä»…å¯¹å½“å‰è¯·æ±‚è·¯å¾„å¯è§ï¼š\nctx.SetCookieKV(name, value, iris.CookieCleanPath /* or iris.CookiePath(\"\") */) æ›´å¤šï¼š\niris.CookieAllowReclaim iris.CookieAllowSubdomains iris.CookieSecure iris.CookieHTTPOnly iris.CookieSameSite iris.CookiePath iris.CookieCleanPath iris.CookieExpires iris.CookieEncoding æ‚¨ä¹Ÿå¯ä»¥åœ¨ä¸­é—´ä»¶ä¸­ä¸ºæ•´ä¸ªè¯·æ±‚æ·»åŠ  cookie é€‰é¡¹ï¼š\nfunc setCookieOptions(ctx iris.Context) { ctx.AddCookieOptions(iris.CookieHTTPOnly(true), iris.CookieExpires(1*time.Hour)) ctx.Next() } JSON ç½‘ç»œä»¤ç‰Œ JSON Web ä»¤ç‰Œ ï¼ˆJWTï¼‰ æ˜¯ä¸€ç§å¼€æ”¾æ ‡å‡† ï¼ˆRFC 7519ï¼‰ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ç´§å‡‘ä¸”ç‹¬ç«‹çš„æ–¹å¼ï¼Œç”¨äºåœ¨å„æ–¹ä¹‹é—´ä»¥ JSON å¯¹è±¡çš„å½¢å¼å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ã€‚æ­¤ä¿¡æ¯å¯ä»¥éªŒè¯å’Œä¿¡ä»»ï¼Œå› ä¸ºå®ƒæ˜¯ç»è¿‡æ•°å­—ç­¾åçš„ã€‚JWT å¯ä»¥ä½¿ç”¨å¯†é’¥ï¼ˆä½¿ç”¨ HMAC ç®—æ³•ï¼‰æˆ–ä½¿ç”¨ RSA æˆ– ECDSA çš„å…¬é’¥/ç§é’¥å¯¹è¿›è¡Œç­¾åã€‚\nä½•æ—¶åº”ä½¿ç”¨ JSON Web ä»¤ç‰Œï¼Ÿ ä»¥ä¸‹æ˜¯ JSON Web ä»¤ç‰Œæœ‰ç”¨çš„ä¸€äº›æ–¹æ¡ˆï¼š\næˆæƒï¼šè¿™æ˜¯ä½¿ç”¨ JWT çš„æœ€å¸¸è§æ–¹æ¡ˆã€‚ç”¨æˆ·ç™»å½•åï¼Œæ¯ä¸ªåç»­è¯·æ±‚éƒ½å°†åŒ…å« JWTï¼Œå…è®¸ç”¨æˆ·è®¿é—®ä½¿ç”¨è¯¥ä»¤ç‰Œå…è®¸çš„è·¯ç”±ã€æœåŠ¡å’Œèµ„æºã€‚å•ç‚¹ç™»å½•æ˜¯å½“ä»Šå¹¿æ³›ä½¿ç”¨ JWT çš„ä¸€é¡¹åŠŸèƒ½ï¼Œå› ä¸ºå®ƒçš„å¼€é”€å¾ˆå°ï¼Œå¹¶ä¸”èƒ½å¤Ÿè·¨ä¸åŒåŸŸè½»æ¾ä½¿ç”¨ã€‚\nä¿¡æ¯äº¤æ¢ï¼šJSON Web ä»¤ç‰Œæ˜¯åœ¨å„æ–¹ä¹‹é—´å®‰å…¨ä¼ è¾“ä¿¡æ¯çš„å¥½æ–¹æ³•ã€‚ç”±äº JWT å¯ä»¥ç­¾åï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨å…¬é’¥/ç§é’¥å¯¹ï¼‰ï¼Œå› æ­¤æ‚¨å¯ä»¥ç¡®å®šå‘ä»¶äººæ˜¯ä»–ä»¬æ‰€è¯´çš„äººã€‚æ­¤å¤–ï¼Œç”±äºç­¾åæ˜¯ä½¿ç”¨æ ‡å¤´å’Œæœ‰æ•ˆè´Ÿè½½è®¡ç®—çš„ï¼Œå› æ­¤æ‚¨è¿˜å¯ä»¥éªŒè¯å†…å®¹æ˜¯å¦æœªè¢«ç¯¡æ”¹ã€‚\né˜…è¯»æ›´å¤šå…³äºæ™ºå¨æ±¤é€Šçš„ä¿¡æ¯ï¼š https://jwt.io/introduction/\nå°† JWT ä¸è™¹è†œé…åˆä½¿ç”¨ Iris JWT ä¸­é—´ä»¶åœ¨è®¾è®¡æ—¶è€ƒè™‘äº†å®‰å…¨æ€§ã€æ€§èƒ½å’Œç®€å•æ€§ï¼Œå®ƒå¯ä»¥ä¿æŠ¤æ‚¨çš„ä»¤ç‰Œå…å—æ‚¨å¯èƒ½åœ¨å…¶ä»–åº“ä¸­å‘ç°çš„å…³é”®æ¼æ´çš„å½±å“ã€‚å®ƒåŸºäºkataras/jwtåŒ…ã€‚\npackage main import ( \"time\" \"github.com/kataras/iris/v12\" \"github.com/kataras/iris/v12/middleware/jwt\" ) var ( sigKey = []byte(\"signature_hmac_secret_shared_key\") encKey = []byte(\"GCM_AES_256_secret_shared_key_32\") ) type fooClaims struct { Foo string `json:\"foo\"` } func main() { app := iris.New() signer := jwt.NewSigner(jwt.HS256, sigKey, 10*time.Minute) // Enable payload encryption with: // signer.WithEncryption(encKey, nil) app.Get(\"/\", generateToken(signer)) verifier := jwt.NewVerifier(jwt.HS256, sigKey) // Enable server-side token block feature (even before its expiration time): verifier.WithDefaultBlocklist() // Enable payload decryption with: // verifier.WithDecryption(encKey, nil) verifyMiddleware := verifier.Verify(func() interface{} { return new(fooClaims) }) protectedAPI := app.Party(\"/protected\") // Register the verify middleware to allow access only to authorized clients. protectedAPI.Use(verifyMiddleware) // ^ or UseRouter(verifyMiddleware) to disallow unauthorized http error handlers too. protectedAPI.Get(\"/\", protected) // Invalidate the token through server-side, even if it's not expired yet. protectedAPI.Get(\"/logout\", logout) // http://localhost:8080 // http://localhost:8080/protected?token=$token (or Authorization: Bearer $token) // http://localhost:8080/protected/logout?token=$token // http://localhost:8080/protected?token=$token (401) app.Listen(\":8080\") } func generateToken(signer *jwt.Signer) iris.Handler { return func(ctx iris.Context) { claims := fooClaims{Foo: \"bar\"} token, err := signer.Sign(claims) if err != nil { ctx.StopWithStatus(iris.StatusInternalServerError) return } ctx.Write(token) } } func protected(ctx iris.Context) { // Get the verified and decoded claims. claims := jwt.Get(ctx).(*fooClaims) // Optionally, get token information if you want to work with them. // Just an example on how you can retrieve all the standard claims (set by signer's max age, \"exp\"). standardClaims := jwt.GetVerifiedToken(ctx).StandardClaims expiresAtString := standardClaims.ExpiresAt().Format(ctx.Application().ConfigurationReadOnly().GetTimeFormat()) timeLeft := standardClaims.Timeleft() ctx.Writef(\"foo=%s\\nexpires at: %s\\ntime left: %s\\n\", claims.Foo, expiresAtString, timeLeft) } func logout(ctx iris.Context) { err := ctx.Logout() if err != nil { ctx.WriteString(err.Error()) } else { ctx.Writef(\"token invalidated, a new token is required to access the protected API\") } } æœ‰å…³åˆ·æ–°ä»¤ç‰Œã€é˜»æ­¢åˆ—è¡¨ç­‰çš„ä¿¡æ¯ï¼Œè¯·è®¿é—®ï¼š_examples/auth/jwtã€‚\næµ‹è¯• Irisä¸ºhttpexpectæä¾›äº†ä»¤äººéš¾ä»¥ç½®ä¿¡çš„æ”¯æŒï¼Œhttpexpectæ˜¯Webåº”ç”¨ç¨‹åºçš„æµ‹è¯•æ¡†æ¶ã€‚å­åŒ…ä¸º Iris + httpexpect æä¾›äº†å¸®åŠ©ç¨‹åºã€‚iris/httptest\nå¦‚æœä½ æ›´å–œæ¬¢Goçš„æ ‡å‡†net/http/httpteståŒ…ï¼Œä½ ä»ç„¶å¯ä»¥ä½¿ç”¨å®ƒã€‚Irisä¸æ¯ä¸ªhttp Webæ¡†æ¶éƒ½ä¸ä»»ä½•ç”¨äºæµ‹è¯•çš„å¤–éƒ¨å·¥å…·å…¼å®¹ï¼Œæœ€åå®ƒæ˜¯HTTPã€‚\næµ‹è¯•åŸºæœ¬èº«ä»½éªŒè¯ åœ¨ç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å­åŒ…æ¥æµ‹è¯•åŸºæœ¬èº«ä»½éªŒè¯ã€‚iris/httptest\n1. æºæ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼šmain.go\npackage main import ( \"github.com/kataras/iris/v12\" \"github.com/kataras/iris/v12/middleware/basicauth\" ) func newApp() *iris.Application { app := iris.New() opts := basicauth.Options{ Allow: basicauth.AllowUsers(map[string]string{\"myusername\": \"mypassword\"}), } authentication := basicauth.New(opts) // or just: basicauth.Default(map...) app.Get(\"/\", func(ctx iris.Context) { ctx.Redirect(\"/admin\") }) // to party needAuth := app.Party(\"/admin\", authentication) { //http://localhost:8080/admin needAuth.Get(\"/\", h) // http://localhost:8080/admin/profile needAuth.Get(\"/profile\", h) // http://localhost:8080/admin/settings needAuth.Get(\"/settings\", h) } return app } func h(ctx iris.Context) { // username, password, _ := ctx.Request().BasicAuth() // third parameter it will be always true because the middleware // makes sure for that, otherwise this handler will not be executed. // OR: user := ctx.User().(*iris.SimpleUser) ctx.Writef(\"%s %s:%s\", ctx.Path(), user.Username, user.Password) // ctx.Writef(\"%s %s:%s\", ctx.Path(), username, password) } func main() { app := newApp() app.Listen(\":8080\") } **2.**ç°åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¹¶å¤åˆ¶ç²˜è´´ä»¥ä¸‹å†…å®¹ã€‚main_test.go\npackage main import ( \"testing\" \"github.com/kataras/iris/v12/httptest\" ) func TestNewApp(t *testing.T) { app := newApp() e := httptest.New(t, app) // redirects to /admin without basic auth e.GET(\"/\").Expect().Status(httptest.StatusUnauthorized) // without basic auth e.GET(\"/admin\").Expect().Status(httptest.StatusUnauthorized) // with valid basic auth e.GET(\"/admin\").WithBasicAuth(\"myusername\", \"mypassword\").Expect(). Status(httptest.StatusOK).Body().Equal(\"/admin myusername:mypassword\") e.GET(\"/admin/profile\").WithBasicAuth(\"myusername\", \"mypassword\").Expect(). Status(httptest.StatusOK).Body().Equal(\"/admin/profile myusername:mypassword\") e.GET(\"/admin/settings\").WithBasicAuth(\"myusername\", \"mypassword\").Expect(). Status(httptest.StatusOK).Body().Equal(\"/admin/settings myusername:mypassword\") // with invalid basic auth e.GET(\"/admin/settings\").WithBasicAuth(\"invalidusername\", \"invalidpassword\"). Expect().Status(httptest.StatusUnauthorized) } 3. æ‰“å¼€å‘½ä»¤è¡Œå¹¶æ‰§è¡Œï¼š\n$ go test -v æµ‹è¯•é¥¼å¹² package main import ( \"fmt\" \"testing\" \"github.com/kataras/iris/v12/httptest\" ) func TestCookiesBasic(t *testing.T) { app := newApp() e := httptest.New(t, app, httptest.URL(\"http://example.com\")) cookieName, cookieValue := \"my_cookie_name\", \"my_cookie_value\" // Test Set A Cookie. t1 := e.GET(fmt.Sprintf(\"/cookies/%s/%s\", cookieName, cookieValue)). Expect().Status(httptest.StatusOK) // Validate cookie's existence, it should be available now. t1.Cookie(cookieName).Value().Equal(cookieValue) t1.Body().Contains(cookieValue) path := fmt.Sprintf(\"/cookies/%s\", cookieName) // Test Retrieve A Cookie. t2 := e.GET(path).Expect().Status(httptest.StatusOK) t2.Body().Equal(cookieValue) // Test Remove A Cookie. t3 := e.DELETE(path).Expect().Status(httptest.StatusOK) t3.Body().Contains(cookieName) t4 := e.GET(path).Expect().Status(httptest.StatusOK) t4.Cookies().Empty() t4.Body().Empty() } $ go test -v -run=TestCookiesBasic$ Iris Web æ¡†æ¶æœ¬èº«ä½¿ç”¨æ­¤åŒ…æ¥æµ‹è¯•è‡ªèº«ã€‚åœ¨_exampleså­˜å‚¨åº“ç›®å½•ä¸­ï¼Œæ‚¨è¿˜å¯ä»¥æ‰¾åˆ°ä¸€äº›æœ‰ç”¨çš„æµ‹è¯•ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹å¹¶é˜…è¯» httpexpect çš„æ–‡æ¡£ã€‚\nåœ°æ–¹åŒ– ä»‹ç» æœ¬åœ°åŒ–åŠŸèƒ½æä¾›äº†ä¸€ç§æ£€ç´¢å„ç§è¯­è¨€å­—ç¬¦ä¸²çš„ä¾¿æ·æ–¹æ³•ï¼Œä½¿æ‚¨å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­è½»æ¾æ”¯æŒå¤šç§è¯­è¨€ã€‚è¯­è¨€å­—ç¬¦ä¸²å­˜å‚¨åœ¨ç›®å½•ä¸­çš„æ–‡ä»¶ä¸­ã€‚åœ¨æ­¤ç›®å½•ä¸­ï¼Œåº”ç”¨ç¨‹åºæ”¯æŒçš„æ¯ç§è¯­è¨€éƒ½åº”è¯¥æœ‰ä¸€ä¸ªå­ç›®å½•ï¼š./locales\nâ”‚ main.go â””â”€â”€â”€locales â”œâ”€â”€â”€el-GR â”‚ home.yml â”œâ”€â”€â”€en-US â”‚ home.yml â””â”€â”€â”€zh-CN home.yml åº”ç”¨ç¨‹åºçš„é»˜è®¤è¯­è¨€æ˜¯ç¬¬ä¸€ä¸ªæ³¨å†Œè¯­è¨€ã€‚\napp := iris.New() // First parameter: Glob filpath patern, // Second variadic parameter: Optional language tags, // the first one is the default/fallback one. app.I18n.Load(\"./locales/*/*\", \"en-US\", \"el-GR\", \"zh-CN\") æˆ–è€…ï¼Œå¦‚æœæ‚¨é€šè¿‡ä»¥ä¸‹æ–¹å¼åŠ è½½æ‰€æœ‰è¯­è¨€ï¼š\napp.I18n.Load(\"./locales/*/*\") // Then set the default language using: app.I18n.SetDefault(\"en-US\") åŠ è½½åµŒå…¥å¼åŒºåŸŸè®¾ç½® æ‚¨å¯èƒ½å¸Œæœ›åœ¨åº”ç”¨ç¨‹åºå¯æ‰§è¡Œæ–‡ä»¶ä¸­ä½¿ç”¨æ–°çš„åµŒå…¥æŒ‡ä»¤åµŒå…¥åŒºåŸŸè®¾ç½®ã€‚\nå¯¼å…¥åµŒå…¥åŒ…;å¦‚æœæ‚¨ä¸ä½¿ç”¨æ­¤åŒ…ä¸­çš„ä»»ä½•å¯¼å‡ºæ ‡è¯†ç¬¦ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ _ â€œembedâ€ è¿›è¡Œç©ºç™½å¯¼å…¥ã€‚ import ( \"embed\" ) åµŒå…¥æŒ‡ä»¤æ¥å—ç›¸å¯¹äºåŒ…å« Go æºæ–‡ä»¶çš„ç›®å½•çš„è·¯å¾„ã€‚æˆ‘ä»¬å¯ä»¥åµŒå…¥å¤šä¸ªæ–‡ä»¶ï¼Œç”šè‡³æ˜¯å¸¦æœ‰é€šé…ç¬¦çš„æ–‡ä»¶å¤¹ã€‚è¿™ä½¿ç”¨åµŒå…¥çš„å˜é‡ã€‚FS ç±»å‹ï¼Œå®ƒå®ç°ä¸€ä¸ªç®€å•çš„è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿã€‚ //go:embed embedded/locales/* var embeddedFS embed.FS æˆ‘ä»¬åº”è¯¥ä½¿ç”¨æ–¹æ³•è€Œä¸æ˜¯æ–¹æ³•ã€‚Load``LoadFS err := app.I18n.LoadFS(embeddedFS, \"./embedded/locales/*/*.ini\", \"en-US\", \"el-GR\") // OR to load all languages by filename: // app.I18n.LoadFS(embeddedFS, \"./embedded/locales/*/*.ini\") // Then set the default language using: // app.I18n.SetDefault(\"en-US\") å®šä¹‰ç¿»è¯‘ è¯­è¨€ç¯å¢ƒæ–‡ä»¶å¯ä»¥ä»¥ YAMLï¼ˆæ¨èï¼‰ã€JSONã€TOML æˆ– INI å½¢å¼ç¼–å†™ã€‚\næ¯ä¸ªæ–‡ä»¶éƒ½åº”åŒ…å«å¯†é’¥ã€‚é”®ä¹Ÿå¯ä»¥æœ‰å­é”®ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œéƒ¨åˆ†â€ï¼‰ã€‚\næ¯ä¸ªé”®çš„å€¼åº”å…·æœ‰å½¢å¼æˆ–åŒ…å«å…¶ç¿»è¯‘æ–‡æœ¬ï¼ˆæˆ–æ¨¡æ¿ï¼‰æˆ–/åŠå…¶å¤æ•°é”®å€¼ã€‚string``map\nIris i18næ¨¡å—æ”¯æŒå¼€ç®±å³ç”¨çš„å¤æ•°ï¼Œè§ä¸‹æ–‡ã€‚\nFMT é£æ ¼ hi: \"Hi %s!\" ctx.Tr(\"Hi\", \"John\") // Outputs: Hi John! æ¨¡æ¿ hi: \"Hi {{.Name}}!\" ctx.Tr(\"Hi\", iris.Map{\"Name\": \"John\"}) // Outputs: Hi John! å¤šå…ƒåŒ– Iris i18n æ”¯æŒå¤æ•°å˜é‡ã€‚è¦å®šä¹‰æ¯ä¸ªåŒºåŸŸè®¾ç½®å˜é‡ï¼Œæ‚¨å¿…é¡» å®šä¹‰é”®çš„æ–°éƒ¨åˆ†ã€‚Vars\nå˜é‡å¯æ¥å—çš„é”®ä¸ºï¼š\none \"=x\"å…¶ä¸­ x æ˜¯ä¸€ä¸ªæ•°å­— \"",
  "wordCount" : "12478",
  "inLanguage": "zh",
  "datePublished": "2023-10-10T00:00:00Z",
  "dateModified": "2023-10-10T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "liiqii"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://liiqii.github.io/posts/tech/go/go_iris/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "liiqii",
    "logo": {
      "@type": "ImageObject",
      "url": "https://liiqii.github.io/img/icon.jpg"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    (function () {
        let  arr,reg = new RegExp("(^| )"+"change-themes"+"=([^;]*)(;|$)");
        if(arr = document.cookie.match(reg)) {
        } else {
            if (new Date().getHours() >= 19 || new Date().getHours() < 6) {
                document.body.classList.add('dark');
                localStorage.setItem("pref-theme", 'dark');
            } else {
                document.body.classList.remove('dark');
                localStorage.setItem("pref-theme", 'light');
            }
        }
    })()

    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }
</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://liiqii.github.io/" accesskey="h" title="Home (Alt + H)">Home</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                         stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://liiqii.github.io/search" title="ğŸ” æœç´¢ (Alt &#43; /)" accesskey=/>
                <span>ğŸ” æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://liiqii.github.io/posts" title="ğŸ“š æ–‡ç« ">
                <span>ğŸ“š æ–‡ç« </span>
                </a>
            </li>
            <li>
                <a href="https://liiqii.github.io/tags" title="ğŸ§© æ ‡ç­¾">
                <span>ğŸ§© æ ‡ç­¾</span>
                </a>
            </li>
            <li>
                <a href="https://liiqii.github.io/archives/" title="â±ï¸ æ—¶é—´è½´">
                <span>â±ï¸ æ—¶é—´è½´</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main page">
<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }
</style>

<article class="post-single">
    <div id="single-content">
        <header class="post-header">
            <div class="breadcrumbs"><a href="https://liiqii.github.io/">ğŸ  ä¸»é¡µ</a>&nbsp;Â»&nbsp;<a href="https://liiqii.github.io/posts/">ğŸ“šæ–‡ç« </a>&nbsp;Â»&nbsp;<a href="https://liiqii.github.io/posts/tech/">ğŸ‘¨ğŸ»â€ğŸ’» æŠ€æœ¯</a></div>
            <h1 class="post-title">
                Go æ¡†æ¶ Iris æ–‡æ¡£
            </h1>
            <div class="post-description">
                Go æ¡†æ¶ Iris æ–‡æ¡£ç¿»è¯‘ï¼ŒIrisæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„è½¯ä»¶ã€‚
            </div>
            <div class="post-meta">

<style>
    i[id*="post_meta_style"] {
        display: flex;
        align-items: center;
        margin: 0 0 10px 0;
    }

    .parent-post-meta {
        display: flex;
        flex-wrap: wrap;
        opacity: 0.8;
    }
</style>

<span class="parent-post-meta">
    <span id="post_meta_style_1">
        <span class="fa fa-calendar-check-o"></span>
        <span>2023-10-10
            &nbsp;&nbsp;
        </span>
    </span>
    
    
    
    
    
    
    
    <span id="post_meta_style_3">
        <span class="fa fa-file-word-o"></span>
        <span>12478å­—
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_4">
        <span class="fa fa-clock-o"></span>
        <span>25åˆ†é’Ÿ
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_5">
        <span class="fa fa-user-o"></span>
        <span>liiqii
            &nbsp;&nbsp;
        </span>
    </span>
    <span id="post_meta_style_6">
        <span class="fa fa-tags" style="opacity: 0.8"></span>
        <span>
            <span class="post-tags-meta">
                <a href="https://liiqii.github.io/tags/go/" style="color: var(--secondary)!important;">Go</a>
                &nbsp;<a href="https://liiqii.github.io/tags/go%E6%A1%86%E6%9E%B6/" style="color: var(--secondary)!important;">Goæ¡†æ¶</a>
            </span>
        </span>
    </span>
</span>
<span style="opacity: 0.8;">
                    <span id="post_meta_style_7">
                        &nbsp;&nbsp;
                        <span class="fa fa-eye" ></span>
                        <span>
                            <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv"></span></span>
                            &nbsp;&nbsp;
                        </span>
                    </span>
                    <span id="post_meta_style_8">
                        <span class="fa fa-commenting-o"></span>
                        <span>
                            <script src="https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js"></script>
                            <script>
                                let url = document.documentURI
                                
                                let dnsUrl = "https://liiqii.github.io/"
                                let urlSplit = url.split(dnsUrl)
                                let finalUrl = urlSplit[1]
                                if (finalUrl[0] !== '/') {
                                    finalUrl = '/'+finalUrl
                                }
                                twikoo.getCommentsCount({
                                    envId:  null , 
                                region:  null , 
                                urls: [ 
                                    
                                    finalUrl,
                                ],
                                    includeReply: false 
                                }).then(function (res) {
                                    let count = res[0].count
                                    const obj = document.getElementById("comment_count");
                                    obj.innerText = count
                                    
                                    
                                    
                                }).catch(function (err) {
                                    
                                    console.error(err);
                                });
                            </script>
                            <span id="comment_count"></span>
                        </span>
                    </span>
                </span>

</div>
        </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">ç›®å½•</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#%e5%ae%89%e8%a3%85httpswwwiris-gocomdocsidinstallation" aria-label="å®‰è£…"><a href="https://www.iris-go.com/docs/#/?id=installation">å®‰è£…</a></a><ul>
                        
                <li>
                    <a href="#%e6%95%85%e9%9a%9c-%e6%8e%92%e9%99%a4httpswwwiris-gocomdocsidtroubleshooting" aria-label="æ•…éšœ æ’é™¤"><a href="https://www.iris-go.com/docs/#/?id=troubleshooting">æ•…éšœ æ’é™¤</a></a></li></ul>
                </li>
                <li>
                    <a href="#%e5%bf%ab%e9%80%9f%e5%85%a5%e9%97%a8httpswwwiris-gocomdocsidquick-start" aria-label="å¿«é€Ÿå…¥é—¨"><a href="https://www.iris-go.com/docs/#/?id=quick-start">å¿«é€Ÿå…¥é—¨</a></a></li>
                <li>
                    <a href="#%e5%9f%ba%e5%87%86httpswwwiris-gocomdocsidbenchmarks" aria-label="åŸºå‡†"><a href="https://www.iris-go.com/docs/#/?id=benchmarks">åŸºå‡†</a></a></li>
                <li>
                    <a href="#%e6%8e%a5%e5%8f%a3%e7%a4%ba%e4%be%8bhttpswwwiris-gocomdocsidapi-examples" aria-label="æ¥å£ç¤ºä¾‹"><a href="https://www.iris-go.com/docs/#/?id=api-examples">æ¥å£ç¤ºä¾‹</a></a><ul>
                        
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e8%8e%b7%e5%8f%96%e5%8f%91%e5%b8%83%e6%94%be%e7%bd%ae%e4%bf%ae%e8%a1%a5%e5%88%a0%e9%99%a4%e5%92%8c%e9%80%89%e9%a1%b9httpswwwiris-gocomdocsidusing-get-post-put-patch-delete-and-options" aria-label="ä½¿ç”¨è·å–ã€å‘å¸ƒã€æ”¾ç½®ã€ä¿®è¡¥ã€åˆ é™¤å’Œé€‰é¡¹"><a href="https://www.iris-go.com/docs/#/?id=using-get-post-put-patch-delete-and-options">ä½¿ç”¨è·å–ã€å‘å¸ƒã€æ”¾ç½®ã€ä¿®è¡¥ã€åˆ é™¤å’Œé€‰é¡¹</a></a></li>
                <li>
                    <a href="#%e8%b7%af%e5%be%84%e4%b8%ad%e7%9a%84%e5%8f%82%e6%95%b0httpswwwiris-gocomdocsidparameters-in-path" aria-label="è·¯å¾„ä¸­çš„å‚æ•°"><a href="https://www.iris-go.com/docs/#/?id=parameters-in-path">è·¯å¾„ä¸­çš„å‚æ•°</a></a></li>
                <li>
                    <a href="#%e6%9f%a5%e8%af%a2%e5%ad%97%e7%ac%a6%e4%b8%b2%e5%8f%82%e6%95%b0httpswwwiris-gocomdocsidquerystring-parameters" aria-label="æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°"><a href="https://www.iris-go.com/docs/#/?id=querystring-parameters">æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°</a></a></li>
                <li>
                    <a href="#%e5%a4%9a%e9%83%a8%e5%88%86%e4%b9%8c%e4%bc%a6%e7%bc%96%e7%a0%81%e5%bd%a2%e5%bc%8fhttpswwwiris-gocomdocsidmultiparturlencoded-form" aria-label="å¤šéƒ¨åˆ†/ä¹Œä¼¦ç¼–ç å½¢å¼"><a href="https://www.iris-go.com/docs/#/?id=multiparturlencoded-form">å¤šéƒ¨åˆ†/ä¹Œä¼¦ç¼–ç å½¢å¼</a></a></li>
                <li>
                    <a href="#%e5%86%8d%e6%af%94%e5%a6%82%e6%9f%a5%e8%af%a2%e5%b8%96%e5%ad%90%e8%a1%a8%e5%8d%95httpswwwiris-gocomdocsidanother-example-query-post-form" aria-label="å†æ¯”å¦‚ï¼šæŸ¥è¯¢&#43;å¸–å­è¡¨å•"><a href="https://www.iris-go.com/docs/#/?id=another-example-query-post-form">å†æ¯”å¦‚ï¼šæŸ¥è¯¢+å¸–å­è¡¨å•</a></a></li>
                <li>
                    <a href="#%e6%9f%a5%e8%af%a2%e5%92%8c%e5%8f%91%e5%b8%83%e8%a1%a8%e5%8d%95%e5%8f%82%e6%95%b0httpswwwiris-gocomdocsidquery-and-post-form-parameters" aria-label="æŸ¥è¯¢å’Œå‘å¸ƒè¡¨å•å‚æ•°"><a href="https://www.iris-go.com/docs/#/?id=query-and-post-form-parameters">æŸ¥è¯¢å’Œå‘å¸ƒè¡¨å•å‚æ•°</a></a></li>
                <li>
                    <a href="#%e4%b8%8a%e4%bc%a0%e6%96%87%e4%bb%b6httpswwwiris-gocomdocsidupload-files" aria-label="ä¸Šä¼ æ–‡ä»¶"><a href="https://www.iris-go.com/docs/#/?id=upload-files">ä¸Šä¼ æ–‡ä»¶</a></a><ul>
                        
                <li>
                    <a href="#%e5%8d%95%e4%b8%aa%e6%96%87%e4%bb%b6httpswwwiris-gocomdocsidsingle-file" aria-label="å•ä¸ªæ–‡ä»¶"><a href="https://www.iris-go.com/docs/#/?id=single-file">å•ä¸ªæ–‡ä»¶</a></a></li>
                <li>
                    <a href="#%e5%a4%9a%e4%b8%aa%e6%96%87%e4%bb%b6httpswwwiris-gocomdocsidmultiple-files" aria-label="å¤šä¸ªæ–‡ä»¶"><a href="https://www.iris-go.com/docs/#/?id=multiple-files">å¤šä¸ªæ–‡ä»¶</a></a></li></ul>
                </li>
                <li>
                    <a href="#%e5%af%b9%e8%b7%af%e7%ba%bf%e8%bf%9b%e8%a1%8c%e5%88%86%e7%bb%84httpswwwiris-gocomdocsidgrouping-routes" aria-label="å¯¹è·¯çº¿è¿›è¡Œåˆ†ç»„"><a href="https://www.iris-go.com/docs/#/?id=grouping-routes">å¯¹è·¯çº¿è¿›è¡Œåˆ†ç»„</a></a></li>
                <li>
                    <a href="#%e9%bb%98%e8%ae%a4%e4%b8%8d%e5%b8%a6%e4%b8%ad%e9%97%b4%e4%bb%b6%e7%9a%84%e7%a9%ba%e7%99%bd%e5%85%89%e5%9c%88httpswwwiris-gocomdocsidblank-iris-without-middleware-by-default" aria-label="é»˜è®¤ä¸å¸¦ä¸­é—´ä»¶çš„ç©ºç™½å…‰åœˆ"><a href="https://www.iris-go.com/docs/#/?id=blank-iris-without-middleware-by-default">é»˜è®¤ä¸å¸¦ä¸­é—´ä»¶çš„ç©ºç™½å…‰åœˆ</a></a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e4%b8%ad%e9%97%b4%e4%bb%b6httpswwwiris-gocomdocsidusing-middleware" aria-label="ä½¿ç”¨ä¸­é—´ä»¶"><a href="https://www.iris-go.com/docs/#/?id=using-middleware">ä½¿ç”¨ä¸­é—´ä»¶</a></a></li>
                <li>
                    <a href="#%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f%e6%96%87%e4%bb%b6%e8%ae%b0%e5%bd%95%e5%99%a8httpswwwiris-gocomdocsidapplication-file-logger" aria-label="åº”ç”¨ç¨‹åºæ–‡ä»¶è®°å½•å™¨"><a href="https://www.iris-go.com/docs/#/?id=application-file-logger">åº”ç”¨ç¨‹åºæ–‡ä»¶è®°å½•å™¨</a></a></li>
                <li>
                    <a href="#%e6%8e%a7%e5%88%b6%e6%97%a5%e5%bf%97%e8%be%93%e5%87%ba%e7%9d%80%e8%89%b2httpswwwiris-gocomdocsidcontrolling-log-output-coloring" aria-label="æ§åˆ¶æ—¥å¿—è¾“å‡ºç€è‰²"><a href="https://www.iris-go.com/docs/#/?id=controlling-log-output-coloring">æ§åˆ¶æ—¥å¿—è¾“å‡ºç€è‰²</a></a></li>
                <li>
                    <a href="#%e8%af%b7%e6%b1%82%e6%97%a5%e5%bf%97%e8%ae%b0%e5%bd%95httpswwwiris-gocomdocsidrequest-logging" aria-label="è¯·æ±‚æ—¥å¿—è®°å½•"><a href="https://www.iris-go.com/docs/#/?id=request-logging">è¯·æ±‚æ—¥å¿—è®°å½•</a></a></li>
                <li>
                    <a href="#%e6%a8%a1%e5%9e%8b%e7%bb%91%e5%ae%9a%e5%92%8c%e9%aa%8c%e8%af%81httpswwwiris-gocomdocsidmodel-binding-and-validation" aria-label="æ¨¡å‹ç»‘å®šå’ŒéªŒè¯"><a href="https://www.iris-go.com/docs/#/?id=model-binding-and-validation">æ¨¡å‹ç»‘å®šå’ŒéªŒè¯</a></a></li>
                <li>
                    <a href="#%e7%bb%91%e5%ae%9a%e6%9f%a5%e8%af%a2%e5%ad%97%e7%ac%a6%e4%b8%b2httpswwwiris-gocomdocsidbind-query-string" aria-label="ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²"><a href="https://www.iris-go.com/docs/#/?id=bind-query-string">ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²</a></a></li>
                <li>
                    <a href="#%e7%bb%91%e5%ae%9a%e4%bb%bb%e4%bd%95httpswwwiris-gocomdocsidbind-any" aria-label="ç»‘å®šä»»ä½•"><a href="https://www.iris-go.com/docs/#/?id=bind-any">ç»‘å®šä»»ä½•</a></a></li>
                <li>
                    <a href="#%e7%bb%91%e5%ae%9a%e7%bd%91%e5%9d%80%e8%b7%af%e5%be%84%e5%8f%82%e6%95%b0httpswwwiris-gocomdocsidbind-url-path-parameters" aria-label="ç»‘å®šç½‘å€è·¯å¾„å‚æ•°"><a href="https://www.iris-go.com/docs/#/?id=bind-url-path-parameters">ç»‘å®šç½‘å€è·¯å¾„å‚æ•°</a></a></li>
                <li>
                    <a href="#%e7%bb%91%e5%ae%9a%e6%a0%87%e5%a4%b4httpswwwiris-gocomdocsidbind-header" aria-label="ç»‘å®šæ ‡å¤´"><a href="https://www.iris-go.com/docs/#/?id=bind-header">ç»‘å®šæ ‡å¤´</a></a></li>
                <li>
                    <a href="#%e7%bb%91%e5%ae%9a-html-%e5%a4%8d%e9%80%89%e6%a1%86httpswwwiris-gocomdocsidbind-html-checkboxes" aria-label="â€œç»‘å®š HTML â€å¤é€‰æ¡†"><a href="https://www.iris-go.com/docs/#/?id=bind-html-checkboxes">â€œç»‘å®š HTML â€å¤é€‰æ¡†</a></a></li>
                <li>
                    <a href="#jsonjsonpxmlmarkdownyaml-%e5%92%8c-msgpack-%e6%b8%b2%e6%9f%93httpswwwiris-gocomdocsidjson-jsonp-xml-markdown-yaml-and-msgpack-rendering" aria-label="JSONã€JSONPã€XMLã€Markdownã€YAML å’Œ MsgPack æ¸²æŸ“"><a href="https://www.iris-go.com/docs/#/?id=json-jsonp-xml-markdown-yaml-and-msgpack-rendering">JSONã€JSONPã€XMLã€Markdownã€YAML å’Œ MsgPack æ¸²æŸ“</a></a><ul>
                        
                <li>
                    <a href="#%e6%99%ae%e7%bd%97%e6%89%98%e5%b8%83%e5%a4%abhttpswwwiris-gocomdocsidprotobuf" aria-label="æ™®ç½—æ‰˜å¸ƒå¤«"><a href="https://www.iris-go.com/docs/#/?id=protobuf">æ™®ç½—æ‰˜å¸ƒå¤«</a></a></li></ul>
                </li>
                <li>
                    <a href="#%e6%8f%90%e4%be%9b%e9%9d%99%e6%80%81%e6%96%87%e4%bb%b6httpswwwiris-gocomdocsidserving-static-files" aria-label="æä¾›é™æ€æ–‡ä»¶"><a href="https://www.iris-go.com/docs/#/?id=serving-static-files">æä¾›é™æ€æ–‡ä»¶</a></a></li>
                <li>
                    <a href="#%e4%bb%8e%e4%b8%8a%e4%b8%8b%e6%96%87%e4%b8%ad%e6%8f%90%e4%be%9b%e6%95%b0%e6%8d%aehttpswwwiris-gocomdocsidserving-data-from-context" aria-label="ä»ä¸Šä¸‹æ–‡ä¸­æä¾›æ•°æ®"><a href="https://www.iris-go.com/docs/#/?id=serving-data-from-context">ä»ä¸Šä¸‹æ–‡ä¸­æä¾›æ•°æ®</a></a></li>
                <li>
                    <a href="#%e6%a8%a1%e6%9d%bf%e6%b8%b2%e6%9f%93httpswwwiris-gocomdocsidtemplate-rendering" aria-label="æ¨¡æ¿æ¸²æŸ“"><a href="https://www.iris-go.com/docs/#/?id=template-rendering">æ¨¡æ¿æ¸²æŸ“</a></a></li>
                <li>
                    <a href="#%e5%a4%9a%e6%a8%a1%e6%9d%bfhttpswwwiris-gocomdocsidmultitemplate" aria-label="å¤šæ¨¡æ¿"><a href="https://www.iris-go.com/docs/#/?id=multitemplate">å¤šæ¨¡æ¿</a></a><ul>
                        
                <li>
                    <a href="#%e9%80%9a%e8%bf%87%e4%b8%ad%e9%97%b4%e4%bb%b6httpswwwiris-gocomdocsidthrough-middleware" aria-label="é€šè¿‡ä¸­é—´ä»¶"><a href="https://www.iris-go.com/docs/#/?id=through-middleware">é€šè¿‡ä¸­é—´ä»¶</a></a></li></ul>
                </li>
                <li>
                    <a href="#%e9%87%8d-%e5%ae%9a%e5%90%91httpswwwiris-gocomdocsidredirects" aria-label="é‡ å®šå‘"><a href="https://www.iris-go.com/docs/#/?id=redirects">é‡ å®šå‘</a></a><ul>
                        
                <li>
                    <a href="#%e4%bb%8e%e5%a4%84%e7%90%86%e7%a8%8b%e5%ba%8fhttpswwwiris-gocomdocsidfrom-handler" aria-label="ä»å¤„ç†ç¨‹åº"><a href="https://www.iris-go.com/docs/#/?id=from-handler">ä»å¤„ç†ç¨‹åº</a></a></li>
                <li>
                    <a href="#%e5%85%a8%e7%90%83httpswwwiris-gocomdocsidglobally" aria-label="å…¨çƒ"><a href="https://www.iris-go.com/docs/#/?id=globally">å…¨çƒ</a></a></li></ul>
                </li>
                <li>
                    <a href="#%e8%87%aa%e5%ae%9a%e4%b9%89%e4%b8%ad%e9%97%b4%e4%bb%b6httpswwwiris-gocomdocsidcustom-middleware" aria-label="è‡ªå®šä¹‰ä¸­é—´ä»¶"><a href="https://www.iris-go.com/docs/#/?id=custom-middleware">è‡ªå®šä¹‰ä¸­é—´ä»¶</a></a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e5%9f%ba%e6%9c%ac%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81httpswwwiris-gocomdocsidusing-basic-authentication" aria-label="ä½¿ç”¨åŸºæœ¬èº«ä»½éªŒè¯"><a href="https://www.iris-go.com/docs/#/?id=using-basic-authentication">ä½¿ç”¨åŸºæœ¬èº«ä»½éªŒè¯</a></a></li>
                <li>
                    <a href="#%e4%b8%ad%e9%97%b4%e4%bb%b6%e4%b8%ad%e7%9a%84-goroutineshttpswwwiris-gocomdocsidgoroutines-inside-a-middleware" aria-label="ä¸­é—´ä»¶ä¸­çš„ Goroutines"><a href="https://www.iris-go.com/docs/#/?id=goroutines-inside-a-middleware">ä¸­é—´ä»¶ä¸­çš„ Goroutines</a></a></li>
                <li>
                    <a href="#%e8%87%aa%e5%ae%9a%e4%b9%89-http-%e9%85%8d%e7%bd%aehttpswwwiris-gocomdocsidcustom-http-configuration" aria-label="è‡ªå®šä¹‰ HTTP é…ç½®"><a href="https://www.iris-go.com/docs/#/?id=custom-http-configuration">è‡ªå®šä¹‰ HTTP é…ç½®</a></a></li>
                <li>
                    <a href="#%e5%a5%97%e6%8e%a5%e5%ad%97%e5%88%86%e7%89%87httpswwwiris-gocomdocsidsocket-sharding" aria-label="å¥—æ¥å­—åˆ†ç‰‡"><a href="https://www.iris-go.com/docs/#/?id=socket-sharding">å¥—æ¥å­—åˆ†ç‰‡</a></a></li>
                <li>
                    <a href="#%e6%94%af%e6%8c%81%e8%ae%a9%e6%88%91%e4%bb%ac%e5%8a%a0%e5%af%86httpswwwiris-gocomdocsidsupport-let39s-encrypt" aria-label="æ”¯æŒè®©æˆ‘ä»¬åŠ å¯†"><a href="https://www.iris-go.com/docs/#/?id=support-let39s-encrypt">æ”¯æŒè®©æˆ‘ä»¬åŠ å¯†</a></a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e9%b8%a2%e5%b0%be%e8%8a%b1%e8%bf%90%e8%a1%8c%e5%a4%9a%e4%b8%aa%e6%9c%8d%e5%8a%a1httpswwwiris-gocomdocsidrun-multiple-service-using-iris" aria-label="ä½¿ç”¨é¸¢å°¾èŠ±è¿è¡Œå¤šä¸ªæœåŠ¡"><a href="https://www.iris-go.com/docs/#/?id=run-multiple-service-using-iris">ä½¿ç”¨é¸¢å°¾èŠ±è¿è¡Œå¤šä¸ªæœåŠ¡</a></a></li>
                <li>
                    <a href="#%e6%ad%a3%e5%b8%b8%e5%85%b3%e6%9c%ba%e6%88%96%e9%87%8d%e5%90%afhttpswwwiris-gocomdocsidgraceful-shutdown-or-restart" aria-label="æ­£å¸¸å…³æœºæˆ–é‡å¯"><a href="https://www.iris-go.com/docs/#/?id=graceful-shutdown-or-restart">æ­£å¸¸å…³æœºæˆ–é‡å¯</a></a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e6%a8%a1%e6%9d%bf%e6%9e%84%e5%bb%ba%e5%8d%95%e4%b8%aa%e4%ba%8c%e8%bf%9b%e5%88%b6%e6%96%87%e4%bb%b6httpswwwiris-gocomdocsidbuild-a-single-binary-with-templates" aria-label="ä½¿ç”¨æ¨¡æ¿æ„å»ºå•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶"><a href="https://www.iris-go.com/docs/#/?id=build-a-single-binary-with-templates">ä½¿ç”¨æ¨¡æ¿æ„å»ºå•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶</a></a></li>
                <li>
                    <a href="#%e5%b0%9d%e8%af%95%e5%b0%86%e8%ba%ab%e4%bd%93%e7%bb%91%e5%ae%9a%e5%88%b0%e4%b8%8d%e5%90%8c%e7%9a%84%e7%bb%93%e6%9e%84%e4%b8%adhttpswwwiris-gocomdocsidtry-to-bind-body-into-different-structs" aria-label="å°è¯•å°†èº«ä½“ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä¸­"><a href="https://www.iris-go.com/docs/#/?id=try-to-bind-body-into-different-structs">å°è¯•å°†èº«ä½“ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä¸­</a></a></li>
                <li>
                    <a href="#http2-%e6%9c%8d%e5%8a%a1%e5%99%a8%e6%8e%a8%e9%80%81httpswwwiris-gocomdocsidhttp2-server-push" aria-label="HTTP2 æœåŠ¡å™¨æ¨é€"><a href="https://www.iris-go.com/docs/#/?id=http2-server-push">HTTP2 æœåŠ¡å™¨æ¨é€</a></a></li>
                <li>
                    <a href="#%e8%ae%be%e7%bd%ae%e5%b9%b6%e8%8e%b7%e5%8f%96%e9%a5%bc%e5%b9%b2httpswwwiris-gocomdocsidset-and-get-a-cookie" aria-label="è®¾ç½®å¹¶è·å–é¥¼å¹²"><a href="https://www.iris-go.com/docs/#/?id=set-and-get-a-cookie">è®¾ç½®å¹¶è·å–é¥¼å¹²</a></a></li></ul>
                </li>
                <li>
                    <a href="#json-%e7%bd%91%e7%bb%9c%e4%bb%a4%e7%89%8chttpswwwiris-gocomdocsidjson-web-tokens" aria-label="JSON ç½‘ç»œä»¤ç‰Œ"><a href="https://www.iris-go.com/docs/#/?id=json-web-tokens">JSON ç½‘ç»œä»¤ç‰Œ</a></a><ul>
                        
                <li>
                    <a href="#%e4%bd%95%e6%97%b6%e5%ba%94%e4%bd%bf%e7%94%a8-json-web-%e4%bb%a4%e7%89%8chttpswwwiris-gocomdocsidwhen-should-you-use-json-web-tokens" aria-label="ä½•æ—¶åº”ä½¿ç”¨ JSON Web ä»¤ç‰Œï¼Ÿ"><a href="https://www.iris-go.com/docs/#/?id=when-should-you-use-json-web-tokens">ä½•æ—¶åº”ä½¿ç”¨ JSON Web ä»¤ç‰Œï¼Ÿ</a></a></li>
                <li>
                    <a href="#%e5%b0%86-jwt-%e4%b8%8e%e8%99%b9%e8%86%9c%e9%85%8d%e5%90%88%e4%bd%bf%e7%94%a8httpswwwiris-gocomdocsidusing-jwt-with-iris" aria-label="å°† JWT ä¸è™¹è†œé…åˆä½¿ç”¨"><a href="https://www.iris-go.com/docs/#/?id=using-jwt-with-iris">å°† JWT ä¸è™¹è†œé…åˆä½¿ç”¨</a></a></li></ul>
                </li>
                <li>
                    <a href="#%e6%b5%8b%e8%af%95httpswwwiris-gocomdocsidtesting" aria-label="æµ‹è¯•"><a href="https://www.iris-go.com/docs/#/?id=testing">æµ‹è¯•</a></a><ul>
                        
                <li>
                    <a href="#%e6%b5%8b%e8%af%95%e5%9f%ba%e6%9c%ac%e8%ba%ab%e4%bb%bd%e9%aa%8c%e8%af%81httpswwwiris-gocomdocsidtesting-basic-authentication" aria-label="æµ‹è¯•åŸºæœ¬èº«ä»½éªŒè¯"><a href="https://www.iris-go.com/docs/#/?id=testing-basic-authentication">æµ‹è¯•åŸºæœ¬èº«ä»½éªŒè¯</a></a></li>
                <li>
                    <a href="#%e6%b5%8b%e8%af%95%e9%a5%bc%e5%b9%b2httpswwwiris-gocomdocsidtesting-cookies" aria-label="æµ‹è¯•é¥¼å¹²"><a href="https://www.iris-go.com/docs/#/?id=testing-cookies">æµ‹è¯•é¥¼å¹²</a></a></li></ul>
                </li>
                <li>
                    <a href="#%e5%9c%b0%e6%96%b9%e5%8c%96httpswwwiris-gocomdocsidlocalization" aria-label="åœ°æ–¹åŒ–"><a href="https://www.iris-go.com/docs/#/?id=localization">åœ°æ–¹åŒ–</a></a><ul>
                        
                <li>
                    <a href="#%e4%bb%8b%e7%bb%8dhttpswwwiris-gocomdocsidintroduction" aria-label="ä»‹ç»"><a href="https://www.iris-go.com/docs/#/?id=introduction">ä»‹ç»</a></a></li>
                <li>
                    <a href="#%e5%8a%a0%e8%bd%bd%e5%b5%8c%e5%85%a5%e5%bc%8f%e5%8c%ba%e5%9f%9f%e8%ae%be%e7%bd%aehttpswwwiris-gocomdocsidload-embedded-locales" aria-label="åŠ è½½åµŒå…¥å¼åŒºåŸŸè®¾ç½®"><a href="https://www.iris-go.com/docs/#/?id=load-embedded-locales">åŠ è½½åµŒå…¥å¼åŒºåŸŸè®¾ç½®</a></a></li>
                <li>
                    <a href="#%e5%ae%9a%e4%b9%89%e7%bf%bb%e8%af%91httpswwwiris-gocomdocsiddefining-translations" aria-label="å®šä¹‰ç¿»è¯‘"><a href="https://www.iris-go.com/docs/#/?id=defining-translations">å®šä¹‰ç¿»è¯‘</a></a></li>
                <li>
                    <a href="#fmt-%e9%a3%8e%e6%a0%bchttpswwwiris-gocomdocsidfmt-style" aria-label="FMT é£æ ¼"><a href="https://www.iris-go.com/docs/#/?id=fmt-style">FMT é£æ ¼</a></a></li>
                <li>
                    <a href="#%e6%a8%a1%e6%9d%bfhttpswwwiris-gocomdocsidtemplate" aria-label="æ¨¡æ¿"><a href="https://www.iris-go.com/docs/#/?id=template">æ¨¡æ¿</a></a></li>
                <li>
                    <a href="#%e5%a4%9a%e5%85%83%e5%8c%96httpswwwiris-gocomdocsidpluralization" aria-label="å¤šå…ƒåŒ–"><a href="https://www.iris-go.com/docs/#/?id=pluralization">å¤šå…ƒåŒ–</a></a></li>
                <li>
                    <a href="#%e9%83%a8%e5%88%86httpswwwiris-gocomdocsidsections" aria-label="éƒ¨åˆ†"><a href="https://www.iris-go.com/docs/#/?id=sections">éƒ¨åˆ†</a></a></li>
                <li>
                    <a href="#%e7%a1%ae%e5%ae%9a%e5%bd%93%e5%89%8d%e5%8c%ba%e5%9f%9f%e8%ae%be%e7%bd%aehttpswwwiris-gocomdocsiddetermining-the-current-locale" aria-label="ç¡®å®šå½“å‰åŒºåŸŸè®¾ç½®"><a href="https://www.iris-go.com/docs/#/?id=determining-the-current-locale">ç¡®å®šå½“å‰åŒºåŸŸè®¾ç½®</a></a></li>
                <li>
                    <a href="#%e6%a3%80%e7%b4%a2%e7%bf%bb%e8%af%91httpswwwiris-gocomdocsidretrieving-translation" aria-label="æ£€ç´¢ç¿»è¯‘"><a href="https://www.iris-go.com/docs/#/?id=retrieving-translation">æ£€ç´¢ç¿»è¯‘</a></a></li>
                <li>
                    <a href="#%e5%86%85%e9%83%a8%e8%a7%86%e5%9b%behttpswwwiris-gocomdocsidinside-views" aria-label="å†…éƒ¨è§†å›¾"><a href="https://www.iris-go.com/docs/#/?id=inside-views">å†…éƒ¨è§†å›¾</a></a></li>
                <li>
                    <a href="#httpswwwiris-gocomdocsidexample%e4%be%8bhttpsgithubcomkatarasiristreemaster_examplesi18n" aria-label="ä¾‹"><a href="https://www.iris-go.com/docs/#/?id=example"></a><a href="https://github.com/kataras/iris/tree/master/_examples/i18n">ä¾‹</a></a></li>
                <li>
                    <a href="#%e7%bd%91%e7%ab%99%e5%9c%b0%e5%9b%behttpswwwiris-gocomdocsidsitemap" aria-label="ç½‘ç«™åœ°å›¾"><a href="https://www.iris-go.com/docs/#/?id=sitemap">ç½‘ç«™åœ°å›¾</a></a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
        
        activeElement = elements[0];
        const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
        document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
    }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        if (elements) {
            activeElement = Array.from(elements).find((element) => {
                if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                    (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                    return element;
                }
            }) || activeElement

            elements.forEach(element => {
                const id = encodeURI(element.getAttribute('id')).toLowerCase();
                if (element === activeElement){
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
                } else {
                    document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
                }
            })
        }
    }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;
        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>
        <div class="post-content"><p>è½¬è‡ªï¼š<a href="https://www.iris-go.com/docs/#/">Iris</a></p>
<h2 id="å®‰è£…httpswwwiris-gocomdocsidinstallation"><a href="https://www.iris-go.com/docs/#/?id=installation">å®‰è£…</a><a hidden class="anchor" aria-hidden="true" href="#å®‰è£…httpswwwiris-gocomdocsidinstallation">#</a></h2>
<p>Irisæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„è½¯ä»¶ã€‚</p>
<p>å”¯ä¸€çš„è¦æ±‚æ˜¯ <a href="https://go.dev/dl/">Go ç¼–ç¨‹è¯­è¨€</a>ï¼Œç‰ˆæœ¬ 1.20 åŠæ›´é«˜ç‰ˆæœ¬ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ mkdir myapp
</span></span><span style="display:flex;"><span>$ cd myapp
</span></span><span style="display:flex;"><span>$ go mod init myapp
</span></span><span style="display:flex;"><span>$ go get github.com/kataras/iris/v12@latest
</span></span></code></pre></div><p>å°†å…¶å¯¼å…¥åˆ°ä»£ç ä¸­ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>import &#34;github.com/kataras/iris/v12&#34;
</span></span></code></pre></div><h3 id="æ•…éšœ-æ’é™¤httpswwwiris-gocomdocsidtroubleshooting"><a href="https://www.iris-go.com/docs/#/?id=troubleshooting">æ•…éšœ æ’é™¤</a><a hidden class="anchor" aria-hidden="true" href="#æ•…éšœ-æ’é™¤httpswwwiris-gocomdocsidtroubleshooting">#</a></h3>
<p>å¦‚æœåœ¨å®‰è£…è¿‡ç¨‹ä¸­é‡åˆ°ç½‘ç»œé”™è¯¯ï¼Œè¯·ç¡®ä¿è®¾ç½®äº†æœ‰æ•ˆçš„ <a href="https://github.com/golang/go/wiki/Modules#are-there-always-on-module-repositories-and-enterprise-proxies">GOPROXY ç¯å¢ƒå˜é‡</a>ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>go env -w GOPROXY=https://goproxy.io,direct
</span></span></code></pre></div><p>å¦‚æœä¸Šè¿°æ–¹æ³•å‡æ— æ•ˆï¼Œè¯·æ¸…ç† go æ¨¡å—ç¼“å­˜ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>go clean --modcache
</span></span></code></pre></div><h2 id="å¿«é€Ÿå…¥é—¨httpswwwiris-gocomdocsidquick-start"><a href="https://www.iris-go.com/docs/#/?id=quick-start">å¿«é€Ÿå…¥é—¨</a><a hidden class="anchor" aria-hidden="true" href="#å¿«é€Ÿå…¥é—¨httpswwwiris-gocomdocsidquick-start">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># assume the following codes in main.go file
</span></span><span style="display:flex;"><span>$ cat main.go
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">booksAPI</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Party</span>(<span style="color:#e6db74">&#34;/books&#34;</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">booksAPI</span>.<span style="color:#a6e22e">Use</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Compression</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// GET: http://localhost:8080/books
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">booksAPI</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">list</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// POST: http://localhost:8080/books
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">booksAPI</span>.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">create</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Book example.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Book</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Title</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;title&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">list</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">books</span> <span style="color:#f92672">:=</span> []<span style="color:#a6e22e">Book</span>{
</span></span><span style="display:flex;"><span>        {<span style="color:#e6db74">&#34;Mastering Concurrency in Go&#34;</span>},
</span></span><span style="display:flex;"><span>        {<span style="color:#e6db74">&#34;Go Design Patterns&#34;</span>},
</span></span><span style="display:flex;"><span>        {<span style="color:#e6db74">&#34;Black Hat Go&#34;</span>},
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">books</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TIP: negotiate the response between server&#39;s prioritizes
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// and client&#39;s requirements, instead of ctx.JSON:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// ctx.Negotiation().JSON().MsgPack().Protobuf()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// ctx.Negotiate(books)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">create</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">b</span> <span style="color:#a6e22e">Book</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ReadJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">b</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// TIP: use ctx.ReadBody(&amp;b) to bind
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// any type of incoming data instead.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithProblem</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusBadRequest</span>, <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">NewProblem</span>().
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Title</span>(<span style="color:#e6db74">&#34;Book creation failure&#34;</span>).<span style="color:#a6e22e">DetailErr</span>(<span style="color:#a6e22e">err</span>))
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// TIP: use ctx.StopWithError(code, err) when only
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// plain text responses are expected on errors.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    println(<span style="color:#e6db74">&#34;Received Book: &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">b</span>.<span style="color:#a6e22e">Title</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StatusCode</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusCreated</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>MVC</strong> ç­‰æ•ˆé¡¹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>import &#34;github.com/kataras/iris/v12/mvc&#34;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>m := mvc.New(booksAPI)
</span></span><span style="display:flex;"><span>m.Handle(new(BookController))
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>type BookController struct {
</span></span><span style="display:flex;"><span>    /* dependencies */
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// GET: http://localhost:8080/books
</span></span><span style="display:flex;"><span>func (c *BookController) Get() []Book {
</span></span><span style="display:flex;"><span>    return []Book{
</span></span><span style="display:flex;"><span>        {&#34;Mastering Concurrency in Go&#34;},
</span></span><span style="display:flex;"><span>        {&#34;Go Design Patterns&#34;},
</span></span><span style="display:flex;"><span>        {&#34;Black Hat Go&#34;},
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// POST: http://localhost:8080/books
</span></span><span style="display:flex;"><span>func (c *BookController) Post(b Book) int {
</span></span><span style="display:flex;"><span>    println(&#34;Received Book: &#34; + b.Title)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    return iris.StatusCreated
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>è¿è¡Œ</strong>æ‚¨çš„é¸¢å°¾èŠ±ç½‘ç»œæœåŠ¡å™¨ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ go run main.go
</span></span><span style="display:flex;"><span>&gt; Now listening on: http://localhost:8080
</span></span><span style="display:flex;"><span>&gt; Application started. Press CTRL+C to shut down.
</span></span></code></pre></div><p><strong>åˆ—è¡¨</strong>ä¹¦ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ curl --header &#39;Accept-Encoding:gzip&#39; http://localhost:8080/books
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    &#34;title&#34;: &#34;Mastering Concurrency in Go&#34;
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    &#34;title&#34;: &#34;Go Design Patterns&#34;
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  {
</span></span><span style="display:flex;"><span>    &#34;title&#34;: &#34;Black Hat Go&#34;
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>]
</span></span></code></pre></div><p><strong>åˆ›å»ºæ–°</strong>å›¾ä¹¦ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ curl -i -X POST \
</span></span><span style="display:flex;"><span>--header &#39;Content-Encoding:gzip&#39; \
</span></span><span style="display:flex;"><span>--header &#39;Content-Type:application/json&#39; \
</span></span><span style="display:flex;"><span>--data &#34;{\&#34;title\&#34;:\&#34;Writing An Interpreter In Go\&#34;}&#34; \
</span></span><span style="display:flex;"><span>http://localhost:8080/books
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; HTTP/1.1 201 Created
</span></span></code></pre></div><p><strong>è¿™å°±æ˜¯é”™è¯¯</strong>å“åº”çš„æ ·å­ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ curl -X POST --data &#34;{\&#34;title\&#34; \&#34;not valid one\&#34;}&#34; \
</span></span><span style="display:flex;"><span>http://localhost:8080/books
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&gt; HTTP/1.1 400 Bad Request
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  &#34;status&#34;: 400,
</span></span><span style="display:flex;"><span>  &#34;title&#34;: &#34;Book creation failure&#34;
</span></span><span style="display:flex;"><span>  &#34;detail&#34;: &#34;invalid character &#39;\&#34;&#39; after object key&#34;,
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><a href="https://replit.com/@kataras/Iris-Hello-World-v1220?v=1"><img loading="lazy" src="https://img.shields.io/badge/Run-in%20the%20Browser-348798.svg?style=for-the-badge&amp;logo=repl.it" alt="åœ¨æµè§ˆå™¨ä¸­è¿è¡Œ"  />
</a></p>
<h2 id="åŸºå‡†httpswwwiris-gocomdocsidbenchmarks"><a href="https://www.iris-go.com/docs/#/?id=benchmarks">åŸºå‡†</a><a hidden class="anchor" aria-hidden="true" href="#åŸºå‡†httpswwwiris-gocomdocsidbenchmarks">#</a></h2>
<p>Irisä½¿ç”¨<a href="https://github.com/kataras/muxie">muxie</a>çš„è‡ªå®šä¹‰ç‰ˆæœ¬ã€‚</p>
<p><a href="https://github.com/kataras/server-benchmarks">æŸ¥çœ‹æ‰€æœ‰åŸºå‡†</a></p>
<p>ğŸ“– ä½¿ç”¨ int çš„åŠ¨æ€å‚æ•°è§¦å‘ 200000 ä¸ªè¯·æ±‚ï¼Œå°† JSON ä½œä¸ºè¯·æ±‚æ­£æ–‡å‘é€ï¼Œå¹¶æ¥æ”¶ JSON ä½œä¸ºå“åº”ã€‚</p>
<table>
<thead>
<tr>
<th>åå­—</th>
<th style="text-align:left">è¯­è¨€</th>
<th style="text-align:left">è¦æ±‚/ç§’</th>
<th style="text-align:left">å»¶è¿Ÿ</th>
<th style="text-align:left">ååé‡</th>
<th style="text-align:left">å®Œæˆæ—¶é—´</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://github.com/kataras/iris">è™¹è†œ</a></td>
<td style="text-align:left">å»</td>
<td style="text-align:left">238954</td>
<td style="text-align:left">521.69ä¹Œç§’</td>
<td style="text-align:left">64.15å…†å­—èŠ‚</td>
<td style="text-align:left">0.84ç§’</td>
</tr>
<tr>
<td><a href="https://github.com/gin-gonic/gin">ç´é…’</a></td>
<td style="text-align:left">å»</td>
<td style="text-align:left">229665</td>
<td style="text-align:left">541.96ä¹Œç§’</td>
<td style="text-align:left">62.86å…†å­—èŠ‚</td>
<td style="text-align:left">0.87ç§’</td>
</tr>
<tr>
<td><a href="https://github.com/go-chi/chi">æ± </a></td>
<td style="text-align:left">å»</td>
<td style="text-align:left">228072</td>
<td style="text-align:left">545.78ä¹Œç§’</td>
<td style="text-align:left">62.61å…†å­—èŠ‚</td>
<td style="text-align:left">0.88ç§’</td>
</tr>
<tr>
<td><a href="https://github.com/labstack/echo">å›æ³¢</a></td>
<td style="text-align:left">å»</td>
<td style="text-align:left">224491</td>
<td style="text-align:left">553.84ä¹Œç§’</td>
<td style="text-align:left">61.70å…†å­—èŠ‚</td>
<td style="text-align:left">0.89ç§’</td>
</tr>
<tr>
<td><a href="https://github.com/go-martini/martini">é©¬æå°¼é…’</a></td>
<td style="text-align:left">å»</td>
<td style="text-align:left">198166</td>
<td style="text-align:left">627.46ä¹Œç§’</td>
<td style="text-align:left">54.47å…†å­—èŠ‚</td>
<td style="text-align:left">1.01ç§’</td>
</tr>
<tr>
<td><a href="https://github.com/dotnet/aspnetcore">èŒ¶éš¼</a></td>
<td style="text-align:left">C#</td>
<td style="text-align:left">163486</td>
<td style="text-align:left">766.90ä¹Œç§’</td>
<td style="text-align:left">47.42å…†å­—èŠ‚</td>
<td style="text-align:left">1.23ç§’</td>
</tr>
<tr>
<td><a href="https://github.com/gobuffalo/buffalo">æ°´ç‰›</a></td>
<td style="text-align:left">å»</td>
<td style="text-align:left">102478</td>
<td style="text-align:left">1.22æ¯«ç§’</td>
<td style="text-align:left">28.14å…†å­—èŠ‚</td>
<td style="text-align:left">1.95ç§’</td>
</tr>
<tr>
<td><a href="https://github.com/koajs/koa">ç§‘é˜¿</a></td>
<td style="text-align:left">çˆªå“‡è¯­</td>
<td style="text-align:left">48425</td>
<td style="text-align:left">2.56æ¯«ç§’</td>
<td style="text-align:left">15.39å…†å­—èŠ‚</td>
<td style="text-align:left">4.14ç§’</td>
</tr>
<tr>
<td><a href="https://github.com/expressjs/express">è¡¨è¾¾</a></td>
<td style="text-align:left">çˆªå“‡è¯­</td>
<td style="text-align:left">23622</td>
<td style="text-align:left">5.25æ¯«ç§’</td>
<td style="text-align:left">9.04å…†å­—èŠ‚</td>
<td style="text-align:left">8.41ç§’</td>
</tr>
</tbody>
</table>
<h2 id="æ¥å£ç¤ºä¾‹httpswwwiris-gocomdocsidapi-examples"><a href="https://www.iris-go.com/docs/#/?id=api-examples">æ¥å£ç¤ºä¾‹</a><a hidden class="anchor" aria-hidden="true" href="#æ¥å£ç¤ºä¾‹httpswwwiris-gocomdocsidapi-examples">#</a></h2>
<p>æ‚¨å¯ä»¥åœ¨ <a href="https://github.com/iris-contrib/examples">Iris ç¤ºä¾‹å­˜å‚¨åº“</a>ä¸­æ‰¾åˆ°è®¸å¤šéšæ—¶å¯ä»¥è¿è¡Œçš„ç¤ºä¾‹ã€‚</p>
<h3 id="ä½¿ç”¨è·å–å‘å¸ƒæ”¾ç½®ä¿®è¡¥åˆ é™¤å’Œé€‰é¡¹httpswwwiris-gocomdocsidusing-get-post-put-patch-delete-and-options"><a href="https://www.iris-go.com/docs/#/?id=using-get-post-put-patch-delete-and-options">ä½¿ç”¨è·å–ã€å‘å¸ƒã€æ”¾ç½®ã€ä¿®è¡¥ã€åˆ é™¤å’Œé€‰é¡¹</a><a hidden class="anchor" aria-hidden="true" href="#ä½¿ç”¨è·å–å‘å¸ƒæ”¾ç½®ä¿®è¡¥åˆ é™¤å’Œé€‰é¡¹httpswwwiris-gocomdocsidusing-get-post-put-patch-delete-and-options">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    // Creates an iris application with default middleware:
</span></span><span style="display:flex;"><span>    // Default with &#34;debug&#34; Logger Level.
</span></span><span style="display:flex;"><span>    // Localization enabled on &#34;./locales&#34; directory
</span></span><span style="display:flex;"><span>    // and HTML templates on &#34;./views&#34; or &#34;./templates&#34; directory.
</span></span><span style="display:flex;"><span>    // It runs with the AccessLog on &#34;./access.log&#34;,
</span></span><span style="display:flex;"><span>    // Recovery (crash-free) and Request ID middleware already attached.
</span></span><span style="display:flex;"><span>    app := iris.Default()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Get(&#34;/someGet&#34;, getting)
</span></span><span style="display:flex;"><span>    app.Post(&#34;/somePost&#34;, posting)
</span></span><span style="display:flex;"><span>    app.Put(&#34;/somePut&#34;, putting)
</span></span><span style="display:flex;"><span>    app.Delete(&#34;/someDelete&#34;, deleting)
</span></span><span style="display:flex;"><span>    app.Patch(&#34;/somePatch&#34;, patching)
</span></span><span style="display:flex;"><span>    app.Header(&#34;/someHead&#34;, head)
</span></span><span style="display:flex;"><span>    app.Options(&#34;/someOptions&#34;, options)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="è·¯å¾„ä¸­çš„å‚æ•°httpswwwiris-gocomdocsidparameters-in-path"><a href="https://www.iris-go.com/docs/#/?id=parameters-in-path">è·¯å¾„ä¸­çš„å‚æ•°</a><a hidden class="anchor" aria-hidden="true" href="#è·¯å¾„ä¸­çš„å‚æ•°httpswwwiris-gocomdocsidparameters-in-path">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.Default()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // This handler will match /user/john but will not match /user/ or /user
</span></span><span style="display:flex;"><span>    app.Get(&#34;/user/{name}&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        name := ctx.Params().Get(&#34;name&#34;)
</span></span><span style="display:flex;"><span>        ctx.Writef(&#34;Hello %s&#34;, name)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // However, this one will match /user/john/ and also /user/john/send
</span></span><span style="display:flex;"><span>    // If no other routers match /user/john, it will redirect to /user/john/
</span></span><span style="display:flex;"><span>    app.Get(&#34;/user/{name}/{action:path}&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        name := ctx.Params().Get(&#34;name&#34;)
</span></span><span style="display:flex;"><span>        action := ctx.Params().Get(&#34;action&#34;)
</span></span><span style="display:flex;"><span>        message := name + &#34; is &#34; + action
</span></span><span style="display:flex;"><span>        ctx.WriteString(message)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // For each matched request Context will hold the route definition
</span></span><span style="display:flex;"><span>    app.Post(&#34;/user/{name:string}/{action:path}&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        ctx.GetCurrentRoute().Tmpl().Src == &#34;/user/{name:string}/{action:path}&#34; // true
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å†…ç½®å¯ç”¨å‚æ•°ç±»å‹ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align:left">å‚æ•°ç±»å‹</th>
<th style="text-align:left">å»ç±»å‹</th>
<th style="text-align:left">éªŒè¯</th>
<th style="text-align:left">æ£€ç´¢å¸®åŠ©ç¨‹åº</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><code>:string</code></td>
<td style="text-align:left">å­—ç¬¦ä¸²</td>
<td style="text-align:left">ä»»ä½•ï¼ˆå•è·¯å¾„æ®µï¼‰</td>
<td style="text-align:left"><code>Params().Get</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:uuid</code></td>
<td style="text-align:left">å­—ç¬¦ä¸²</td>
<td style="text-align:left">uuidv4 æˆ– v1ï¼ˆå•è·¯å¾„æ®µï¼‰</td>
<td style="text-align:left"><code>Params().Get</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:int</code></td>
<td style="text-align:left">å›½é™…</td>
<td style="text-align:left">-9223372036854775808 åˆ° 9223372036854775807 ï¼ˆx64ï¼‰ æˆ– -2147483648 åˆ° 2147483647 ï¼ˆx32ï¼‰ï¼Œå–å†³äºä¸»æœºæ¶æ„</td>
<td style="text-align:left"><code>Params().GetInt</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:int8</code></td>
<td style="text-align:left">å›½é™…8</td>
<td style="text-align:left">-128 åˆ° 127</td>
<td style="text-align:left"><code>Params().GetInt8</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:int16</code></td>
<td style="text-align:left">å›½é™…16</td>
<td style="text-align:left">-32768 åˆ° 32767</td>
<td style="text-align:left"><code>Params().GetInt16</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:int32</code></td>
<td style="text-align:left">å›½é™…32</td>
<td style="text-align:left">-2147483648 åˆ° 2147483647</td>
<td style="text-align:left"><code>Params().GetInt32</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:int64</code></td>
<td style="text-align:left">å›½é™…64</td>
<td style="text-align:left">-9223372036854775808 åˆ° 9223372036854775807</td>
<td style="text-align:left"><code>Params().GetInt64</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:uint</code></td>
<td style="text-align:left">ä¹Œå› ç‰¹</td>
<td style="text-align:left">0 åˆ° 18446744073709551615 ï¼ˆx64ï¼‰ æˆ– 0 åˆ° 4294967295 ï¼ˆx32ï¼‰ï¼Œå–å†³äºä¸»æœºæ¶æ„</td>
<td style="text-align:left"><code>Params().GetUint</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:uint8</code></td>
<td style="text-align:left">uint8</td>
<td style="text-align:left">0 åˆ° 255</td>
<td style="text-align:left"><code>Params().GetUint8</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:uint16</code></td>
<td style="text-align:left">uint16</td>
<td style="text-align:left">0 åˆ° 65535</td>
<td style="text-align:left"><code>Params().GetUint16</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:uint32</code></td>
<td style="text-align:left">uint32</td>
<td style="text-align:left">0 åˆ° 4294967295</td>
<td style="text-align:left"><code>Params().GetUint32</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:uint64</code></td>
<td style="text-align:left">uint64</td>
<td style="text-align:left">0 åˆ° 18446744073709551615</td>
<td style="text-align:left"><code>Params().GetUint64</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:bool</code></td>
<td style="text-align:left">å¸ƒå°”</td>
<td style="text-align:left">â€œ1â€æˆ–â€œtâ€æˆ–â€œTâ€æˆ–â€œçœŸâ€æˆ–â€œçœŸâ€æˆ–â€œçœŸâ€æˆ–â€œ0â€æˆ–â€œfâ€æˆ–â€œFâ€æˆ–â€œå‡â€æˆ–â€œå‡â€æˆ–â€œå‡â€</td>
<td style="text-align:left"><code>Params().GetBool</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:alphabetical</code></td>
<td style="text-align:left">å­—ç¬¦ä¸²</td>
<td style="text-align:left">å°å†™æˆ–å¤§å†™å­—æ¯</td>
<td style="text-align:left"><code>Params().Get</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:file</code></td>
<td style="text-align:left">å­—ç¬¦ä¸²</td>
<td style="text-align:left">å°å†™æˆ–å¤§å†™å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ ï¼ˆ_ï¼‰ã€çŸ­åˆ’çº¿ ï¼ˆ-ï¼‰ã€ç‚¹ ï¼ˆ.ï¼‰ å¹¶ä¸”æ²¡æœ‰ç©ºæ ¼æˆ–å…¶ä»–å¯¹æ–‡ä»¶åæ— æ•ˆçš„ç‰¹æ®Šå­—ç¬¦</td>
<td style="text-align:left"><code>Params().Get</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:path</code></td>
<td style="text-align:left">å­—ç¬¦ä¸²</td>
<td style="text-align:left">ä»»ä½•å†…å®¹éƒ½å¯ä»¥ç”¨æ–œæ ï¼ˆè·¯å¾„æ®µï¼‰åˆ†éš”ï¼Œä½†åº”è¯¥æ˜¯è·¯ç”±è·¯å¾„çš„æœ€åä¸€éƒ¨åˆ†</td>
<td style="text-align:left"><code>Params().Get</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:mail</code></td>
<td style="text-align:left">å­—ç¬¦ä¸²</td>
<td style="text-align:left">æœªç»åŸŸéªŒè¯çš„ç”µå­é‚®ä»¶</td>
<td style="text-align:left"><code>Params().Get</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:email</code></td>
<td style="text-align:left">å­—ç¬¦ä¸²</td>
<td style="text-align:left">å…·æœ‰åŸŸéªŒè¯åŠŸèƒ½çš„ç”µå­é‚®ä»¶</td>
<td style="text-align:left"><code>Params().Get</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:date</code></td>
<td style="text-align:left">å­—ç¬¦ä¸²</td>
<td style="text-align:left">å¹´/æœˆ/æ—¥æ ¼å¼ï¼Œä¾‹å¦‚ /åšå®¢/{å‚æ•°ï¼šæ—¥æœŸ} åŒ¹é… /åšå®¢/2022/04/21</td>
<td style="text-align:left"><code>Params().GetTime</code>å’Œ<code>Params().SimpleDate</code></td>
</tr>
<tr>
<td style="text-align:left"><code>:weekday</code></td>
<td style="text-align:left">uint ï¼ˆ0-6ï¼‰ æˆ–å­—ç¬¦ä¸²</td>
<td style="text-align:left">æ—¶é—´ä¸²ã€‚å·¥ä½œæ—¥é•¿åç§°æ ¼å¼ï¼ˆâ€œæ˜ŸæœŸæ—¥â€åˆ°â€œæ˜ŸæœŸä¸€â€æˆ–â€œæ˜ŸæœŸæ—¥â€åˆ°â€œæ˜ŸæœŸä¸€â€ï¼‰æ ¼å¼ï¼Œä¾‹å¦‚ /schedule/{paramï¼šweekday} åŒ¹é… /schedule/æ˜ŸæœŸä¸€</td>
<td style="text-align:left"><code>Params().GetWeekday</code></td>
</tr>
</tbody>
</table>
<p>æ›´å¤šç¤ºä¾‹å¯åœ¨ä»¥ä¸‹ä½ç½®æ‰¾åˆ°ï¼š<a href="https://github.com/kataras/iris/tree/master/_examples/routing">_examples/è·¯ç”±</a>ã€‚</p>
<h3 id="æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°httpswwwiris-gocomdocsidquerystring-parameters"><a href="https://www.iris-go.com/docs/#/?id=querystring-parameters">æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°</a><a hidden class="anchor" aria-hidden="true" href="#æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°httpswwwiris-gocomdocsidquerystring-parameters">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.Default()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // Query string parameters are parsed using the existing underlying request object.
</span></span><span style="display:flex;"><span>    // The request responds to a url matching:  /welcome?firstname=Jane&amp;lastname=Doe
</span></span><span style="display:flex;"><span>    app.Get(&#34;/welcome&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        firstname := ctx.URLParamDefault(&#34;firstname&#34;, &#34;Guest&#34;)
</span></span><span style="display:flex;"><span>        lastname := ctx.URLParam(&#34;lastname&#34;) // shortcut for ctx.Request().URL.Query().Get(&#34;lastname&#34;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ctx.Writef(&#34;Hello %s %s&#34;, firstname, lastname)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="å¤šéƒ¨åˆ†ä¹Œä¼¦ç¼–ç å½¢å¼httpswwwiris-gocomdocsidmultiparturlencoded-form"><a href="https://www.iris-go.com/docs/#/?id=multiparturlencoded-form">å¤šéƒ¨åˆ†/ä¹Œä¼¦ç¼–ç å½¢å¼</a><a hidden class="anchor" aria-hidden="true" href="#å¤šéƒ¨åˆ†ä¹Œä¼¦ç¼–ç å½¢å¼httpswwwiris-gocomdocsidmultiparturlencoded-form">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.Default()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Post(&#34;/form_post&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        message := ctx.PostValue(&#34;message&#34;)
</span></span><span style="display:flex;"><span>        nick := ctx.PostValueDefault(&#34;nick&#34;, &#34;anonymous&#34;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ctx.JSON(iris.Map{
</span></span><span style="display:flex;"><span>            &#34;status&#34;:  &#34;posted&#34;,
</span></span><span style="display:flex;"><span>            &#34;message&#34;: message,
</span></span><span style="display:flex;"><span>            &#34;nick&#34;:    nick,
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="å†æ¯”å¦‚æŸ¥è¯¢å¸–å­è¡¨å•httpswwwiris-gocomdocsidanother-example-query-post-form"><a href="https://www.iris-go.com/docs/#/?id=another-example-query-post-form">å†æ¯”å¦‚ï¼šæŸ¥è¯¢+å¸–å­è¡¨å•</a><a hidden class="anchor" aria-hidden="true" href="#å†æ¯”å¦‚æŸ¥è¯¢å¸–å­è¡¨å•httpswwwiris-gocomdocsidanother-example-query-post-form">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>POST /post?id=1234&amp;page=1 HTTP/1.1
</span></span><span style="display:flex;"><span>Content-Type: application/x-www-form-urlencoded
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>name=kataras&amp;message=this_is_great
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.Default()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Post(&#34;/post&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        id, err := ctx.URLParamInt(&#34;id&#34;, 0)
</span></span><span style="display:flex;"><span>        if err != nil {
</span></span><span style="display:flex;"><span>            ctx.StopWithError(iris.StatusBadRequest, err)
</span></span><span style="display:flex;"><span>            return
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        page := ctx.URLParamIntDefault(&#34;page&#34;, 0)
</span></span><span style="display:flex;"><span>        name := ctx.PostValue(&#34;name&#34;)
</span></span><span style="display:flex;"><span>        message := ctx.PostValue(&#34;message&#34;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ctx.Writef(&#34;id: %d; page: %d; name: %s; message: %s&#34;, id, page, name, message)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>id: 1234; page: 1; name: kataras; message: this_is_great
</span></span></code></pre></div><p>(adsbygoogle = window.adsbygoogle || []).push({});</p>
<h3 id="æŸ¥è¯¢å’Œå‘å¸ƒè¡¨å•å‚æ•°httpswwwiris-gocomdocsidquery-and-post-form-parameters"><a href="https://www.iris-go.com/docs/#/?id=query-and-post-form-parameters">æŸ¥è¯¢å’Œå‘å¸ƒè¡¨å•å‚æ•°</a><a hidden class="anchor" aria-hidden="true" href="#æŸ¥è¯¢å’Œå‘å¸ƒè¡¨å•å‚æ•°httpswwwiris-gocomdocsidquery-and-post-form-parameters">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>POST /post?id=a&amp;id=b&amp;id=c&amp;name=john&amp;name=doe&amp;name=kataras
</span></span><span style="display:flex;"><span>Content-Type: application/x-www-form-urlencoded
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.Default()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Post(&#34;/post&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ids := ctx.URLParamSlice(&#34;id&#34;)
</span></span><span style="display:flex;"><span>        names, err := ctx.PostValues(&#34;name&#34;)
</span></span><span style="display:flex;"><span>        if err != nil {
</span></span><span style="display:flex;"><span>            ctx.StopWithError(iris.StatusBadRequest, err)
</span></span><span style="display:flex;"><span>            return
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ctx.Writef(&#34;ids: %v; names: %v&#34;, ids, names)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ids: [a b c], names: [john doe kataras]
</span></span></code></pre></div><h3 id="ä¸Šä¼ æ–‡ä»¶httpswwwiris-gocomdocsidupload-files"><a href="https://www.iris-go.com/docs/#/?id=upload-files">ä¸Šä¼ æ–‡ä»¶</a><a hidden class="anchor" aria-hidden="true" href="#ä¸Šä¼ æ–‡ä»¶httpswwwiris-gocomdocsidupload-files">#</a></h3>
<h4 id="å•ä¸ªæ–‡ä»¶httpswwwiris-gocomdocsidsingle-file"><a href="https://www.iris-go.com/docs/#/?id=single-file">å•ä¸ªæ–‡ä»¶</a><a hidden class="anchor" aria-hidden="true" href="#å•ä¸ªæ–‡ä»¶httpswwwiris-gocomdocsidsingle-file">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>const maxSize = 8 * iris.MB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.Default()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Post(&#34;/upload&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        // Set a lower memory limit for multipart forms (default is 32 MiB)
</span></span><span style="display:flex;"><span>        ctx.SetMaxRequestBodySize(maxSize)
</span></span><span style="display:flex;"><span>        // OR
</span></span><span style="display:flex;"><span>        // app.Use(iris.LimitRequestBodySize(maxSize))
</span></span><span style="display:flex;"><span>        // OR
</span></span><span style="display:flex;"><span>        // OR iris.WithPostMaxMemory(maxSize)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        // single file
</span></span><span style="display:flex;"><span>        file, fileHeader, err:= ctx.FormFile(&#34;file&#34;)
</span></span><span style="display:flex;"><span>        if err != nil {
</span></span><span style="display:flex;"><span>            ctx.StopWithError(iris.StatusBadRequest, err)
</span></span><span style="display:flex;"><span>            return
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        // Upload the file to specific destination.
</span></span><span style="display:flex;"><span>        dest := filepath.Join(&#34;./uploads&#34;, fileHeader.Filename)
</span></span><span style="display:flex;"><span>        ctx.SaveFormFile(fileHeader, dest)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ctx.Writef(&#34;File: %s uploaded!&#34;, fileHeader.Filename)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¦‚ä½•ï¼š<code>curl</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>curl -X POST http://localhost:8080/upload \
</span></span><span style="display:flex;"><span>  -F &#34;file=@/Users/kataras/test.zip&#34; \
</span></span><span style="display:flex;"><span>  -H &#34;Content-Type: multipart/form-data&#34;
</span></span></code></pre></div><h4 id="å¤šä¸ªæ–‡ä»¶httpswwwiris-gocomdocsidmultiple-files"><a href="https://www.iris-go.com/docs/#/?id=multiple-files">å¤šä¸ªæ–‡ä»¶</a><a hidden class="anchor" aria-hidden="true" href="#å¤šä¸ªæ–‡ä»¶httpswwwiris-gocomdocsidmultiple-files">#</a></h4>
<p>è¯·å‚é˜…è¯¦ç»†çš„<a href="https://github.com/kataras/iris/tree/master/_examples/file-server/upload-files">ç¤ºä¾‹ä»£ç </a>ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.Default()
</span></span><span style="display:flex;"><span>    app.Post(&#34;/upload&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        files, n, err := ctx.UploadFormFiles(&#34;./uploads&#34;)
</span></span><span style="display:flex;"><span>        if err != nil {
</span></span><span style="display:flex;"><span>            ctx.StopWithStatus(iris.StatusInternalServerError)
</span></span><span style="display:flex;"><span>            return
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ctx.Writef(&#34;%d files of %d total size uploaded!&#34;, len(files), n))
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;, iris.WithPostMaxMemory(8 * iris.MB))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¦‚ä½•ï¼š<code>curl</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>curl -X POST http://localhost:8080/upload \
</span></span><span style="display:flex;"><span>  -F &#34;upload[]=@/Users/kataras/test1.zip&#34; \
</span></span><span style="display:flex;"><span>  -F &#34;upload[]=@/Users/kataras/test2.zip&#34; \
</span></span><span style="display:flex;"><span>  -H &#34;Content-Type: multipart/form-data&#34;
</span></span></code></pre></div><h3 id="å¯¹è·¯çº¿è¿›è¡Œåˆ†ç»„httpswwwiris-gocomdocsidgrouping-routes"><a href="https://www.iris-go.com/docs/#/?id=grouping-routes">å¯¹è·¯çº¿è¿›è¡Œåˆ†ç»„</a><a hidden class="anchor" aria-hidden="true" href="#å¯¹è·¯çº¿è¿›è¡Œåˆ†ç»„httpswwwiris-gocomdocsidgrouping-routes">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.Default()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // Simple group: v1
</span></span><span style="display:flex;"><span>    v1 := app.Party(&#34;/v1&#34;)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        v1.Post(&#34;/login&#34;, loginEndpoint)
</span></span><span style="display:flex;"><span>        v1.Post(&#34;/submit&#34;, submitEndpoint)
</span></span><span style="display:flex;"><span>        v1.Post(&#34;/read&#34;, readEndpoint)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // Simple group: v2
</span></span><span style="display:flex;"><span>    v2 := app.Party(&#34;/v2&#34;)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        v2.Post(&#34;/login&#34;, loginEndpoint)
</span></span><span style="display:flex;"><span>        v2.Post(&#34;/submit&#34;, submitEndpoint)
</span></span><span style="display:flex;"><span>        v2.Post(&#34;/read&#34;, readEndpoint)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="é»˜è®¤ä¸å¸¦ä¸­é—´ä»¶çš„ç©ºç™½å…‰åœˆhttpswwwiris-gocomdocsidblank-iris-without-middleware-by-default"><a href="https://www.iris-go.com/docs/#/?id=blank-iris-without-middleware-by-default">é»˜è®¤ä¸å¸¦ä¸­é—´ä»¶çš„ç©ºç™½å…‰åœˆ</a><a hidden class="anchor" aria-hidden="true" href="#é»˜è®¤ä¸å¸¦ä¸­é—´ä»¶çš„ç©ºç™½å…‰åœˆhttpswwwiris-gocomdocsidblank-iris-without-middleware-by-default">#</a></h3>
<p>ç”¨</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>app := iris.New()
</span></span></code></pre></div><p>è€Œä¸æ˜¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>// Default with &#34;debug&#34; Logger Level.
</span></span><span style="display:flex;"><span>// Localization enabled on &#34;./locales&#34; directory
</span></span><span style="display:flex;"><span>// and HTML templates on &#34;./views&#34; or &#34;./templates&#34; directory.
</span></span><span style="display:flex;"><span>// It runs with the AccessLog on &#34;./access.log&#34;,
</span></span><span style="display:flex;"><span>// Recovery and Request ID middleware already attached.
</span></span><span style="display:flex;"><span>app := iris.Default()
</span></span></code></pre></div><h3 id="ä½¿ç”¨ä¸­é—´ä»¶httpswwwiris-gocomdocsidusing-middleware"><a href="https://www.iris-go.com/docs/#/?id=using-middleware">ä½¿ç”¨ä¸­é—´ä»¶</a><a hidden class="anchor" aria-hidden="true" href="#ä½¿ç”¨ä¸­é—´ä»¶httpswwwiris-gocomdocsidusing-middleware">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>package main
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12/middleware/recover&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>func <span style="color:#a6e22e">main</span>() <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> Creates an iris application without any middleware <span style="color:#66d9ef">by</span> <span style="color:#66d9ef">default</span>
</span></span><span style="display:flex;"><span>    app :<span style="color:#f92672">=</span> iris.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> Global middleware <span style="color:#66d9ef">using</span> <span style="color:#f92672">`</span>UseRouter<span style="color:#f92672">`</span>.
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> Recovery middleware recovers <span style="color:#66d9ef">from</span> any panics <span style="color:#66d9ef">and</span> writes a <span style="color:#ae81ff">500</span> <span style="color:#66d9ef">if</span> there was one.
</span></span><span style="display:flex;"><span>    app.<span style="color:#a6e22e">UseRouter</span>(recover.<span style="color:#a6e22e">New</span>())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> Per route middleware, you can <span style="color:#66d9ef">add</span> <span style="color:#66d9ef">as</span> many <span style="color:#66d9ef">as</span> you desire.
</span></span><span style="display:flex;"><span>    app.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/benchmark&#34;</span>, <span style="color:#a6e22e">MyBenchLogger</span>(), benchEndpoint)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> Authorization <span style="color:#66d9ef">group</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> authorized :<span style="color:#f92672">=</span> app.<span style="color:#a6e22e">Party</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">AuthRequired</span>())
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> exactly the same <span style="color:#66d9ef">as</span>:
</span></span><span style="display:flex;"><span>    authorized :<span style="color:#f92672">=</span> app.<span style="color:#a6e22e">Party</span>(<span style="color:#e6db74">&#34;/&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> per <span style="color:#66d9ef">group</span> middleware<span style="color:#f92672">!</span> <span style="color:#66d9ef">in</span> this <span style="color:#66d9ef">case</span> we <span style="color:#66d9ef">use</span> the custom created
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> <span style="color:#a6e22e">AuthRequired</span>() middleware just <span style="color:#66d9ef">in</span> the <span style="color:#e6db74">&#34;authorized&#34;</span> <span style="color:#66d9ef">group</span>.
</span></span><span style="display:flex;"><span>    authorized.<span style="color:#66d9ef">Use</span>(<span style="color:#a6e22e">AuthRequired</span>())
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>        authorized.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/login&#34;</span>, loginEndpoint)
</span></span><span style="display:flex;"><span>        authorized.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/submit&#34;</span>, submitEndpoint)
</span></span><span style="display:flex;"><span>        authorized.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/read&#34;</span>, readEndpoint)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">//</span> nested <span style="color:#66d9ef">group</span>
</span></span><span style="display:flex;"><span>        testing :<span style="color:#f92672">=</span> authorized.<span style="color:#a6e22e">Party</span>(<span style="color:#e6db74">&#34;testing&#34;</span>)
</span></span><span style="display:flex;"><span>        testing.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/analytics&#34;</span>, analyticsEndpoint)
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> Listen <span style="color:#66d9ef">and</span> serve <span style="color:#66d9ef">on</span> <span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">0</span>:<span style="color:#ae81ff">8080</span>
</span></span><span style="display:flex;"><span>    app.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">}</span>
</span></span></code></pre></div><p>(adsbygoogle = window.adsbygoogle || []).push({});</p>
<h3 id="åº”ç”¨ç¨‹åºæ–‡ä»¶è®°å½•å™¨httpswwwiris-gocomdocsidapplication-file-logger"><a href="https://www.iris-go.com/docs/#/?id=application-file-logger">åº”ç”¨ç¨‹åºæ–‡ä»¶è®°å½•å™¨</a><a hidden class="anchor" aria-hidden="true" href="#åº”ç”¨ç¨‹åºæ–‡ä»¶è®°å½•å™¨httpswwwiris-gocomdocsidapplication-file-logger">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.Default()
</span></span><span style="display:flex;"><span>    // Logging to a file.
</span></span><span style="display:flex;"><span>    // Colors are automatically disabled when writing to a file.
</span></span><span style="display:flex;"><span>    f, _ := os.Create(&#34;iris.log&#34;)
</span></span><span style="display:flex;"><span>    app.Logger().SetOutput(f)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // Use the following code if you need to write the logs
</span></span><span style="display:flex;"><span>    // to file and console at the same time.
</span></span><span style="display:flex;"><span>    // app.Logger().AddOutput(os.Stdout)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Get(&#34;/ping&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        ctx.WriteString(&#34;pong&#34;)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>   app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æ§åˆ¶æ—¥å¿—è¾“å‡ºç€è‰²httpswwwiris-gocomdocsidcontrolling-log-output-coloring"><a href="https://www.iris-go.com/docs/#/?id=controlling-log-output-coloring">æ§åˆ¶æ—¥å¿—è¾“å‡ºç€è‰²</a><a hidden class="anchor" aria-hidden="true" href="#æ§åˆ¶æ—¥å¿—è¾“å‡ºç€è‰²httpswwwiris-gocomdocsidcontrolling-log-output-coloring">#</a></h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ§åˆ¶å°ä¸Šçš„æ—¥å¿—è¾“å‡ºåº”æ ¹æ®æ£€æµ‹åˆ°çš„ TTY è¿›è¡Œç€è‰²ã€‚</p>
<p>è‡ªå®šä¹‰å…³å¡æ ‡é¢˜ï¼Œæ–‡æœ¬ï¼Œé¢œè‰²å’Œæ ·å¼ã€‚</p>
<p>å¯¼å…¥å’Œ ï¼š<code>golog``pio</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>import (
</span></span><span style="display:flex;"><span>    &#34;github.com/kataras/golog&#34;
</span></span><span style="display:flex;"><span>    &#34;github.com/kataras/pio&#34;
</span></span><span style="display:flex;"><span>    // [...]
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><p>è·å–è¦è‡ªå®šä¹‰çš„çº§åˆ«ï¼Œä¾‹å¦‚ï¼š<code>DebugLevel</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>level := golog.Levels[golog.DebugLevel]
</span></span></code></pre></div><p>æ‚¨å¯ä»¥å®Œå…¨æ§åˆ¶ä»–çš„æ–‡å­—ã€æ ‡é¢˜å’Œé£æ ¼ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#f92672">//</span> The Name of the Level
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> that <span style="color:#a6e22e">named</span> (lowercased) will be used
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">to</span> <span style="color:#66d9ef">convert</span> a string level <span style="color:#66d9ef">on</span> <span style="color:#f92672">`</span>SetLevel<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">to</span> the correct Level type.
</span></span><span style="display:flex;"><span>Name string
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> AlternativeNames are the names that can be referred <span style="color:#66d9ef">to</span> this <span style="color:#66d9ef">specific</span> log level.
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> i.e Name <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;warn&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> AlternativeNames <span style="color:#f92672">=</span> []string<span style="color:#960050;background-color:#1e0010">{</span><span style="color:#e6db74">&#34;warning&#34;</span><span style="color:#960050;background-color:#1e0010">}</span>, it<span style="color:#e6db74">&#39;s an optional field,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">// therefore we keep Name as a simple string and created this new field.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">AlternativeNames []string
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">// Tha Title is the prefix of the log level.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">// See `ColorCode` and `Style` too.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">// Both `ColorCode` and `Style` should be respected across writers.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Title string
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">// ColorCode a color for the `Title`.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">ColorCode int
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">// Style one or more rich options for the `Title`.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">Style []pio.RichOption
</span></span></span></code></pre></div><p>ç¤ºä¾‹ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>level := golog.Levels[golog.DebugLevel]
</span></span><span style="display:flex;"><span>level.Name = &#34;debug&#34; // default
</span></span><span style="display:flex;"><span>level.Title = &#34;[DBUG]&#34; // default
</span></span><span style="display:flex;"><span>level.ColorCode = pio.Yellow // default
</span></span></code></pre></div><p><strong>è¦æ›´æ”¹è¾“å‡ºæ ¼å¼ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>app.Logger().SetFormat(&#34;json&#34;, &#34;    &#34;)
</span></span></code></pre></div><p><strong>æ³¨å†Œè‡ªå®šä¹‰æ ¼å¼åŒ–ç¨‹åºï¼š</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>app.Logger().RegisterFormatter(new(myFormatter))
</span></span></code></pre></div><p>å˜Ÿ<a href="https://github.com/kataras/golog/blob/master/formatter.go">å˜Ÿã€‚æ ¼å¼åŒ–ç¨‹åºç•Œé¢</a>å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>// Formatter is responsible to print a log to the logger&#39;s writer.
</span></span><span style="display:flex;"><span>type Formatter interface {
</span></span><span style="display:flex;"><span>    // The name of the formatter.
</span></span><span style="display:flex;"><span>    String() string
</span></span><span style="display:flex;"><span>    // Set any options and return a clone,
</span></span><span style="display:flex;"><span>    // generic. See `Logger.SetFormat`.
</span></span><span style="display:flex;"><span>    Options(opts ...interface{}) Formatter
</span></span><span style="display:flex;"><span>    // Writes the &#34;log&#34; to &#34;dest&#34; logger.
</span></span><span style="display:flex;"><span>    Format(dest io.Writer, log *Log) bool
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>è¦æ›´æ”¹æ¯ä¸ªçº§åˆ«çš„è¾“å‡ºå’Œæ ¼å¼ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>app.Logger().SetLevelOutput(&#34;error&#34;, os.Stderr)
</span></span><span style="display:flex;"><span>app.Logger().SetLevelFormat(&#34;json&#34;)
</span></span></code></pre></div><h3 id="è¯·æ±‚æ—¥å¿—è®°å½•httpswwwiris-gocomdocsidrequest-logging"><a href="https://www.iris-go.com/docs/#/?id=request-logging">è¯·æ±‚æ—¥å¿—è®°å½•</a><a hidden class="anchor" aria-hidden="true" href="#è¯·æ±‚æ—¥å¿—è®°å½•httpswwwiris-gocomdocsidrequest-logging">#</a></h3>
<p>æˆ‘ä»¬åœ¨ä¸Šé¢çœ‹åˆ°çš„åº”ç”¨ç¨‹åºè®°å½•å™¨ç”¨äºè®°å½•ä¸åº”ç”¨ç¨‹åºç›¸å…³çš„ä¿¡æ¯å’Œé”™è¯¯ã€‚å¦ä¸€æ–¹é¢ï¼Œæˆ‘ä»¬åœ¨ä¸‹é¢çœ‹åˆ°çš„è®¿é—®è®°å½•å™¨ç”¨äºè®°å½•ä¼ å…¥çš„HTTPè¯·æ±‚å’Œå“åº”ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;os&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12/middleware/accesslog&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Read the example and its comments carefully.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">makeAccessLog</span>() <span style="color:#f92672">*</span><span style="color:#a6e22e">accesslog</span>.<span style="color:#a6e22e">AccessLog</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Initialize a new access log middleware.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">ac</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">accesslog</span>.<span style="color:#a6e22e">File</span>(<span style="color:#e6db74">&#34;./access.log&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Remove this line to disable logging to console:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">AddOutput</span>(<span style="color:#a6e22e">os</span>.<span style="color:#a6e22e">Stdout</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// The default configuration:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">Delim</span> = <span style="color:#e6db74">&#39;|&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">TimeFormat</span> = <span style="color:#e6db74">&#34;2006-01-02 15:04:05&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">Async</span> = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">IP</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">BytesReceivedBody</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">BytesSentBody</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">BytesReceived</span> = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">BytesSent</span> = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">BodyMinify</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">RequestBody</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">ResponseBody</span> = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">KeepMultiLineError</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">PanicLog</span> = <span style="color:#a6e22e">accesslog</span>.<span style="color:#a6e22e">LogHandler</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Default line format if formatter is missing:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// Time|Latency|Code|Method|Path|IP|Path Params Query Fields|Bytes Received|Bytes Sent|Request|Response|
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// Set Custom Formatter:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">SetFormatter</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">accesslog</span>.<span style="color:#a6e22e">JSON</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Indent</span>:    <span style="color:#e6db74">&#34;  &#34;</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">HumanTime</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ac.SetFormatter(&amp;accesslog.CSV{})
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// ac.SetFormatter(&amp;accesslog.Template{Text: &#34;{{.Code}}&#34;})
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">ac</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ac</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">makeAccessLog</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">defer</span> <span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">Close</span>() <span style="color:#75715e">// Close the underline file.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Register the middleware (UseRouter to catch http errors too).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">UseRouter</span>(<span style="color:#a6e22e">ac</span>.<span style="color:#a6e22e">Handler</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">indexHandler</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">indexHandler</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#e6db74">&#34;OK&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>é˜…è¯»æ›´å¤šç¤ºä¾‹ï¼š<a href="https://github.com/kataras/iris/tree/master/_examples/logging/request-logger">_examples/logging/request-logger</a>ã€‚</p>
<p>(adsbygoogle = window.adsbygoogle || []).push({});</p>
<h3 id="æ¨¡å‹ç»‘å®šå’ŒéªŒè¯httpswwwiris-gocomdocsidmodel-binding-and-validation"><a href="https://www.iris-go.com/docs/#/?id=model-binding-and-validation">æ¨¡å‹ç»‘å®šå’ŒéªŒè¯</a><a hidden class="anchor" aria-hidden="true" href="#æ¨¡å‹ç»‘å®šå’ŒéªŒè¯httpswwwiris-gocomdocsidmodel-binding-and-validation">#</a></h3>
<p>è‹¥è¦å°†è¯·æ±‚æ­£æ–‡ç»‘å®šåˆ°ç±»å‹ä¸­ï¼Œè¯·ä½¿ç”¨æ¨¡å‹ç»‘å®šã€‚æˆ‘ä»¬ç›®å‰æ”¯æŒç»‘å®šã€ã€ã€ã€å’Œæ ‡å‡†è¡¨å•å€¼ï¼ˆfoo=bar&amp;boo=bazï¼‰ã€‚<code>JSON``JSONProtobuf``Protobuf``MsgPack``XML``YAML</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ReadJSON(outPtr interface{}) error
</span></span><span style="display:flex;"><span>ReadJSONProtobuf(ptr proto.Message, opts ...ProtoUnmarshalOptions) error
</span></span><span style="display:flex;"><span>ReadProtobuf(ptr proto.Message) error
</span></span><span style="display:flex;"><span>ReadMsgPack(ptr interface{}) error
</span></span><span style="display:flex;"><span>ReadXML(outPtr interface{}) error
</span></span><span style="display:flex;"><span>ReadYAML(outPtr interface{}) error
</span></span><span style="display:flex;"><span>ReadForm(formObject interface{}) error
</span></span><span style="display:flex;"><span>ReadQuery(ptr interface{}) error
</span></span></code></pre></div><p>ä½¿ç”¨ æ—¶ï¼ŒIris ä¼šå°è¯•æ ¹æ®å†…å®¹ç±»å‹æ ‡å¤´æ¨æ–­ç»‘å®šç¨‹åºã€‚å¦‚æœæ‚¨ç¡®å®šè¦ç»‘å®šçš„å†…å®¹ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ç‰¹å®šæ–¹æ³•ï¼Œä¾‹å¦‚ æˆ–å’Œç­‰<code>ReadBody``ReadXXX``ReadJSON``ReadProtobuf</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ReadBody(ptr interface{}) error
</span></span></code></pre></div><p>æ˜æ™ºçš„æ˜¯ï¼ŒIrisæ²¡æœ‰å†…ç½®çš„æ•°æ®éªŒè¯åŠŸèƒ½ã€‚ä½†æ˜¯ï¼Œå®ƒç¡®å®å…è®¸æ‚¨é™„åŠ ä¸€ä¸ªéªŒè¯å™¨ï¼Œè¯¥éªŒè¯å™¨å°†è‡ªåŠ¨è°ƒç”¨è¯¸å¦‚ ï¼Œ &hellip;.åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ å¦‚ä½•ä½¿ç”¨ <a href="https://www.iris-go.com/docs/(https://github.com/go-playground/validator)">go-playground/validator/v10</a> è¿›è¡Œè¯·æ±‚æ­£æ–‡éªŒè¯ã€‚<code>ReadJSON``ReadXML</code></p>
<p>è¯·æ³¨æ„ï¼Œæ‚¨éœ€è¦åœ¨è¦ç»‘å®šçš„æ‰€æœ‰å­—æ®µä¸Šè®¾ç½®ç›¸åº”çš„ç»‘å®šæ ‡è®°ã€‚ä¾‹å¦‚ï¼Œä» JSON ç»‘å®šæ—¶ï¼Œè®¾ç½® .<code>json:&quot;fieldname&quot;</code></p>
<p>æ‚¨è¿˜å¯ä»¥æŒ‡å®šç‰¹å®šå­—æ®µä¸ºå¿…å¡«å­—æ®µã€‚å¦‚æœå­—æ®µåœ¨ç»‘å®šæ—¶ç”¨ç©ºå€¼ä¿®é¥°ï¼Œå¹¶ä¸”å€¼ä¸ºç©ºï¼Œåˆ™ä¼šè¿”å›é”™è¯¯ã€‚<code>binding:&quot;required&quot;</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/go-playground/validator/v10&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Validator</span> = <span style="color:#a6e22e">validator</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">userRouter</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Party</span>(<span style="color:#e6db74">&#34;/user&#34;</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">userRouter</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/validation-errors&#34;</span>, <span style="color:#a6e22e">resolveErrorsDocumentation</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">userRouter</span>.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">postUser</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// User contains user information.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">User</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">FirstName</span>      <span style="color:#66d9ef">string</span>     <span style="color:#e6db74">`json:&#34;fname&#34; validate:&#34;required&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">LastName</span>       <span style="color:#66d9ef">string</span>     <span style="color:#e6db74">`json:&#34;lname&#34; validate:&#34;required&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Age</span>            <span style="color:#66d9ef">uint8</span>      <span style="color:#e6db74">`json:&#34;age&#34; validate:&#34;gte=0,lte=130&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Email</span>          <span style="color:#66d9ef">string</span>     <span style="color:#e6db74">`json:&#34;email&#34; validate:&#34;required,email&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">FavouriteColor</span> <span style="color:#66d9ef">string</span>     <span style="color:#e6db74">`json:&#34;favColor&#34; validate:&#34;hexcolor|rgb|rgba&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Addresses</span>      []<span style="color:#f92672">*</span><span style="color:#a6e22e">Address</span> <span style="color:#e6db74">`json:&#34;addresses&#34; validate:&#34;required,dive,required&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// Address houses a users address information.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Address</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Street</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;street&#34; validate:&#34;required&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">City</span>   <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;city&#34; validate:&#34;required&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Planet</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;planet&#34; validate:&#34;required&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Phone</span>  <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;phone&#34; validate:&#34;required&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">validationError</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ActualTag</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;tag&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Namespace</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;namespace&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Kind</span>      <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;kind&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Type</span>      <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;type&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Value</span>     <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;value&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Param</span>     <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;param&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">wrapValidationErrors</span>(<span style="color:#a6e22e">errs</span> <span style="color:#a6e22e">validator</span>.<span style="color:#a6e22e">ValidationErrors</span>) []<span style="color:#a6e22e">validationError</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">validationErrors</span> <span style="color:#f92672">:=</span> make([]<span style="color:#a6e22e">validationError</span>, <span style="color:#ae81ff">0</span>, len(<span style="color:#a6e22e">errs</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">for</span> <span style="color:#a6e22e">_</span>, <span style="color:#a6e22e">validationErr</span> <span style="color:#f92672">:=</span> <span style="color:#66d9ef">range</span> <span style="color:#a6e22e">errs</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">validationErrors</span> = append(<span style="color:#a6e22e">validationErrors</span>, <span style="color:#a6e22e">validationError</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ActualTag</span>: <span style="color:#a6e22e">validationErr</span>.<span style="color:#a6e22e">ActualTag</span>(),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Namespace</span>: <span style="color:#a6e22e">validationErr</span>.<span style="color:#a6e22e">Namespace</span>(),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Kind</span>:      <span style="color:#a6e22e">validationErr</span>.<span style="color:#a6e22e">Kind</span>().<span style="color:#a6e22e">String</span>(),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Type</span>:      <span style="color:#a6e22e">validationErr</span>.<span style="color:#a6e22e">Type</span>().<span style="color:#a6e22e">String</span>(),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Value</span>:     <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;%v&#34;</span>, <span style="color:#a6e22e">validationErr</span>.<span style="color:#a6e22e">Value</span>()),
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Param</span>:     <span style="color:#a6e22e">validationErr</span>.<span style="color:#a6e22e">Param</span>(),
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">validationErrors</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">postUser</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">user</span> <span style="color:#a6e22e">User</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ReadJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">user</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Handle the error, below you will find the right way to do that...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">errs</span>, <span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">err</span>.(<span style="color:#a6e22e">validator</span>.<span style="color:#a6e22e">ValidationErrors</span>); <span style="color:#a6e22e">ok</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Wrap the errors with JSON format, the underline library returns the errors as interface.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">validationErrors</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">wrapValidationErrors</span>(<span style="color:#a6e22e">errs</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#75715e">// Fire an application/json+problem response and stop the handlers chain.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>            <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithProblem</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusBadRequest</span>, <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">NewProblem</span>().
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Title</span>(<span style="color:#e6db74">&#34;Validation error&#34;</span>).
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Detail</span>(<span style="color:#e6db74">&#34;One or more fields failed to be validated&#34;</span>).
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Type</span>(<span style="color:#e6db74">&#34;/user/validation-errors&#34;</span>).
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Key</span>(<span style="color:#e6db74">&#34;errors&#34;</span>, <span style="color:#a6e22e">validationErrors</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// It&#39;s probably an internal JSON error, let&#39;s dont give more info here.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithStatus</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusInternalServerError</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Map</span>{<span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;OK&#34;</span>})
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">resolveErrorsDocumentation</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#e6db74">&#34;A page that should document to web developers or users of the API on how to resolve the validation errors&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>æ ·å“è¯·æ±‚</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    &#34;fname&#34;: &#34;&#34;,
</span></span><span style="display:flex;"><span>    &#34;lname&#34;: &#34;&#34;,
</span></span><span style="display:flex;"><span>    &#34;age&#34;: 45,
</span></span><span style="display:flex;"><span>    &#34;email&#34;: &#34;mail@example.com&#34;,
</span></span><span style="display:flex;"><span>    &#34;favColor&#34;: &#34;#000&#34;,
</span></span><span style="display:flex;"><span>    &#34;addresses&#34;: [{
</span></span><span style="display:flex;"><span>        &#34;street&#34;: &#34;Eavesdown Docks&#34;,
</span></span><span style="display:flex;"><span>        &#34;planet&#34;: &#34;Persphone&#34;,
</span></span><span style="display:flex;"><span>        &#34;phone&#34;: &#34;none&#34;,
</span></span><span style="display:flex;"><span>        &#34;city&#34;: &#34;Unknown&#34;
</span></span><span style="display:flex;"><span>    }]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ç¤ºä¾‹å“åº”</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    &#34;title&#34;: &#34;Validation error&#34;,
</span></span><span style="display:flex;"><span>    &#34;detail&#34;: &#34;One or more fields failed to be validated&#34;,
</span></span><span style="display:flex;"><span>    &#34;type&#34;: &#34;http://localhost:8080/user/validation-errors&#34;,
</span></span><span style="display:flex;"><span>    &#34;status&#34;: 400,
</span></span><span style="display:flex;"><span>    &#34;fields&#34;: [
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        &#34;tag&#34;: &#34;required&#34;,
</span></span><span style="display:flex;"><span>        &#34;namespace&#34;: &#34;User.FirstName&#34;,
</span></span><span style="display:flex;"><span>        &#34;kind&#34;: &#34;string&#34;,
</span></span><span style="display:flex;"><span>        &#34;type&#34;: &#34;string&#34;,
</span></span><span style="display:flex;"><span>        &#34;value&#34;: &#34;&#34;,
</span></span><span style="display:flex;"><span>        &#34;param&#34;: &#34;&#34;
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        &#34;tag&#34;: &#34;required&#34;,
</span></span><span style="display:flex;"><span>        &#34;namespace&#34;: &#34;User.LastName&#34;,
</span></span><span style="display:flex;"><span>        &#34;kind&#34;: &#34;string&#34;,
</span></span><span style="display:flex;"><span>        &#34;type&#34;: &#34;string&#34;,
</span></span><span style="display:flex;"><span>        &#34;value&#34;: &#34;&#34;,
</span></span><span style="display:flex;"><span>        &#34;param&#34;: &#34;&#34;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æœ‰å…³æ¨¡å‹éªŒè¯çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®ï¼š<a href="https://github.com/go-playground/validator/blob/master/_examples">https://github.com/go-playground/validator/blob/master/_examples</a></p>
<h3 id="ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²httpswwwiris-gocomdocsidbind-query-string"><a href="https://www.iris-go.com/docs/#/?id=bind-query-string">ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²</a><a hidden class="anchor" aria-hidden="true" href="#ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²httpswwwiris-gocomdocsidbind-query-string">#</a></h3>
<p>è¯¥æ–¹æ³•ä»…ç»‘å®šæŸ¥è¯¢å‚æ•°ï¼Œè€Œä¸ç»‘å®šå¸–å­æ•°æ®ï¼Œè€Œæ˜¯ç”¨äºç»‘å®šå¸–å­æ•°æ®ã€‚<code>ReadQuery``ReadForm</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Person</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Name</span>    <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`url:&#34;name,required&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Address</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`url:&#34;address&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Default</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Any</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">index</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">index</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">person</span> <span style="color:#a6e22e">Person</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ReadQuery</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">person</span>); <span style="color:#a6e22e">err</span><span style="color:#f92672">!=</span><span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithError</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusBadRequest</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Application</span>().<span style="color:#a6e22e">Logger</span>().<span style="color:#a6e22e">Infof</span>(<span style="color:#e6db74">&#34;Person: %#+v&#34;</span>, <span style="color:#a6e22e">person</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#e6db74">&#34;Success&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="ç»‘å®šä»»ä½•httpswwwiris-gocomdocsidbind-any"><a href="https://www.iris-go.com/docs/#/?id=bind-any">ç»‘å®šä»»ä½•</a><a hidden class="anchor" aria-hidden="true" href="#ç»‘å®šä»»ä½•httpswwwiris-gocomdocsidbind-any">#</a></h3>
<p>æ ¹æ®å®¢æˆ·ç«¯å‘é€æ•°æ®çš„å†…å®¹ç±»å‹å°†è¯·æ±‚æ­£æ–‡ç»‘å®šåˆ°â€œptrâ€ï¼Œä¾‹å¦‚ JSONã€XMLã€YAMLã€MessagePackã€Protobufã€Form å’Œ URL Queryã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Person</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Name</span>       <span style="color:#66d9ef">string</span>    <span style="color:#e6db74">`form:&#34;name&#34; json:&#34;name&#34; url:&#34;name&#34; msgpack:&#34;name&#34;`</span> 
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Address</span>    <span style="color:#66d9ef">string</span>    <span style="color:#e6db74">`form:&#34;address&#34; json:&#34;address&#34; url:&#34;address&#34; msgpack:&#34;address&#34;`</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Birthday</span>   <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span> <span style="color:#e6db74">`form:&#34;birthday&#34; time_format:&#34;2006-01-02&#34; time_utc:&#34;1&#34; json:&#34;birthday&#34; url:&#34;birthday&#34; msgpack:&#34;birthday&#34;`</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">CreateTime</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span> <span style="color:#e6db74">`form:&#34;createTime&#34; time_format:&#34;unixNano&#34; json:&#34;create_time&#34; url:&#34;create_time&#34; msgpack:&#34;createTime&#34;`</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">UnixTime</span>   <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Time</span> <span style="color:#e6db74">`form:&#34;unixTime&#34; time_format:&#34;unix&#34; json:&#34;unix_time&#34; url:&#34;unix_time&#34; msgpack:&#34;unixTime&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Default</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Any</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">index</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">index</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">person</span> <span style="color:#a6e22e">Person</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ReadBody</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">person</span>); <span style="color:#a6e22e">err</span><span style="color:#f92672">!=</span><span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithError</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusBadRequest</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Application</span>().<span style="color:#a6e22e">Logger</span>().<span style="color:#a6e22e">Infof</span>(<span style="color:#e6db74">&#34;Person: %#+v&#34;</span>, <span style="color:#a6e22e">person</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#e6db74">&#34;Success&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>æµ‹è¯•å®ƒï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ curl -X GET &#34;localhost:8085/testing?name=kataras&amp;address=xyz&amp;birthday=1992-03-15&amp;createTime=1562400033000000123&amp;unixTime=1562400033&#34;
</span></span></code></pre></div><h3 id="ç»‘å®šç½‘å€è·¯å¾„å‚æ•°httpswwwiris-gocomdocsidbind-url-path-parameters"><a href="https://www.iris-go.com/docs/#/?id=bind-url-path-parameters">ç»‘å®šç½‘å€è·¯å¾„å‚æ•°</a><a hidden class="anchor" aria-hidden="true" href="#ç»‘å®šç½‘å€è·¯å¾„å‚æ•°httpswwwiris-gocomdocsidbind-url-path-parameters">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">myParams</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Name</span> <span style="color:#66d9ef">string</span>   <span style="color:#e6db74">`param:&#34;name&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Age</span>  <span style="color:#66d9ef">int</span>      <span style="color:#e6db74">`param:&#34;age&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Tail</span> []<span style="color:#66d9ef">string</span> <span style="color:#e6db74">`param:&#34;tail&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span><span style="color:#75715e">// All parameters are required, as we already know,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">// the router will fire 404 if name or int or tail are missing.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Default</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/{name}/{age:int}/{tail:path}&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">p</span> <span style="color:#a6e22e">myParams</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ReadParams</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">p</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithError</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusInternalServerError</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Writef</span>(<span style="color:#e6db74">&#34;myParams: %#v&#34;</span>, <span style="color:#a6e22e">p</span>)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8088&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>è¯·æ±‚</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ curl -v http://localhost:8080/kataras/27/iris/web/framework
</span></span></code></pre></div><p>(adsbygoogle = window.adsbygoogle || []).push({});</p>
<h3 id="ç»‘å®šæ ‡å¤´httpswwwiris-gocomdocsidbind-header"><a href="https://www.iris-go.com/docs/#/?id=bind-header">ç»‘å®šæ ‡å¤´</a><a hidden class="anchor" aria-hidden="true" href="#ç»‘å®šæ ‡å¤´httpswwwiris-gocomdocsidbind-header">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">myHeaders</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">RequestID</span>      <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`header:&#34;X-Request-Id,required&#34;`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Authentication</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`header:&#34;Authentication,required&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Default</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">hs</span> <span style="color:#a6e22e">myHeaders</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ReadHeaders</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">hs</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithError</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusInternalServerError</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">hs</span>)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>è¯·æ±‚</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>curl -H &#34;x-request-id:373713f0-6b4b-42ea-ab9f-e2e04bc38e73&#34; -H &#34;authentication: Bearer my-token&#34; \
</span></span><span style="display:flex;"><span>http://localhost:8080
</span></span></code></pre></div><p><strong>å“åº”</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  &#34;RequestID&#34;: &#34;373713f0-6b4b-42ea-ab9f-e2e04bc38e73&#34;,
</span></span><span style="display:flex;"><span>  &#34;Authentication&#34;: &#34;Bearer my-token&#34;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="ç»‘å®š-html-å¤é€‰æ¡†httpswwwiris-gocomdocsidbind-html-checkboxes"><a href="https://www.iris-go.com/docs/#/?id=bind-html-checkboxes">â€œç»‘å®š HTML â€å¤é€‰æ¡†</a><a hidden class="anchor" aria-hidden="true" href="#ç»‘å®š-html-å¤é€‰æ¡†httpswwwiris-gocomdocsidbind-html-checkboxes">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">RegisterView</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">HTML</span>(<span style="color:#e6db74">&#34;./templates&#34;</span>, <span style="color:#e6db74">&#34;.html&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">showForm</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">handleForm</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">showForm</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">View</span>(<span style="color:#e6db74">&#34;form.html&#34;</span>); <span style="color:#a6e22e">err</span><span style="color:#f92672">!=</span><span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">HTML</span>(<span style="color:#e6db74">&#34;&lt;h3&gt;%s&lt;/h3&gt;&#34;</span>, <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>())
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">formExample</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Colors</span> []<span style="color:#66d9ef">string</span> <span style="color:#e6db74">`form:&#34;colors[]&#34;`</span> <span style="color:#75715e">// or just &#34;colors&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">handleForm</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">form</span> <span style="color:#a6e22e">formExample</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ReadForm</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">form</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithError</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusBadRequest</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Map</span>{<span style="color:#e6db74">&#34;Colors&#34;</span>: <span style="color:#a6e22e">form</span>.<span style="color:#a6e22e">Colors</span>})
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>templates/form.html</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;form action=&#34;/&#34; method=&#34;POST&#34;&gt;
</span></span><span style="display:flex;"><span>    &lt;p&gt;Check one or more colors&lt;/p&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    &lt;label for=&#34;red&#34;&gt;Red&lt;/label&gt;
</span></span><span style="display:flex;"><span>    &lt;!-- name can be &#34;colors&#34; too --&gt;
</span></span><span style="display:flex;"><span>    &lt;input type=&#34;checkbox&#34; name=&#34;colors[]&#34; value=&#34;red&#34; id=&#34;red&#34;&gt;
</span></span><span style="display:flex;"><span>    &lt;label for=&#34;green&#34;&gt;Green&lt;/label&gt;
</span></span><span style="display:flex;"><span>    &lt;input type=&#34;checkbox&#34; name=&#34;colors[]&#34; value=&#34;green&#34; id=&#34;green&#34;&gt;
</span></span><span style="display:flex;"><span>    &lt;label for=&#34;blue&#34;&gt;Blue&lt;/label&gt;
</span></span><span style="display:flex;"><span>    &lt;input type=&#34;checkbox&#34; name=&#34;colors[]&#34; value=&#34;blue&#34; id=&#34;blue&#34;&gt;
</span></span><span style="display:flex;"><span>    &lt;input type=&#34;submit&#34;&gt;
</span></span><span style="display:flex;"><span>&lt;/form&gt;
</span></span></code></pre></div><p><strong>å“åº”</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  &#34;Colors&#34;: [
</span></span><span style="display:flex;"><span>    &#34;red&#34;,
</span></span><span style="display:flex;"><span>    &#34;green&#34;,
</span></span><span style="display:flex;"><span>    &#34;blue&#34;
</span></span><span style="display:flex;"><span>  ]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="jsonjsonpxmlmarkdownyaml-å’Œ-msgpack-æ¸²æŸ“httpswwwiris-gocomdocsidjson-jsonp-xml-markdown-yaml-and-msgpack-rendering"><a href="https://www.iris-go.com/docs/#/?id=json-jsonp-xml-markdown-yaml-and-msgpack-rendering">JSONã€JSONPã€XMLã€Markdownã€YAML å’Œ MsgPack æ¸²æŸ“</a><a hidden class="anchor" aria-hidden="true" href="#jsonjsonpxmlmarkdownyaml-å’Œ-msgpack-æ¸²æŸ“httpswwwiris-gocomdocsidjson-jsonp-xml-markdown-yaml-and-msgpack-rendering">#</a></h3>
<p>è¯¦ç»†ç¤ºä¾‹å¯<a href="https://github.com/kataras/iris/tree/master/_examples/response-writer/write-rest">åœ¨æ­¤å¤„</a>æ‰¾åˆ°ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.New()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // iris.Map is an alias of map[string]interface{}
</span></span><span style="display:flex;"><span>    app.Get(&#34;/json&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        ctx.JSON(iris.Map{&#34;message&#34;: &#34;hello&#34;, &#34;status&#34;: iris.StatusOK})
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // Use Secure field to prevent json hijacking.
</span></span><span style="display:flex;"><span>    // It prepends `&#34;while(1),&#34;` to the body when the data is array.
</span></span><span style="display:flex;"><span>    app.Get(&#34;/json_secure&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        response := []string{&#34;val1&#34;, &#34;val2&#34;, &#34;val3&#34;}
</span></span><span style="display:flex;"><span>        options := iris.JSON{Indent: &#34;&#34;, Secure: true}
</span></span><span style="display:flex;"><span>        ctx.JSON(response, options)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        // Will output: while(1);[&#34;val1&#34;,&#34;val2&#34;,&#34;val3&#34;]
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // Use ASCII field to generate ASCII-only JSON
</span></span><span style="display:flex;"><span>    // with escaped non-ASCII characters.
</span></span><span style="display:flex;"><span>    app.Get(&#34;/json_ascii&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        response := iris.Map{&#34;lang&#34;: &#34;GO-è™¹è†œ&#34;, &#34;tag&#34;: &#34;&lt;br&gt;&#34;}
</span></span><span style="display:flex;"><span>        options := iris.JSON{Indent: &#34;    &#34;, ASCII: true}
</span></span><span style="display:flex;"><span>        ctx.JSON(response, options)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        /* Will output:
</span></span><span style="display:flex;"><span>           {
</span></span><span style="display:flex;"><span>               &#34;lang&#34;: &#34;GO-\u8679\u819c&#34;,
</span></span><span style="display:flex;"><span>               &#34;tag&#34;: &#34;\u003cbr\u003e&#34;
</span></span><span style="display:flex;"><span>           }
</span></span><span style="display:flex;"><span>        */
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // Normally, JSON replaces special HTML characters with their unicode entities.
</span></span><span style="display:flex;"><span>    // If you want to encode such characters literally,
</span></span><span style="display:flex;"><span>    // you SHOULD set the UnescapeHTML field to true.
</span></span><span style="display:flex;"><span>    app.Get(&#34;/json_raw&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        options := iris.JSON{UnescapeHTML: true}
</span></span><span style="display:flex;"><span>        ctx.JSON(iris.Map{
</span></span><span style="display:flex;"><span>            &#34;html&#34;: &#34;&lt;b&gt;Hello, world!&lt;/b&gt;&#34;,
</span></span><span style="display:flex;"><span>        }, options)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        // Will output: {&#34;html&#34;:&#34;&lt;b&gt;Hello, world!&lt;/b&gt;&#34;}
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Get(&#34;/json_struct&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        // You also can use a struct.
</span></span><span style="display:flex;"><span>        var msg struct {
</span></span><span style="display:flex;"><span>            Name    string `json:&#34;user&#34;`
</span></span><span style="display:flex;"><span>            Message string
</span></span><span style="display:flex;"><span>            Number  int
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        msg.Name = &#34;Mariah&#34;
</span></span><span style="display:flex;"><span>        msg.Message = &#34;hello&#34;
</span></span><span style="display:flex;"><span>        msg.Number = 42
</span></span><span style="display:flex;"><span>        // Note that msg.Name becomes &#34;user&#34; in the JSON.
</span></span><span style="display:flex;"><span>        // Will output: {&#34;user&#34;: &#34;Mariah&#34;, &#34;Message&#34;: &#34;hello&#34;, &#34;Number&#34;: 42}
</span></span><span style="display:flex;"><span>        ctx.JSON(msg)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Get(&#34;/jsonp&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        ctx.JSONP(iris.Map{&#34;hello&#34;: &#34;jsonp&#34;}, iris.JSONP{Callback: &#34;callbackName&#34;})
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Get(&#34;/xml&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        ctx.XML(iris.Map{&#34;message&#34;: &#34;hello&#34;, &#34;status&#34;: iris.StatusOK})
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Get(&#34;/markdown&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        ctx.Markdown([]byte(&#34;# Hello Dynamic Markdown -- iris&#34;))
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Get(&#34;/yaml&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        ctx.YAML(iris.Map{&#34;message&#34;: &#34;hello&#34;, &#34;status&#34;: iris.StatusOK})
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Get(&#34;/msgpack&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        u := User{
</span></span><span style="display:flex;"><span>            Firstname: &#34;John&#34;,
</span></span><span style="display:flex;"><span>            Lastname:  &#34;Doe&#34;,
</span></span><span style="display:flex;"><span>            City:      &#34;Neither FBI knows!!!&#34;,
</span></span><span style="display:flex;"><span>            Age:       25,
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ctx.MsgPack(u)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // Render using jsoniter instead of the encoding/json:
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;, iris.WithOptimizations)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="æ™®ç½—æ‰˜å¸ƒå¤«httpswwwiris-gocomdocsidprotobuf"><a href="https://www.iris-go.com/docs/#/?id=protobuf">æ™®ç½—æ‰˜å¸ƒå¤«</a><a hidden class="anchor" aria-hidden="true" href="#æ™®ç½—æ‰˜å¸ƒå¤«httpswwwiris-gocomdocsidprotobuf">#</a></h4>
<p>Iris æ”¯æŒåŸç”Ÿ protobuf with å’Œ protobuf to JSON ç¼–ç å’Œè§£ç ã€‚<code>Protobuf</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;app/protos&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">send</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/json&#34;</span>, <span style="color:#a6e22e">sendAsJSON</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/read&#34;</span>, <span style="color:#a6e22e">read</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/read_json&#34;</span>, <span style="color:#a6e22e">readFromJSON</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">send</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">response</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">protos</span>.<span style="color:#a6e22e">HelloReply</span>{<span style="color:#a6e22e">Message</span>: <span style="color:#e6db74">&#34;Hello, World!&#34;</span>}
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Protobuf</span>(<span style="color:#a6e22e">response</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">sendAsJSON</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">response</span> <span style="color:#f92672">:=</span> <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">protos</span>.<span style="color:#a6e22e">HelloReply</span>{<span style="color:#a6e22e">Message</span>: <span style="color:#e6db74">&#34;Hello, World!&#34;</span>}
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">options</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">JSON</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Proto</span>: <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">ProtoMarshalOptions</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">AllowPartial</span>: <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Multiline</span>:    <span style="color:#66d9ef">true</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">Indent</span>:       <span style="color:#e6db74">&#34;    &#34;</span>,
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">response</span>, <span style="color:#a6e22e">options</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">read</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">request</span> <span style="color:#a6e22e">protos</span>.<span style="color:#a6e22e">HelloRequest</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ReadProtobuf</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">request</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithError</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusBadRequest</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Writef</span>(<span style="color:#e6db74">&#34;HelloRequest.Name = %s&#34;</span>, <span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">Name</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">readFromJSON</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">request</span> <span style="color:#a6e22e">protos</span>.<span style="color:#a6e22e">HelloRequest</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ReadJSONProtobuf</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">request</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithError</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusBadRequest</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Writef</span>(<span style="color:#e6db74">&#34;HelloRequest.Name = %s&#34;</span>, <span style="color:#a6e22e">request</span>.<span style="color:#a6e22e">Name</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æä¾›é™æ€æ–‡ä»¶httpswwwiris-gocomdocsidserving-static-files"><a href="https://www.iris-go.com/docs/#/?id=serving-static-files">æä¾›é™æ€æ–‡ä»¶</a><a hidden class="anchor" aria-hidden="true" href="#æä¾›é™æ€æ–‡ä»¶httpswwwiris-gocomdocsidserving-static-files">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.New()
</span></span><span style="display:flex;"><span>    app.Favicon(&#34;./resources/favicon.ico&#34;)
</span></span><span style="display:flex;"><span>    app.HandleDir(&#34;/assets&#34;, iris.Dir(&#34;./assets&#34;))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¯¥æ–¹æ³•æ¥å—ç¬¬ä¸‰ä¸ªå¯é€‰å‚æ•°ï¼š<code>HandleDir``DirOptions</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span>type DirOptions struct <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> Defaults <span style="color:#66d9ef">to</span> <span style="color:#e6db74">&#34;/index.html&#34;</span>, <span style="color:#66d9ef">if</span> request path <span style="color:#66d9ef">is</span> ending <span style="color:#66d9ef">with</span> <span style="color:#f92672">**</span><span style="color:#75715e">/*/$IndexName
</span></span></span><span style="display:flex;"><span><span style="color:#75715e">    // then it redirects to **/</span><span style="color:#f92672">*</span>(<span style="color:#f92672">/</span>) which another handler <span style="color:#66d9ef">is</span> handling it,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> that another handler, called <span style="color:#66d9ef">index</span> handler, <span style="color:#66d9ef">is</span> auto<span style="color:#f92672">-</span>registered <span style="color:#66d9ef">by</span> the framework
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> <span style="color:#66d9ef">if</span> end developer does <span style="color:#66d9ef">not</span> managed <span style="color:#66d9ef">to</span> handle it <span style="color:#66d9ef">by</span> hand.
</span></span><span style="display:flex;"><span>    IndexName string
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> PushTargets <span style="color:#a6e22e">filenames</span> (map<span style="color:#e6db74">&#39;s value) to
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // be served without additional client&#39;</span>s <span style="color:#a6e22e">requests</span> (HTTP<span style="color:#f92672">/</span><span style="color:#ae81ff">2</span> Push)
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> <span style="color:#66d9ef">when</span> a <span style="color:#66d9ef">specific</span> request <span style="color:#a6e22e">path</span> (map<span style="color:#e6db74">&#39;s key WITHOUT prefix)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // is requested and it&#39;</span>s <span style="color:#66d9ef">not</span> a <span style="color:#a6e22e">directory</span> (it<span style="color:#e6db74">&#39;s an `IndexFile`).
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    //
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // Example:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    //     &#34;/&#34;: {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    //         &#34;favicon.ico&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    //         &#34;js/main.js&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    //         &#34;css/main.css&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    //     }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    PushTargets map[string][]string
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // PushTargetsRegexp like `PushTargets` but accepts regexp which
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // is compared against all files under a directory (recursively).
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // The `IndexName` should be set.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    //
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // Example:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // &#34;/&#34;: regexp.MustCompile(&#34;((.*).js|(.*).css|(.*).ico)$&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // See `iris.MatchCommonAssets` too.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    PushTargetsRegexp map[string]*regexp.Regexp
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // Cache to enable in-memory cache and pre-compress files.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Cache DirCacheOptions
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // When files should served under compression.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Compress bool
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // List the files inside the current requested directory if `IndexName` not found.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    ShowList bool
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // If `ShowList` is true then this function will be used instead
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // of the default one to show the list of files of a current requested directory(dir).
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // See `DirListRich` package-level function too.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    DirList DirListFunc
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // Files downloaded and saved locally.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Attachments Attachments
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // Optional validator that loops through each requested resource.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    AssetValidator func(ctx *context.Context, name string) bool
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span></code></pre></div><p>è¯¦ç»†äº†è§£<a href="https://github.com/kataras/iris/tree/master/_examples/file-server">æ–‡ä»¶æœåŠ¡å™¨</a>ã€‚</p>
<p>(adsbygoogle = window.adsbygoogle || []).push({});</p>
<h3 id="ä»ä¸Šä¸‹æ–‡ä¸­æä¾›æ•°æ®httpswwwiris-gocomdocsidserving-data-from-context"><a href="https://www.iris-go.com/docs/#/?id=serving-data-from-context">ä»ä¸Šä¸‹æ–‡ä¸­æä¾›æ•°æ®</a><a hidden class="anchor" aria-hidden="true" href="#ä»ä¸Šä¸‹æ–‡ä¸­æä¾›æ•°æ®httpswwwiris-gocomdocsidserving-data-from-context">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>SendFile(filename string, destinationName string) error
</span></span><span style="display:flex;"><span>SendFileWithRate(src, destName string, limit float64, burst int) error
</span></span></code></pre></div><p><strong>ç”¨æ³•</strong></p>
<p>å¼ºåˆ¶å°†æ–‡ä»¶å‘é€åˆ°å®¢æˆ·ç«¯ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func handler(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    src := &#34;./files/first.zip&#34;
</span></span><span style="display:flex;"><span>    ctx.SendFile(src, &#34;client.zip&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å°†ä¸‹è½½é€Ÿåº¦é™åˆ¶ä¸º ~50Kb/sï¼Œçªå‘ 100KBï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func handler(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    src := &#34;./files/big.zip&#34;
</span></span><span style="display:flex;"><span>    // optionally, keep it empty to resolve the filename based on the &#34;src&#34;.
</span></span><span style="display:flex;"><span>    dest := &#34;&#34; 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    limit := 50.0 * iris.KB
</span></span><span style="display:flex;"><span>    burst := 100 * iris.KB
</span></span><span style="display:flex;"><span>    ctx.SendFileWithRate(src, dest, limit, burst)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ServeContent(content io.ReadSeeker, filename string, modtime time.Time)
</span></span><span style="display:flex;"><span>ServeContentWithRate(content io.ReadSeeker, filename string, modtime time.Time, limit float64, burst int)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ServeFile(filename string) error
</span></span><span style="display:flex;"><span>ServeFileWithRate(filename string, limit float64, burst int) error
</span></span></code></pre></div><p><strong>ç”¨æ³•</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func handler(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    ctx.ServeFile(&#34;./public/main.js&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="æ¨¡æ¿æ¸²æŸ“httpswwwiris-gocomdocsidtemplate-rendering"><a href="https://www.iris-go.com/docs/#/?id=template-rendering">æ¨¡æ¿æ¸²æŸ“</a><a hidden class="anchor" aria-hidden="true" href="#æ¨¡æ¿æ¸²æŸ“httpswwwiris-gocomdocsidtemplate-rendering">#</a></h3>
<p>Iriså¼€ç®±å³ç”¨æ”¯æŒ8ä¸ªæ¨¡æ¿å¼•æ“ï¼Œå¼€å‘è€…ä»ç„¶å¯ä»¥ä½¿ç”¨ä»»ä½•å¤–éƒ¨golangæ¨¡æ¿å¼•æ“ï¼Œ å°±åƒä¸€ä¸ª.<code>Context.ResponseWriter()``io.Writer</code></p>
<p>æ‰€æœ‰æ¨¡æ¿å¼•æ“å…±äº«ä¸€ä¸ªé€šç”¨ APIï¼Œå³ ä½¿ç”¨åµŒå…¥èµ„æºã€å¸ƒå±€å’Œç‰¹å®šäºå‚ä¸æ–¹çš„å¸ƒå±€ã€æ¨¡æ¿åŠŸèƒ½ã€éƒ¨åˆ†æ¸²æŸ“ç­‰è¿›è¡Œè§£æã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:left">#</th>
<th style="text-align:left">åå­—</th>
<th>è§£æ å™¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">.HTML</td>
<td><a href="https://pkg.go.dev/html/template">ç½‘é¡µ/æ¨¡æ¿</a></td>
</tr>
<tr>
<td style="text-align:left">2</td>
<td style="text-align:left">å—</td>
<td><a href="https://github.com/kataras/blocks">å¡å¡”æ‹‰æ–¯/æ–¹å—</a></td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">å§œæˆˆ</td>
<td><a href="https://github.com/flosch/pongo2">å¼—æ´›æ–½/è“¬æˆˆ2</a></td>
</tr>
<tr>
<td style="text-align:left">4</td>
<td style="text-align:left">å¸•æ ¼</td>
<td><a href="https://github.com/Joker/jade">å°ä¸‘/ç¿¡ç¿ </a></td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">è½¦æŠŠ</td>
<td><a href="https://github.com/aymerick/raymond">è‰¾é»˜é‡Œå…‹/é›·è’™å¾·</a></td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:left">ç¥ç€</td>
<td><a href="https://github.com/eknkc/amber">eknkc/ç¥ç€è‰²</a></td>
</tr>
<tr>
<td style="text-align:left">7</td>
<td style="text-align:left">å™´æ°£æ©Ÿ</td>
<td><a href="https://github.com/CloudyKit/jet">äº‘å¥—ä»¶/å–·æ°”æœº</a></td>
</tr>
<tr>
<td style="text-align:left">8</td>
<td style="text-align:left">é«˜æ‰‹</td>
<td><a href="https://github.com/yosssi/ace">çº¦è¥¿/è‰¾æ–¯</a></td>
</tr>
</tbody>
</table>
<p><a href="https://github.com/kataras/iris/tree/master/_examples/view">ç¤ºä¾‹åˆ—è¡¨</a>ã€‚</p>
<p><a href="https://dev.to/kataras/what-s-the-fastest-template-parser-in-go-4bal">åŸºå‡†åˆ—è¡¨</a>ã€‚</p>
<p>è§†å›¾å¼•æ“å¯ä»¥æŒ‰ç¼”çº¦æ–¹æ³¨å†Œã€‚è¦<strong>æ³¨å†Œ</strong>è§†å›¾å¼•æ“ï¼Œè¯·ä½¿ç”¨å¦‚ä¸‹æ‰€ç¤ºçš„æ–¹æ³•ã€‚<code>Application/Party.RegisterView(ViewEngine)</code></p>
<p>ä»æ‰©å±•åä¸ºâ€œ.htmlâ€çš„â€œ./viewsâ€æ–‡ä»¶å¤¹ä¸­åŠ è½½æ‰€æœ‰æ¨¡æ¿ï¼Œå¹¶ä½¿ç”¨æ ‡å‡†åŒ…è§£æå®ƒä»¬ã€‚<code>html/template</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>// [app := iris.New...]
</span></span><span style="display:flex;"><span>tmpl := iris.HTML(&#34;./views&#34;, &#34;.html&#34;)
</span></span><span style="display:flex;"><span>app.RegisterView(tmpl)
</span></span></code></pre></div><p>è‹¥è¦<strong>å‘ˆç°æˆ–æ‰§è¡Œ</strong>è§†å›¾ï¼Œè¯·ä½¿ç”¨ä¸»è·¯ç”±å¤„ç†ç¨‹åºä¸­çš„æ–¹æ³•ã€‚<code>Context.View</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>if err := ctx.View(&#34;hi.html&#34;); err!=nil {
</span></span><span style="display:flex;"><span>    ctx.HTML(&#34;&lt;h3&gt;%s&lt;/h3&gt;&#34;, err.Error())
</span></span><span style="display:flex;"><span>    return
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¦é€šè¿‡ä¸­é—´ä»¶æˆ–ä¸»å¤„ç†ç¨‹åºåœ¨è§†å›¾ä¸­å°† Go å€¼ä¸é”®å€¼æ¨¡å¼<strong>ç»‘å®š</strong>ï¼Œè¯·ä½¿ç”¨ go å€¼ä¹‹å‰çš„æ–¹æ³•ã€‚<code>Context.ViewData``Context.View</code></p>
<p>ç»‘å®šï¼šä¸ .<code>{{.message}}``&quot;Hello world!&quot;</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ctx.ViewData(&#34;message&#34;, &#34;Hello world!&#34;)
</span></span></code></pre></div><p>æ ¹ç»‘å®šï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>if err := ctx.View(&#34;user-page.html&#34;, User{}); err!=nil {
</span></span><span style="display:flex;"><span>    ctx.HTML(&#34;&lt;h3&gt;%s&lt;/h3&gt;&#34;, err.Error())
</span></span><span style="display:flex;"><span>    return
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// root binding as {{.Name}}
</span></span></code></pre></div><p>è¦**æ·»åŠ æ¨¡æ¿å‡½æ•°ï¼Œ**è¯·ä½¿ç”¨é¦–é€‰è§†å›¾å¼•æ“çš„æ–¹æ³•ã€‚<code>AddFunc</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>//       func name, input arguments, render value
</span></span><span style="display:flex;"><span>tmpl.AddFunc(&#34;greet&#34;, func(s string) string {
</span></span><span style="display:flex;"><span>    return &#34;Greetings &#34; + s + &#34;!&#34;
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><p>è¦<strong>åœ¨æ¯ä¸ªè¯·æ±‚ä¸Šé‡æ–°åŠ è½½</strong>ï¼Œè¯·è°ƒç”¨è§†å›¾å¼•æ“çš„æ–¹æ³•ã€‚<code>Reload</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>tmpl.Reload(true)
</span></span></code></pre></div><p>è¦ä½¿ç”¨<strong>åµŒå…¥å¼</strong>æ¨¡æ¿è€Œä¸ä¾èµ–äºæœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œè¯·ä½¿ç”¨ <a href="https://github.com/go-bindata/go-bindata">go-bindata</a> å¤–éƒ¨å·¥å…·ï¼Œå¹¶å°†å…¶ç”Ÿæˆçš„å‡½æ•°ä¼ é€’ç»™é¦–é€‰è§†å›¾å¼•æ“çš„ç¬¬ä¸€ä¸ªè¾“å…¥å‚æ•°ã€‚<code>AssetFile()</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span> tmpl := iris.HTML(AssetFile(), &#34;.html&#34;)
</span></span></code></pre></div><p>ç¤ºä¾‹ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#75715e">// file: main.go
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Parse all templates from the &#34;./views&#34; folder
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// where extension is &#34;.html&#34; and parse them
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// using the standard `html/template` package.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">tmpl</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">HTML</span>(<span style="color:#e6db74">&#34;./views&#34;</span>, <span style="color:#e6db74">&#34;.html&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Set custom delimeters.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">tmpl</span>.<span style="color:#a6e22e">Delims</span>(<span style="color:#e6db74">&#34;{{&#34;</span>, <span style="color:#e6db74">&#34;}}&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Enable re-build on local template files changes.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">tmpl</span>.<span style="color:#a6e22e">Reload</span>(<span style="color:#66d9ef">true</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Default template funcs are:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// - {{ urlpath &#34;myNamedRoute&#34; &#34;pathParameter_ifNeeded&#34; }}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// - {{ render &#34;header.html&#34; . }}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// and partial relative path to current page:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// - {{ render_r &#34;header.html&#34; . }} 
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// - {{ yield . }}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// - {{ current }}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// Register a custom template func:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">tmpl</span>.<span style="color:#a6e22e">AddFunc</span>(<span style="color:#e6db74">&#34;greet&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">s</span> <span style="color:#66d9ef">string</span>) <span style="color:#66d9ef">string</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#34;Greetings &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">s</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;!&#34;</span>
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Register the view engine to the views,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// this will load the templates.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">RegisterView</span>(<span style="color:#a6e22e">tmpl</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Method:    GET
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// Resource:  http://localhost:8080
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Bind: {{.message}} with &#34;Hello world!&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ViewData</span>(<span style="color:#e6db74">&#34;message&#34;</span>, <span style="color:#e6db74">&#34;Hello world!&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Render template file: ./views/hi.html
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">View</span>(<span style="color:#e6db74">&#34;hi.html&#34;</span>); <span style="color:#a6e22e">err</span><span style="color:#f92672">!=</span><span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">HTML</span>(<span style="color:#e6db74">&#34;&lt;h3&gt;%s&lt;/h3&gt;&#34;</span>, <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>())
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;!-- file: ./views/hi.html --&gt;
</span></span><span style="display:flex;"><span>&lt;html&gt;
</span></span><span style="display:flex;"><span>&lt;head&gt;
</span></span><span style="display:flex;"><span>    &lt;title&gt;Hi Page&lt;/title&gt;
</span></span><span style="display:flex;"><span>&lt;/head&gt;
</span></span><span style="display:flex;"><span>&lt;body&gt;
</span></span><span style="display:flex;"><span>    &lt;h1&gt;{{.message}}&lt;/h1&gt;
</span></span><span style="display:flex;"><span>    &lt;strong&gt;{{greet &#34;to you&#34;}}&lt;/strong&gt;
</span></span><span style="display:flex;"><span>&lt;/body&gt;
</span></span><span style="display:flex;"><span>&lt;/html&gt;
</span></span></code></pre></div><p>åœ¨ <a href="http://localhost:8080/">http://localhost:8080</a> å¤„æ‰“å¼€æµè§ˆå™¨é€‰é¡¹å¡ã€‚</p>
<p><strong>æ¸²æŸ“çš„ç»“æœ</strong>å°†å¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;html&gt;
</span></span><span style="display:flex;"><span>&lt;head&gt;
</span></span><span style="display:flex;"><span>    &lt;title&gt;Hi Page&lt;/title&gt;
</span></span><span style="display:flex;"><span>&lt;/head&gt;
</span></span><span style="display:flex;"><span>&lt;body&gt;
</span></span><span style="display:flex;"><span>    &lt;h1&gt;Hello world!&lt;/h1&gt;
</span></span><span style="display:flex;"><span>    &lt;strong&gt;Greetings to you!&lt;/strong&gt;
</span></span><span style="display:flex;"><span>&lt;/body&gt;
</span></span><span style="display:flex;"><span>&lt;/html&gt;
</span></span></code></pre></div><h3 id="å¤šæ¨¡æ¿httpswwwiris-gocomdocsidmultitemplate"><a href="https://www.iris-go.com/docs/#/?id=multitemplate">å¤šæ¨¡æ¿</a><a hidden class="anchor" aria-hidden="true" href="#å¤šæ¨¡æ¿httpswwwiris-gocomdocsidmultitemplate">#</a></h3>
<p>Iris å…è®¸æ¯ä¸ªåº”ç”¨ç¨‹åºæ³¨å†Œæ— é™æ•°é‡çš„è§†å›¾å¼•æ“ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæ‚¨è¿˜å¯ä»¥<strong>ä¸ºæ¯ä¸ªæ´¾å¯¹æˆ–é€šè¿‡ä¸­é—´ä»¶</strong>æ³¨å†Œä¸€ä¸ªè§†å›¾å¼•æ“ï¼</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>// Register a view engine per group of routes.
</span></span><span style="display:flex;"><span>adminGroup := app.Party(&#34;/admin&#34;)
</span></span><span style="display:flex;"><span>adminGroup.RegisterView(iris.Blocks(&#34;./views/admin&#34;, &#34;.html&#34;))
</span></span></code></pre></div><h4 id="é€šè¿‡ä¸­é—´ä»¶httpswwwiris-gocomdocsidthrough-middleware"><a href="https://www.iris-go.com/docs/#/?id=through-middleware">é€šè¿‡ä¸­é—´ä»¶</a><a hidden class="anchor" aria-hidden="true" href="#é€šè¿‡ä¸­é—´ä»¶httpswwwiris-gocomdocsidthrough-middleware">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func middleware(views iris.ViewEngine) iris.Handler {
</span></span><span style="display:flex;"><span>    return func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        ctx.ViewEngine(views)
</span></span><span style="display:flex;"><span>        ctx.Next()
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>ç”¨æ³•</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>// Register a view engine on-fly for the current chain of handlers.
</span></span><span style="display:flex;"><span>views := iris.Blocks(&#34;./views/on-fly&#34;, &#34;.html&#34;)
</span></span><span style="display:flex;"><span>views.Load()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app.Get(&#34;/&#34;, setViews(views), onFly)
</span></span></code></pre></div><h3 id="é‡-å®šå‘httpswwwiris-gocomdocsidredirects"><a href="https://www.iris-go.com/docs/#/?id=redirects">é‡ å®šå‘</a><a hidden class="anchor" aria-hidden="true" href="#é‡-å®šå‘httpswwwiris-gocomdocsidredirects">#</a></h3>
<p>å‘å‡º HTTP é‡å®šå‘å¾ˆå®¹æ˜“ã€‚æ”¯æŒå†…éƒ¨å’Œå¤–éƒ¨ä½ç½®ã€‚æˆ‘ä»¬æ‰€è¯´çš„ä½ç½®æ˜¯æŒ‡è·¯å¾„ã€å­åŸŸã€åŸŸç­‰ã€‚</p>
<h4 id="ä»å¤„ç†ç¨‹åºhttpswwwiris-gocomdocsidfrom-handler"><a href="https://www.iris-go.com/docs/#/?id=from-handler">ä»å¤„ç†ç¨‹åº</a><a hidden class="anchor" aria-hidden="true" href="#ä»å¤„ç†ç¨‹åºhttpswwwiris-gocomdocsidfrom-handler">#</a></h4>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>app.Get(&#34;/&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    ctx.Redirect(&#34;https://go.dev/dl&#34;, iris.StatusMovedPermanently)
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><p>ä»å¼€æœºè‡ªæ£€å‘å‡º HTTP é‡å®šå‘ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>app.Post(&#34;/&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    ctx.Redirect(&#34;/login&#34;, iris.StatusFound)
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><p>ä»å¤„ç†ç¨‹åºå‘å‡ºæœ¬åœ°è·¯ç”±å™¨é‡å®šå‘ï¼Œä½¿ç”¨æˆ–ç±»ä¼¼å¦‚ä¸‹ã€‚<code>Application.ServeHTTPC``Exec()</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>app.Get(&#34;/test&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    r := ctx.Request()
</span></span><span style="display:flex;"><span>    r.URL.Path = &#34;/test2&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    ctx.Application().ServeHTTPC(ctx)
</span></span><span style="display:flex;"><span>    // OR
</span></span><span style="display:flex;"><span>    // ctx.Exec(&#34;GET&#34;, &#34;/test2&#34;)
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>app.Get(&#34;/test2&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    ctx.JSON(iris.Map{&#34;hello&#34;: &#34;world&#34;})
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><h4 id="å…¨çƒhttpswwwiris-gocomdocsidglobally"><a href="https://www.iris-go.com/docs/#/?id=globally">å…¨çƒ</a><a hidden class="anchor" aria-hidden="true" href="#å…¨çƒhttpswwwiris-gocomdocsidglobally">#</a></h4>
<p>ä½¿ç”¨æˆ‘ä»¬éƒ½å–œæ¬¢çš„è¯­æ³•ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>import &#34;github.com/kataras/iris/v12/middleware/rewrite&#34;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.New()
</span></span><span style="display:flex;"><span>    // [...routes]
</span></span><span style="display:flex;"><span>    redirects := rewrite.Load(&#34;redirects.yml&#34;)
</span></span><span style="display:flex;"><span>    app.WrapRouter(redirects)
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:80&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¯¥æ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š<code>&quot;redirects.yml&quot;</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>RedirectMatch:
</span></span><span style="display:flex;"><span>  # Redirects /seo/* to /*
</span></span><span style="display:flex;"><span>  - 301 /seo/(.*) /$1
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  # Redirects /docs/v12* to /docs
</span></span><span style="display:flex;"><span>  - 301 /docs/v12(.*) /docs
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  # Redirects /old(.*) to /
</span></span><span style="display:flex;"><span>  - 301 /old(.*) /
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  # Redirects http or https://test.* to http or https://newtest.*
</span></span><span style="display:flex;"><span>  - 301 ^(http|https)://test.(.*) $1://newtest.$2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  # Handles /*.json or .xml as *?format=json or xml,
</span></span><span style="display:flex;"><span>  # without redirect. See /users route.
</span></span><span style="display:flex;"><span>  # When Code is 0 then it does not redirect the request,
</span></span><span style="display:flex;"><span>  # instead it changes the request URL
</span></span><span style="display:flex;"><span>  # and leaves a route handle the request.
</span></span><span style="display:flex;"><span>  - 0 /(.*).(json|xml) /$1?format=$2
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span># Redirects root domain to www.
</span></span><span style="display:flex;"><span># Creation of a www subdomain inside the Application is unnecessary,
</span></span><span style="display:flex;"><span># all requests are handled by the root Application itself.
</span></span><span style="display:flex;"><span>PrimarySubdomain: www
</span></span></code></pre></div><p>å®Œæ•´çš„ä»£ç å¯ä»¥åœ¨<a href="https://github.com/kataras/iris/tree/master/_examples/routing/rewrite">é‡å†™ä¸­é—´ä»¶ç¤ºä¾‹ä¸­</a>æ‰¾åˆ°ã€‚</p>
<h3 id="è‡ªå®šä¹‰ä¸­é—´ä»¶httpswwwiris-gocomdocsidcustom-middleware"><a href="https://www.iris-go.com/docs/#/?id=custom-middleware">è‡ªå®šä¹‰ä¸­é—´ä»¶</a><a hidden class="anchor" aria-hidden="true" href="#è‡ªå®šä¹‰ä¸­é—´ä»¶httpswwwiris-gocomdocsidcustom-middleware">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func Logger() iris.Handler {
</span></span><span style="display:flex;"><span>    return func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        t := time.Now()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        // Set a shared variable between handlers
</span></span><span style="display:flex;"><span>        ctx.Values().Set(&#34;framework&#34;, &#34;iris&#34;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        // before request
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ctx.Next()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        // after request
</span></span><span style="display:flex;"><span>        latency := time.Since(t)
</span></span><span style="display:flex;"><span>        log.Print(latency)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        // access the status we are sending
</span></span><span style="display:flex;"><span>        status := ctx.GetStatusCode()
</span></span><span style="display:flex;"><span>        log.Println(status)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.New()
</span></span><span style="display:flex;"><span>    app.Use(Logger())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Get(&#34;/test&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        // retrieve a value set by the middleware.
</span></span><span style="display:flex;"><span>        framework := ctx.Values().GetString(&#34;framework&#34;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        // it would print: &#34;iris&#34;
</span></span><span style="display:flex;"><span>        log.Println(framework)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>(adsbygoogle = window.adsbygoogle || []).push({});</p>
<h3 id="ä½¿ç”¨åŸºæœ¬èº«ä»½éªŒè¯httpswwwiris-gocomdocsidusing-basic-authentication"><a href="https://www.iris-go.com/docs/#/?id=using-basic-authentication">ä½¿ç”¨åŸºæœ¬èº«ä»½éªŒè¯</a><a hidden class="anchor" aria-hidden="true" href="#ä½¿ç”¨åŸºæœ¬èº«ä»½éªŒè¯httpswwwiris-gocomdocsidusing-basic-authentication">#</a></h3>
<p>HTTP åŸºæœ¬èº«ä»½éªŒè¯æ˜¯å¯¹ Web èµ„æºå®æ–½è®¿é—®æ§åˆ¶çš„æœ€ç®€å•æŠ€æœ¯ï¼Œå› ä¸ºå®ƒä¸éœ€è¦ Cookieã€ä¼šè¯æ ‡è¯†ç¬¦æˆ–ç™»å½•é¡µé¢;ç›¸åï¼ŒHTTP åŸºæœ¬èº«ä»½éªŒè¯ä½¿ç”¨ HTTP æ ‡å¤´ä¸­çš„æ ‡å‡†å­—æ®µã€‚</p>
<p>åŸºæœ¬èº«ä»½éªŒè¯ä¸­é—´ä»¶<a href="https://github.com/kataras/iris/tree/master/middleware/basicauth">åŒ…å«åœ¨</a> Iris æ¡†æ¶ä¸­ï¼Œå› æ­¤æ— éœ€å•ç‹¬å®‰è£…ã€‚</p>
<p><strong>1.</strong> å¯¼å…¥ä¸­é—´ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>import &#34;github.com/kataras/iris/v12/middleware/basicauth&#34;
</span></span></code></pre></div><p><strong>2.</strong> ä½¿ç”¨å…¶ç»“æ„é…ç½®ä¸­é—´ä»¶ï¼š<code>Options</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>opts := basicauth.Options{
</span></span><span style="display:flex;"><span>    Allow: basicauth.AllowUsers(map[string]string{
</span></span><span style="display:flex;"><span>        &#34;username&#34;: &#34;password&#34;,
</span></span><span style="display:flex;"><span>    }),
</span></span><span style="display:flex;"><span>    Realm:        &#34;Authorization Required&#34;,
</span></span><span style="display:flex;"><span>    ErrorHandler: basicauth.DefaultErrorHandler,
</span></span><span style="display:flex;"><span>    // [...more options]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>3.</strong> åˆå§‹åŒ–ä¸­é—´ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>auth := basicauth.New(opts)
</span></span></code></pre></div><p><strong>3.1</strong> ä»¥ä¸Šæ­¥éª¤ä¸å‡½æ•°ç›¸åŒï¼š<code>Default</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>auth := basicauth.Default(map[string]string{
</span></span><span style="display:flex;"><span>    &#34;username&#34;: &#34;password&#34;,
</span></span><span style="display:flex;"><span>})
</span></span></code></pre></div><p><strong>3.2</strong> ä½¿ç”¨è‡ªå®šä¹‰ç”¨æˆ·åˆ‡ç‰‡ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>// The struct value MUST contain a Username and Passwords fields
</span></span><span style="display:flex;"><span>// or GetUsername() string and GetPassword() string methods.
</span></span><span style="display:flex;"><span>type User struct {
</span></span><span style="display:flex;"><span>    Username string
</span></span><span style="display:flex;"><span>    Password string
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// [...]
</span></span><span style="display:flex;"><span>auth := basicauth.Default([]User{...})
</span></span></code></pre></div><p><strong>3.3</strong> ä»æ–‡ä»¶åŠ è½½ç”¨æˆ· æˆ–è€…ï¼Œå¯†ç ä½¿ç”¨ <a href="https://pkg.go.dev/golang.org/x/crypto/bcrypt">pkg.go.dev/golang.org/x/crypto/bcrypt</a> åŒ…è¿›è¡ŒåŠ å¯†ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>auth := basicauth.Load(&#34;users.yml&#34;, basicauth.BCRYPT)
</span></span></code></pre></div><p><strong>3.3.1</strong> ä½¿ç”¨ï¼ˆæ¨èï¼‰ä¹Ÿå¯ä»¥å®ç°ç›¸åŒçš„ç›®çš„ï¼š<code>Options</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>opts := basicauth.Options{
</span></span><span style="display:flex;"><span>    Allow: basicauth.AllowUsersFile(&#34;users.yml&#34;, basicauth.BCRYPT),
</span></span><span style="display:flex;"><span>    Realm: basicauth.DefaultRealm,
</span></span><span style="display:flex;"><span>    // [...more options]
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>auth := basicauth.New(opts)
</span></span></code></pre></div><p>å…¶ä¸­å¯èƒ½çœ‹èµ·æ¥åƒè¿™æ ·ï¼š<code>users.yml</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>- username: kataras
</span></span><span style="display:flex;"><span>  password: $2a$10$Irg8k8HWkDlvL0YDBKLCYee6j6zzIFTplJcvZYKA.B8/clHPZn2Ey
</span></span><span style="display:flex;"><span>  # encrypted of kataras_pass
</span></span><span style="display:flex;"><span>  role: admin
</span></span><span style="display:flex;"><span>- username: makis
</span></span><span style="display:flex;"><span>  password: $2a$10$3GXzp3J5GhHThGisbpvpZuftbmzPivDMo94XPnkTnDe7254x7sJ3O
</span></span><span style="display:flex;"><span>  # encrypted of makis_pass
</span></span><span style="display:flex;"><span>  role: member
</span></span></code></pre></div><p><strong>4.</strong> æ³¨å†Œä¸­é—´ä»¶ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>// Register to all matched routes
</span></span><span style="display:flex;"><span>// under a Party and its children.
</span></span><span style="display:flex;"><span>app.Use(auth)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// OR/and register to all http error routes.
</span></span><span style="display:flex;"><span>app.UseError(auth)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// OR register under a path prefix of a specific Party,
</span></span><span style="display:flex;"><span>// including all http errors of this path prefix.
</span></span><span style="display:flex;"><span>app.UseRouter(auth)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// OR register to a specific Route before its main handler.
</span></span><span style="display:flex;"><span>app.Post(&#34;/protected&#34;, auth, routeHandler)
</span></span></code></pre></div><p><strong>5.</strong> æ£€ç´¢ç”¨æˆ·åå’Œå¯†ç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func routeHandler(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    username, password, _ := ctx.Request().BasicAuth()
</span></span><span style="display:flex;"><span>    // [...]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>5.1</strong> æ£€ç´¢ User å€¼ï¼ˆå½“æ‚¨åœ¨ä»¥ä¸‹ä½ç½®æ³¨å†Œè‡ªå®šä¹‰ç”¨æˆ·ç»“æ„çš„ä¸€éƒ¨åˆ†æ—¶å¾ˆæœ‰ç”¨ï¼‰ï¼š<code>Options.AllowUsers</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func routeHandler(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    user := ctx.User().(*iris.SimpleUser)
</span></span><span style="display:flex;"><span>    // user.Username
</span></span><span style="display:flex;"><span>    // user.Password
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>åœ¨ <a href="https://github.com/kataras/iris/tree/master/_examples/auth">_examples/auth</a> ä¸­é˜…è¯»æ›´å¤šæˆæƒå’Œèº«ä»½éªŒè¯ç¤ºä¾‹ã€‚</p>
<h3 id="ä¸­é—´ä»¶ä¸­çš„-goroutineshttpswwwiris-gocomdocsidgoroutines-inside-a-middleware"><a href="https://www.iris-go.com/docs/#/?id=goroutines-inside-a-middleware">ä¸­é—´ä»¶ä¸­çš„ Goroutines</a><a hidden class="anchor" aria-hidden="true" href="#ä¸­é—´ä»¶ä¸­çš„-goroutineshttpswwwiris-gocomdocsidgoroutines-inside-a-middleware">#</a></h3>
<p>åœ¨ä¸­é—´ä»¶æˆ–å¤„ç†ç¨‹åºä¸­å¯åŠ¨æ–°çš„ Goroutines æ—¶ï¼Œæ‚¨<strong>ä¸åº”è¯¥</strong>ä½¿ç”¨å…¶ä¸­çš„åŸå§‹ä¸Šä¸‹æ–‡ï¼Œæ‚¨å¿…é¡»ä½¿ç”¨åªè¯»å‰¯æœ¬ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.Default()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Get(&#34;/long_async&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        // create a clone to be used inside the goroutine
</span></span><span style="display:flex;"><span>        ctxCopy := ctx.Clone()
</span></span><span style="display:flex;"><span>        go func() {
</span></span><span style="display:flex;"><span>            // simulate a long task with time.Sleep(). 5 seconds
</span></span><span style="display:flex;"><span>            time.Sleep(5 * time.Second)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            // note that you are using the copied context &#34;ctxCopy&#34;, IMPORTANT
</span></span><span style="display:flex;"><span>            log.Printf(&#34;Done! in path: %s&#34;, ctxCopy.Path())
</span></span><span style="display:flex;"><span>        }()
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Get(&#34;/long_sync&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        // simulate a long task with time.Sleep(). 5 seconds
</span></span><span style="display:flex;"><span>        time.Sleep(5 * time.Second)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        // since we are NOT using a goroutine, we do not have to copy the context
</span></span><span style="display:flex;"><span>        log.Printf(&#34;Done! in path: %s&#34;, ctx.Path())
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="è‡ªå®šä¹‰-http-é…ç½®httpswwwiris-gocomdocsidcustom-http-configuration"><a href="https://www.iris-go.com/docs/#/?id=custom-http-configuration">è‡ªå®šä¹‰ HTTP é…ç½®</a><a hidden class="anchor" aria-hidden="true" href="#è‡ªå®šä¹‰-http-é…ç½®httpswwwiris-gocomdocsidcustom-http-configuration">#</a></h3>
<p>åœ¨ <a href="https://github.com/kataras/iris/tree/master/_examples/http-server">_examples/http-server</a> æ–‡ä»¶å¤¹ä¸­å¯ä»¥æ‰¾åˆ°è¶…è¿‡ 12 ä¸ªæœ‰å…³ http æœåŠ¡å™¨é…ç½®çš„ç¤ºä¾‹ã€‚</p>
<p>ç›´æ¥ä½¿ç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š<code>http.ListenAndServe()</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.New()
</span></span><span style="display:flex;"><span>    // [...routes]
</span></span><span style="display:flex;"><span>    if err := app.Build(); err!=nil{
</span></span><span style="display:flex;"><span>        panic(err)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    http.ListenAndServe(&#34;:8080&#34;, app)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è¯·æ³¨æ„ï¼Œ<strong>åœ¨</strong>å°†å…¶ç”¨ä½œ .<code>Build``http.Handler</code></p>
<p>å†æ¯”å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.New()
</span></span><span style="display:flex;"><span>    // [...routes]
</span></span><span style="display:flex;"><span>    app.Build()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    srv := &amp;http.Server{
</span></span><span style="display:flex;"><span>        Addr:           &#34;:8080&#34;,
</span></span><span style="display:flex;"><span>        Handler:        app,
</span></span><span style="display:flex;"><span>        ReadTimeout:    10 * time.Second,
</span></span><span style="display:flex;"><span>        WriteTimeout:   10 * time.Second,
</span></span><span style="display:flex;"><span>        MaxHeaderBytes: 1 &lt;&lt; 20,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    srv.ListenAndServe()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>ä½†æ˜¯ï¼Œæ‚¨å¾ˆå°‘éœ€è¦å…·æœ‰ IRIS çš„å¤–éƒ¨å®ä¾‹ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä»»ä½• tcp ä¾¦å¬å™¨ã€http æœåŠ¡å™¨æˆ–é€šè¿‡æ–¹æ³•è‡ªå®šä¹‰å‡½æ•°è¿›è¡Œä¾¦å¬ã€‚<code>http.Server``Application.Run</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>app.Run(iris.Listener(l net.Listener)) // listen using a custom net.Listener
</span></span><span style="display:flex;"><span>app.Run(iris.Server(srv *http.Server)) // listen using a custom http.Server
</span></span><span style="display:flex;"><span>app.Run(iris.Addr(addr string)) // the app.Listen is a shortcut of this method.
</span></span><span style="display:flex;"><span>app.Run(iris.TLS(addr string, certFileOrContents, keyFileOrContents string)) // listen TLS.
</span></span><span style="display:flex;"><span>app.Run(iris.AutoTLS(addr, domain, email string)) // listen using letsencrypt (see below).
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// and any custom function that returns an error:
</span></span><span style="display:flex;"><span>app.Run(iris.Raw(f func() error))
</span></span></code></pre></div><h3 id="å¥—æ¥å­—åˆ†ç‰‡httpswwwiris-gocomdocsidsocket-sharding"><a href="https://www.iris-go.com/docs/#/?id=socket-sharding">å¥—æ¥å­—åˆ†ç‰‡</a><a hidden class="anchor" aria-hidden="true" href="#å¥—æ¥å­—åˆ†ç‰‡httpswwwiris-gocomdocsidsocket-sharding">#</a></h3>
<p>æ­¤é€‰é¡¹å…è®¸<strong>åœ¨å¤š CPU æœåŠ¡å™¨ä¸Šçº¿æ€§</strong>æ‰©å±•æœåŠ¡å™¨æ€§èƒ½ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… <a href="https://www.nginx.com/blog/socket-sharding-nginx-release-1-9-1/">https://www.nginx.com/blog/socket-sharding-nginx-release-1-9-1/</a>ã€‚ä½¿ç”¨é…ç½®å™¨å¯ç”¨ã€‚<code>iris.WithSocketSharding</code></p>
<p><em>ç¤ºä¾‹ä»£ç ï¼š</em></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">startup</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Now</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">s</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">startup</span>.<span style="color:#a6e22e">Format</span>(<span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Application</span>().<span style="color:#a6e22e">ConfigurationReadOnly</span>().<span style="color:#a6e22e">GetTimeFormat</span>())
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Writef</span>(<span style="color:#e6db74">&#34;This server started at: %s\n&#34;</span>, <span style="color:#a6e22e">s</span>)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>, <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">WithSocketSharding</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// or app.Run(..., iris.WithSocketSharding)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span></code></pre></div><h3 id="æ”¯æŒè®©æˆ‘ä»¬åŠ å¯†httpswwwiris-gocomdocsidsupport-let39s-encrypt"><a href="https://www.iris-go.com/docs/#/?id=support-let39s-encrypt">æ”¯æŒè®©æˆ‘ä»¬åŠ å¯†</a><a hidden class="anchor" aria-hidden="true" href="#æ”¯æŒè®©æˆ‘ä»¬åŠ å¯†httpswwwiris-gocomdocsidsupport-let39s-encrypt">#</a></h3>
<p>1 è¡Œ LetsEncrypt HTTPS æœåŠ¡å™¨çš„ç¤ºä¾‹ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/iris-gonic/autotls&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Default</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Ping handler
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/ping&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#e6db74">&#34;pong&#34;</span>)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">AutoTLS</span>(<span style="color:#e6db74">&#34;:443&#34;</span>, <span style="color:#e6db74">&#34;example.com example2.com&#34;</span>, <span style="color:#e6db74">&#34;mail@example.com&#34;</span>))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>è‡ªå®šä¹‰ TLS ç¤ºä¾‹ï¼ˆæ‚¨ä¹Ÿå¯ä»¥ç»‘å®šè‡ªåŠ¨è¯ä¹¦ç®¡ç†å™¨ï¼‰ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>app.Run(
</span></span><span style="display:flex;"><span>    iris.TLS(&#34;:443&#34;, &#34;&#34;, &#34;&#34;, func(su *iris.Supervisor) {
</span></span><span style="display:flex;"><span>        su.Server.TLSConfig = &amp;tls.Config{
</span></span><span style="display:flex;"><span>            /* your custom fields */
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>    }),
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><blockquote>
<p>æ‰€æœ‰æ–¹æ³•ï¼ˆå¦‚ï¼šAddrï¼ŒTLSï¼ŒAutoTLSï¼ŒServerï¼ŒListenerå’Œe.t.cï¼‰éƒ½æ¥å—å¯å˜å‚æ•°ï¼Œä»¥åœ¨æ„å»ºçŠ¶æ€ä¸Šé…ç½®httpæœåŠ¡å™¨å®ä¾‹ã€‚<code>iris.Runner``func(*iris.Supervisor)</code></p>
</blockquote>
<h3 id="ä½¿ç”¨é¸¢å°¾èŠ±è¿è¡Œå¤šä¸ªæœåŠ¡httpswwwiris-gocomdocsidrun-multiple-service-using-iris"><a href="https://www.iris-go.com/docs/#/?id=run-multiple-service-using-iris">ä½¿ç”¨é¸¢å°¾èŠ±è¿è¡Œå¤šä¸ªæœåŠ¡</a><a hidden class="anchor" aria-hidden="true" href="#ä½¿ç”¨é¸¢å°¾èŠ±è¿è¡Œå¤šä¸ªæœåŠ¡httpswwwiris-gocomdocsidrun-multiple-service-using-iris">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;log&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12/middleware/recover&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;golang.org/x/sync/errgroup&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">g</span> <span style="color:#a6e22e">errgroup</span>.<span style="color:#a6e22e">Group</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">startApp1</span>() <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>().<span style="color:#a6e22e">SetName</span>(<span style="color:#e6db74">&#34;app1&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Use</span>(<span style="color:#a6e22e">recover</span>.<span style="color:#a6e22e">New</span>())
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Map</span>{
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;code&#34;</span>:  <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusOK</span>,
</span></span><span style="display:flex;"><span>                <span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Welcome server 1&#34;</span>,
</span></span><span style="display:flex;"><span>            })
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Build</span>()
</span></span><span style="display:flex;"><span>   <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">startApp2</span>() <span style="color:#66d9ef">error</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>().<span style="color:#a6e22e">SetName</span>(<span style="color:#e6db74">&#34;app2&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Use</span>(<span style="color:#a6e22e">recover</span>.<span style="color:#a6e22e">New</span>())
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">JSON</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Map</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;code&#34;</span>:  <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusOK</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;message&#34;</span>: <span style="color:#e6db74">&#34;Welcome server 2&#34;</span>,
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8081&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">Go</span>(<span style="color:#a6e22e">startApp1</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">Go</span>(<span style="color:#a6e22e">startApp2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">g</span>.<span style="color:#a6e22e">Wait</span>(); <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">log</span>.<span style="color:#a6e22e">Fatal</span>(<span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>é€šè¿‡åŒ…ç®¡ç†å¤šä¸ªé¸¢å°¾èŠ±å®ä¾‹ã€‚<a href="https://github.com/kataras/iris/blob/master/apps/README.md">åœ¨æ­¤å¤„</a>é˜…è¯»æ›´å¤šå†…å®¹ã€‚<code>apps</code></p>
<p>(adsbygoogle = window.adsbygoogle || []).push({});</p>
<h3 id="æ­£å¸¸å…³æœºæˆ–é‡å¯httpswwwiris-gocomdocsidgraceful-shutdown-or-restart"><a href="https://www.iris-go.com/docs/#/?id=graceful-shutdown-or-restart">æ­£å¸¸å…³æœºæˆ–é‡å¯</a><a hidden class="anchor" aria-hidden="true" href="#æ­£å¸¸å…³æœºæˆ–é‡å¯httpswwwiris-gocomdocsidgraceful-shutdown-or-restart">#</a></h3>
<p>æœ‰å‡ ç§æ–¹æ³•å¯ç”¨äºæ‰§è¡Œæ­£å¸¸å…³æœºæˆ–é‡æ–°å¯åŠ¨ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ä¸“é—¨ä¸ºæ­¤æ„å»ºçš„ç¬¬ä¸‰æ–¹åŒ…ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•ã€‚å¯ä»¥<a href="https://github.com/kataras/iris/tree/master/_examples/http-server/graceful-shutdown">åœ¨æ­¤å¤„</a>æ‰¾åˆ°ç¤ºä¾‹ã€‚<code>app.Shutdown(context.Context)</code></p>
<p>ä½¿ç”¨ CTRL/CMD+C åœ¨ CTRL/CMD+C ä¸Šæ³¨å†Œäº‹ä»¶ï¼š<code>iris.RegisterOnInterrupt</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>idleConnsClosed := make(chan struct{})
</span></span><span style="display:flex;"><span>iris.RegisterOnInterrupt(func() {
</span></span><span style="display:flex;"><span>    timeout := 10 * time.Second
</span></span><span style="display:flex;"><span>    ctx, cancel := stdContext.WithTimeout(stdContext.Background(), timeout)
</span></span><span style="display:flex;"><span>    defer cancel()
</span></span><span style="display:flex;"><span>    // close all hosts.
</span></span><span style="display:flex;"><span>    app.Shutdown(ctx)
</span></span><span style="display:flex;"><span>    close(idleConnsClosed)
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// [...]
</span></span><span style="display:flex;"><span>app.Listen(&#34;:8080&#34;, iris.WithoutInterruptHandler, iris.WithoutServerError(iris.ErrServerClosed))
</span></span><span style="display:flex;"><span>&lt;-idleConnsClosed
</span></span></code></pre></div><h3 id="ä½¿ç”¨æ¨¡æ¿æ„å»ºå•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶httpswwwiris-gocomdocsidbuild-a-single-binary-with-templates"><a href="https://www.iris-go.com/docs/#/?id=build-a-single-binary-with-templates">ä½¿ç”¨æ¨¡æ¿æ„å»ºå•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶</a><a hidden class="anchor" aria-hidden="true" href="#ä½¿ç”¨æ¨¡æ¿æ„å»ºå•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶httpswwwiris-gocomdocsidbuild-a-single-binary-with-templates">#</a></h3>
<p>æ‚¨å¯ä»¥ä½¿ç”¨ [go-bindata][<a href="https://github.com/go-bindata/go-bindata%5D's">https://github.com/go-bindata/go-bindata]</a> çš„ç”Ÿæˆå‡½æ•°å°†æœåŠ¡å™¨æ„å»ºåˆ°åŒ…å«æ¨¡æ¿çš„å•ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ä¸­ã€‚<code>AssetFile</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ go get -u github.com/go-bindata/go-bindata/...
</span></span><span style="display:flex;"><span>$ go-bindata -fs -prefix &#34;templates&#34; ./templates/...
</span></span><span style="display:flex;"><span>$ go run .
</span></span></code></pre></div><p>ç¤ºä¾‹ä»£ç ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.New()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    tmpl := iris.HTML(AssetFile(), &#34;.html&#34;)
</span></span><span style="display:flex;"><span>    tmpl.Layout(&#34;layouts/layout.html&#34;)
</span></span><span style="display:flex;"><span>    tmpl.AddFunc(&#34;greet&#34;, func(s string) string {
</span></span><span style="display:flex;"><span>        return &#34;Greetings &#34; + s + &#34;!&#34;
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    app.RegisterView(tmpl)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    // [...]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>åœ¨<a href="https://github.com/kataras/iris/tree/master/_examples/view">_examples/è§†å›¾ä¸­</a>æŸ¥çœ‹å®Œæ•´ç¤ºä¾‹ã€‚</p>
<h3 id="å°è¯•å°†èº«ä½“ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä¸­httpswwwiris-gocomdocsidtry-to-bind-body-into-different-structs"><a href="https://www.iris-go.com/docs/#/?id=try-to-bind-body-into-different-structs">å°è¯•å°†èº«ä½“ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä¸­</a><a hidden class="anchor" aria-hidden="true" href="#å°è¯•å°†èº«ä½“ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä¸­httpswwwiris-gocomdocsidtry-to-bind-body-into-different-structs">#</a></h3>
<p>ç»‘å®šè¯·æ±‚æ­£æ–‡çš„å¸¸è§„æ–¹æ³•æ¶ˆè€—ï¼Œå®ƒä»¬ ä¸èƒ½å¤šæ¬¡è°ƒç”¨ï¼Œ<strong>é™¤é</strong>å°†é…ç½®å™¨ä¼ é€’ç»™ ã€‚<code>ctx.Request().Body``iris.WithoutBodyConsumptionOnUnmarshal``app.Run/Listen</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">logAllBody</span>, <span style="color:#a6e22e">logJSON</span>, <span style="color:#a6e22e">logFormValues</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// body, err := os.ReadAll(ctx.Request().Body) once or
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">body</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">GetBody</span>() <span style="color:#75715e">// as many times as you need.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithError</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusInternalServerError</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> len(<span style="color:#a6e22e">body</span>) <span style="color:#f92672">==</span> <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#e6db74">`The body was empty.`</span>)
</span></span><span style="display:flex;"><span>        } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#e6db74">&#34;OK body is still:\n&#34;</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Write</span>(<span style="color:#a6e22e">body</span>)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>, <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">WithoutBodyConsumptionOnUnmarshal</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">logAllBody</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">body</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">GetBody</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> <span style="color:#f92672">&amp;&amp;</span> len(<span style="color:#a6e22e">body</span>) &gt; <span style="color:#ae81ff">0</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Application</span>().<span style="color:#a6e22e">Logger</span>().<span style="color:#a6e22e">Infof</span>(<span style="color:#e6db74">&#34;logAllBody: %s&#34;</span>, string(<span style="color:#a6e22e">body</span>))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Next</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">logJSON</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">p</span> <span style="color:#66d9ef">interface</span>{}
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ReadJSON</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">p</span>); <span style="color:#a6e22e">err</span> <span style="color:#f92672">==</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Application</span>().<span style="color:#a6e22e">Logger</span>().<span style="color:#a6e22e">Infof</span>(<span style="color:#e6db74">&#34;logJSON: %#+v&#34;</span>, <span style="color:#a6e22e">p</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Next</span>()
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">logFormValues</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">values</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">FormValues</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">values</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Application</span>().<span style="color:#a6e22e">Logger</span>().<span style="color:#a6e22e">Infof</span>(<span style="color:#e6db74">&#34;logFormValues: %v&#34;</span>, <span style="color:#a6e22e">values</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Next</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¯ä»¥ä½¿ç”¨ å°†ç»“æ„ç»‘å®šåˆ°åŸºäºå®¢æˆ·ç«¯å†…å®¹ç±»å‹çš„è¯·æ±‚ã€‚æ‚¨è¿˜å¯ä»¥ä½¿ç”¨<a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Content_negotiation">å†…å®¹åå•†</a>ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªå®Œæ•´çš„ç¤ºä¾‹ï¼š<code>ReadBody</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">newApp</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// See main_test.go for usage.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">newApp</span>() <span style="color:#f92672">*</span><span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Application</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// To automatically decompress using gzip:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// app.Use(iris.GzipReader)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Use</span>(<span style="color:#a6e22e">setAllowedResponses</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Post</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">readBody</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">app</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">payload</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Message</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;message&#34; xml:&#34;message&#34; msgpack:&#34;message&#34; yaml:&#34;Message&#34; url:&#34;message&#34; form:&#34;message&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">readBody</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">p</span> <span style="color:#a6e22e">payload</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Bind request body to &#34;p&#34; depending on the content-type that client sends the data,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// e.g. JSON, XML, YAML, MessagePack, Protobuf, Form and URL Query.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ReadBody</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">p</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithProblem</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusBadRequest</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">NewProblem</span>().<span style="color:#a6e22e">Title</span>(<span style="color:#e6db74">&#34;Parser issue&#34;</span>).<span style="color:#a6e22e">Detail</span>(<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>()))
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// For the sake of the example, log the received payload.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Application</span>().<span style="color:#a6e22e">Logger</span>().<span style="color:#a6e22e">Infof</span>(<span style="color:#e6db74">&#34;Received: %#+v&#34;</span>, <span style="color:#a6e22e">p</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Send back the payload depending on the accept content type and accept-encoding of the client,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// e.g. JSON, XML and so on.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Negotiate</span>(<span style="color:#a6e22e">p</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">setAllowedResponses</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Indicate that the Server can send JSON, XML, YAML and MessagePack for this request.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Negotiation</span>().<span style="color:#a6e22e">JSON</span>().<span style="color:#a6e22e">XML</span>().<span style="color:#a6e22e">YAML</span>().<span style="color:#a6e22e">MsgPack</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Add more, allowed by the server format of responses, mime types here...
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// If client is missing an &#34;Accept: &#34; header then default it to JSON.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Negotiation</span>().<span style="color:#a6e22e">Accept</span>.<span style="color:#a6e22e">JSON</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Next</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>(adsbygoogle = window.adsbygoogle || []).push({});</p>
<h3 id="http2-æœåŠ¡å™¨æ¨é€httpswwwiris-gocomdocsidhttp2-server-push"><a href="https://www.iris-go.com/docs/#/?id=http2-server-push">HTTP2 æœåŠ¡å™¨æ¨é€</a><a hidden class="anchor" aria-hidden="true" href="#http2-æœåŠ¡å™¨æ¨é€httpswwwiris-gocomdocsidhttp2-server-push">#</a></h3>
<p>å®Œæ•´çš„ç¤ºä¾‹ä»£ç å¯ä»¥åœ¨ <a href="https://github.com/kataras/iris/tree/master/_examples/response-writer/http2push">_examples/response-writer/http2push</a> ä¸­æ‰¾åˆ°ã€‚</p>
<p>æœåŠ¡å™¨æ¨é€è®©æœåŠ¡å™¨æŠ¢å…ˆâ€œæ¨é€â€ç½‘ç«™èµ„äº§ åˆ°å®¢æˆ·ç«¯ï¼Œè€Œæ— éœ€ç”¨æˆ·æ˜ç¡®è¯·æ±‚å®ƒä»¬ã€‚ è°¨æ…ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘é€æˆ‘ä»¬çŸ¥é“ç”¨æˆ·è¦å»çš„å†…å®¹ éœ€è¦ä»–ä»¬è¯·æ±‚çš„é¡µé¢ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;net/http&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">pushHandler</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/main.js&#34;</span>, <span style="color:#a6e22e">simpleAssetHandler</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Run</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">TLS</span>(<span style="color:#e6db74">&#34;127.0.0.1:443&#34;</span>, <span style="color:#e6db74">&#34;mycert.crt&#34;</span>, <span style="color:#e6db74">&#34;mykey.key&#34;</span>))
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// $ openssl req -new -newkey rsa:4096 -x509 -sha256 \
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// -days 365 -nodes -out mycert.crt -keyout mykey.key
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">pushHandler</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// The target must either be an absolute path (like &#34;/path&#34;) or an absolute
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// URL that contains a valid host and the same scheme as the parent request.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// If the target is a path, it will inherit the scheme and host of the
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// parent request.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">target</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;/main.js&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">pusher</span>, <span style="color:#a6e22e">ok</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ResponseWriter</span>().<span style="color:#a6e22e">Naive</span>().(<span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">Pusher</span>); <span style="color:#a6e22e">ok</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">pusher</span>.<span style="color:#a6e22e">Push</span>(<span style="color:#a6e22e">target</span>, <span style="color:#66d9ef">nil</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">ErrPushNotSupported</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithText</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusHTTPVersionNotSupported</span>, <span style="color:#e6db74">&#34;HTTP/2 push not supported.&#34;</span>)
</span></span><span style="display:flex;"><span>            } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithError</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusInternalServerError</span>, <span style="color:#a6e22e">err</span>)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">HTML</span>(<span style="color:#e6db74">`&lt;html&gt;&lt;body&gt;&lt;script src=&#34;%s&#34;&gt;&lt;/script&gt;&lt;/body&gt;&lt;/html&gt;`</span>, <span style="color:#a6e22e">target</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">simpleAssetHandler</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">ServeFile</span>(<span style="color:#e6db74">&#34;./public/main.js&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="è®¾ç½®å¹¶è·å–é¥¼å¹²httpswwwiris-gocomdocsidset-and-get-a-cookie"><a href="https://www.iris-go.com/docs/#/?id=set-and-get-a-cookie">è®¾ç½®å¹¶è·å–é¥¼å¹²</a><a hidden class="anchor" aria-hidden="true" href="#è®¾ç½®å¹¶è·å–é¥¼å¹²httpswwwiris-gocomdocsidset-and-get-a-cookie">#</a></h3>
<p>å®‰å…¨ Cookieã€ç¼–ç å’Œè§£ç ã€ä¼šè¯ï¼ˆå’Œä¼šè¯ç¼©æ”¾ï¼‰ã€é—ªå­˜æ¶ˆæ¯ç­‰å¯ä»¥åœ¨ _examples/cookie å’Œ <a href="https://github.com/kataras/iris/tree/master/_examples/sessions">_examples/ä¼šè¯</a>ç›®å½•ä¸­æ‰¾åˆ°<a href="https://github.com/kataras/iris/tree/master/_examples/cookies"></a>ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>import &#34;github.com/kataras/iris/v12&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>func main() {
</span></span><span style="display:flex;"><span>    app := iris.Default()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Get(&#34;/cookie&#34;, func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>        value := ctx.GetCookie(&#34;my_cookie&#34;)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        if value == &#34;&#34; {
</span></span><span style="display:flex;"><span>            value = &#34;NotSet&#34;
</span></span><span style="display:flex;"><span>            ctx.SetCookieKV(&#34;my_cookie&#34;, value)
</span></span><span style="display:flex;"><span>            // Alternatively: ctx.SetCookie(&amp;http.Cookie{...})
</span></span><span style="display:flex;"><span>            ctx.SetCookie(&#34;&#34;, &#34;test&#34;, 3600, &#34;/&#34;, &#34;localhost&#34;, false, true)
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        ctx.Writef(&#34;Cookie value: %s \n&#34;, cookie)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    app.Listen(&#34;:8080&#34;)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>å¦‚æœè¦è®¾ç½®è‡ªå®šä¹‰è·¯å¾„ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ctx.SetCookieKV(name, value, iris.CookiePath(&#34;/custom/path/cookie/will/be/stored&#34;))
</span></span></code></pre></div><p>å¦‚æœå¸Œæœ›ä»…å¯¹å½“å‰è¯·æ±‚è·¯å¾„å¯è§ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ctx.SetCookieKV(name, value, iris.CookieCleanPath /* or iris.CookiePath(&#34;&#34;) */)
</span></span></code></pre></div><p>æ›´å¤šï¼š</p>
<ul>
<li><code>iris.CookieAllowReclaim</code></li>
<li><code>iris.CookieAllowSubdomains</code></li>
<li><code>iris.CookieSecure</code></li>
<li><code>iris.CookieHTTPOnly</code></li>
<li><code>iris.CookieSameSite</code></li>
<li><code>iris.CookiePath</code></li>
<li><code>iris.CookieCleanPath</code></li>
<li><code>iris.CookieExpires</code></li>
<li><code>iris.CookieEncoding</code></li>
</ul>
<p>æ‚¨ä¹Ÿå¯ä»¥åœ¨ä¸­é—´ä»¶ä¸­ä¸ºæ•´ä¸ªè¯·æ±‚æ·»åŠ  cookie é€‰é¡¹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func setCookieOptions(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    ctx.AddCookieOptions(iris.CookieHTTPOnly(true), iris.CookieExpires(1*time.Hour))
</span></span><span style="display:flex;"><span>    ctx.Next()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="json-ç½‘ç»œä»¤ç‰Œhttpswwwiris-gocomdocsidjson-web-tokens"><a href="https://www.iris-go.com/docs/#/?id=json-web-tokens">JSON ç½‘ç»œä»¤ç‰Œ</a><a hidden class="anchor" aria-hidden="true" href="#json-ç½‘ç»œä»¤ç‰Œhttpswwwiris-gocomdocsidjson-web-tokens">#</a></h2>
<p>JSON Web ä»¤ç‰Œ ï¼ˆJWTï¼‰ æ˜¯ä¸€ç§å¼€æ”¾æ ‡å‡† ï¼ˆ<a href="https://tools.ietf.org/html/rfc7519">RFC 7519</a>ï¼‰ï¼Œå®ƒå®šä¹‰äº†ä¸€ç§ç´§å‡‘ä¸”ç‹¬ç«‹çš„æ–¹å¼ï¼Œç”¨äºåœ¨å„æ–¹ä¹‹é—´ä»¥ JSON å¯¹è±¡çš„å½¢å¼å®‰å…¨åœ°ä¼ è¾“ä¿¡æ¯ã€‚æ­¤ä¿¡æ¯å¯ä»¥éªŒè¯å’Œä¿¡ä»»ï¼Œå› ä¸ºå®ƒæ˜¯ç»è¿‡æ•°å­—ç­¾åçš„ã€‚JWT å¯ä»¥ä½¿ç”¨å¯†é’¥ï¼ˆä½¿ç”¨ HMAC ç®—æ³•ï¼‰æˆ–ä½¿ç”¨ RSA æˆ– ECDSA çš„å…¬é’¥/ç§é’¥å¯¹è¿›è¡Œç­¾åã€‚</p>
<h3 id="ä½•æ—¶åº”ä½¿ç”¨-json-web-ä»¤ç‰Œhttpswwwiris-gocomdocsidwhen-should-you-use-json-web-tokens"><a href="https://www.iris-go.com/docs/#/?id=when-should-you-use-json-web-tokens">ä½•æ—¶åº”ä½¿ç”¨ JSON Web ä»¤ç‰Œï¼Ÿ</a><a hidden class="anchor" aria-hidden="true" href="#ä½•æ—¶åº”ä½¿ç”¨-json-web-ä»¤ç‰Œhttpswwwiris-gocomdocsidwhen-should-you-use-json-web-tokens">#</a></h3>
<p>ä»¥ä¸‹æ˜¯ JSON Web ä»¤ç‰Œæœ‰ç”¨çš„ä¸€äº›æ–¹æ¡ˆï¼š</p>
<p><strong>æˆæƒ</strong>ï¼šè¿™æ˜¯ä½¿ç”¨ JWT çš„æœ€å¸¸è§æ–¹æ¡ˆã€‚ç”¨æˆ·ç™»å½•åï¼Œæ¯ä¸ªåç»­è¯·æ±‚éƒ½å°†åŒ…å« JWTï¼Œå…è®¸ç”¨æˆ·è®¿é—®ä½¿ç”¨è¯¥ä»¤ç‰Œå…è®¸çš„è·¯ç”±ã€æœåŠ¡å’Œèµ„æºã€‚å•ç‚¹ç™»å½•æ˜¯å½“ä»Šå¹¿æ³›ä½¿ç”¨ JWT çš„ä¸€é¡¹åŠŸèƒ½ï¼Œå› ä¸ºå®ƒçš„å¼€é”€å¾ˆå°ï¼Œå¹¶ä¸”èƒ½å¤Ÿè·¨ä¸åŒåŸŸè½»æ¾ä½¿ç”¨ã€‚</p>
<p><strong>ä¿¡æ¯äº¤æ¢</strong>ï¼šJSON Web ä»¤ç‰Œæ˜¯åœ¨å„æ–¹ä¹‹é—´å®‰å…¨ä¼ è¾“ä¿¡æ¯çš„å¥½æ–¹æ³•ã€‚ç”±äº JWT å¯ä»¥ç­¾åï¼ˆä¾‹å¦‚ï¼Œä½¿ç”¨å…¬é’¥/ç§é’¥å¯¹ï¼‰ï¼Œå› æ­¤æ‚¨å¯ä»¥ç¡®å®šå‘ä»¶äººæ˜¯ä»–ä»¬æ‰€è¯´çš„äººã€‚æ­¤å¤–ï¼Œç”±äºç­¾åæ˜¯ä½¿ç”¨æ ‡å¤´å’Œæœ‰æ•ˆè´Ÿè½½è®¡ç®—çš„ï¼Œå› æ­¤æ‚¨è¿˜å¯ä»¥éªŒè¯å†…å®¹æ˜¯å¦æœªè¢«ç¯¡æ”¹ã€‚</p>
<blockquote>
<p>é˜…è¯»æ›´å¤šå…³äºæ™ºå¨æ±¤é€Šçš„ä¿¡æ¯ï¼š <a href="https://jwt.io/introduction/">https://jwt.io/introduction/</a></p>
</blockquote>
<h3 id="å°†-jwt-ä¸è™¹è†œé…åˆä½¿ç”¨httpswwwiris-gocomdocsidusing-jwt-with-iris"><a href="https://www.iris-go.com/docs/#/?id=using-jwt-with-iris">å°† JWT ä¸è™¹è†œé…åˆä½¿ç”¨</a><a hidden class="anchor" aria-hidden="true" href="#å°†-jwt-ä¸è™¹è†œé…åˆä½¿ç”¨httpswwwiris-gocomdocsidusing-jwt-with-iris">#</a></h3>
<p>Iris JWT <a href="https://github.com/kataras/iris/tree/master/middleware/jwt">ä¸­é—´ä»¶</a>åœ¨è®¾è®¡æ—¶è€ƒè™‘äº†å®‰å…¨æ€§ã€æ€§èƒ½å’Œç®€å•æ€§ï¼Œå®ƒå¯ä»¥ä¿æŠ¤æ‚¨çš„ä»¤ç‰Œå…å—<a href="https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/">æ‚¨å¯èƒ½åœ¨å…¶ä»–åº“ä¸­å‘ç°çš„å…³é”®æ¼æ´</a>çš„å½±å“ã€‚å®ƒåŸºäº<a href="https://github.com/kataras/jwt">kataras/jwt</a>åŒ…ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;time&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12/middleware/jwt&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">sigKey</span> = []byte(<span style="color:#e6db74">&#34;signature_hmac_secret_shared_key&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">encKey</span> = []byte(<span style="color:#e6db74">&#34;GCM_AES_256_secret_shared_key_32&#34;</span>)
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">fooClaims</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Foo</span> <span style="color:#66d9ef">string</span> <span style="color:#e6db74">`json:&#34;foo&#34;`</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">signer</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">NewSigner</span>(<span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">HS256</span>, <span style="color:#a6e22e">sigKey</span>, <span style="color:#ae81ff">10</span><span style="color:#f92672">*</span><span style="color:#a6e22e">time</span>.<span style="color:#a6e22e">Minute</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Enable payload encryption with:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// signer.WithEncryption(encKey, nil)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">generateToken</span>(<span style="color:#a6e22e">signer</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">verifier</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">NewVerifier</span>(<span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">HS256</span>, <span style="color:#a6e22e">sigKey</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Enable server-side token block feature (even before its expiration time):
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">verifier</span>.<span style="color:#a6e22e">WithDefaultBlocklist</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Enable payload decryption with:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// verifier.WithDecryption(encKey, nil)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">verifyMiddleware</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">verifier</span>.<span style="color:#a6e22e">Verify</span>(<span style="color:#66d9ef">func</span>() <span style="color:#66d9ef">interface</span>{} {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> new(<span style="color:#a6e22e">fooClaims</span>)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">protectedAPI</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Party</span>(<span style="color:#e6db74">&#34;/protected&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Register the verify middleware to allow access only to authorized clients.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">protectedAPI</span>.<span style="color:#a6e22e">Use</span>(<span style="color:#a6e22e">verifyMiddleware</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ^ or UseRouter(verifyMiddleware) to disallow unauthorized http error handlers too.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">protectedAPI</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">protected</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Invalidate the token through server-side, even if it&#39;s not expired yet.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">protectedAPI</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/logout&#34;</span>, <span style="color:#a6e22e">logout</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// http://localhost:8080
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// http://localhost:8080/protected?token=$token (or Authorization: Bearer $token)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// http://localhost:8080/protected/logout?token=$token
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// http://localhost:8080/protected?token=$token (401)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">generateToken</span>(<span style="color:#a6e22e">signer</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">Signer</span>) <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Handler</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">claims</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fooClaims</span>{<span style="color:#a6e22e">Foo</span>: <span style="color:#e6db74">&#34;bar&#34;</span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">token</span>, <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">signer</span>.<span style="color:#a6e22e">Sign</span>(<span style="color:#a6e22e">claims</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">StopWithStatus</span>(<span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">StatusInternalServerError</span>)
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Write</span>(<span style="color:#a6e22e">token</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">protected</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Get the verified and decoded claims.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">claims</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#a6e22e">ctx</span>).(<span style="color:#f92672">*</span><span style="color:#a6e22e">fooClaims</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Optionally, get token information if you want to work with them.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// Just an example on how you can retrieve all the standard claims (set by signer&#39;s max age, &#34;exp&#34;).
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">standardClaims</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">jwt</span>.<span style="color:#a6e22e">GetVerifiedToken</span>(<span style="color:#a6e22e">ctx</span>).<span style="color:#a6e22e">StandardClaims</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">expiresAtString</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">standardClaims</span>.<span style="color:#a6e22e">ExpiresAt</span>().<span style="color:#a6e22e">Format</span>(<span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Application</span>().<span style="color:#a6e22e">ConfigurationReadOnly</span>().<span style="color:#a6e22e">GetTimeFormat</span>())
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">timeLeft</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">standardClaims</span>.<span style="color:#a6e22e">Timeleft</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Writef</span>(<span style="color:#e6db74">&#34;foo=%s\nexpires at: %s\ntime left: %s\n&#34;</span>, <span style="color:#a6e22e">claims</span>.<span style="color:#a6e22e">Foo</span>, <span style="color:#a6e22e">expiresAtString</span>, <span style="color:#a6e22e">timeLeft</span>)
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">logout</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Logout</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">WriteString</span>(<span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>())
</span></span><span style="display:flex;"><span>    } <span style="color:#66d9ef">else</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Writef</span>(<span style="color:#e6db74">&#34;token invalidated, a new token is required to access the protected API&#34;</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p>æœ‰å…³åˆ·æ–°ä»¤ç‰Œã€é˜»æ­¢åˆ—è¡¨ç­‰çš„ä¿¡æ¯ï¼Œè¯·è®¿é—®ï¼š<a href="https://github.com/kataras/iris/tree/master/_examples/auth/jwt">_examples/auth/jwt</a>ã€‚</p>
</blockquote>
<h2 id="æµ‹è¯•httpswwwiris-gocomdocsidtesting"><a href="https://www.iris-go.com/docs/#/?id=testing">æµ‹è¯•</a><a hidden class="anchor" aria-hidden="true" href="#æµ‹è¯•httpswwwiris-gocomdocsidtesting">#</a></h2>
<p>Irisä¸ºhttpexpectæä¾›äº†ä»¤äººéš¾ä»¥ç½®ä¿¡çš„æ”¯æŒï¼Œ<a href="https://github.com/gavv/httpexpect">httpexpect</a>æ˜¯Webåº”ç”¨ç¨‹åºçš„æµ‹è¯•æ¡†æ¶ã€‚å­åŒ…ä¸º Iris + httpexpect æä¾›äº†å¸®åŠ©ç¨‹åºã€‚<code>iris/httptest</code></p>
<p>å¦‚æœä½ æ›´å–œæ¬¢Goçš„æ ‡å‡†<a href="https://pkg.go.dev/net/http/httptest">net/http/httptest</a>åŒ…ï¼Œä½ ä»ç„¶å¯ä»¥ä½¿ç”¨å®ƒã€‚Irisä¸æ¯ä¸ªhttp Webæ¡†æ¶éƒ½ä¸ä»»ä½•ç”¨äºæµ‹è¯•çš„å¤–éƒ¨å·¥å…·å…¼å®¹ï¼Œæœ€åå®ƒæ˜¯HTTPã€‚</p>
<h3 id="æµ‹è¯•åŸºæœ¬èº«ä»½éªŒè¯httpswwwiris-gocomdocsidtesting-basic-authentication"><a href="https://www.iris-go.com/docs/#/?id=testing-basic-authentication">æµ‹è¯•åŸºæœ¬èº«ä»½éªŒè¯</a><a hidden class="anchor" aria-hidden="true" href="#æµ‹è¯•åŸºæœ¬èº«ä»½éªŒè¯httpswwwiris-gocomdocsidtesting-basic-authentication">#</a></h3>
<p>åœ¨ç¬¬ä¸€ä¸ªç¤ºä¾‹ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å­åŒ…æ¥æµ‹è¯•åŸºæœ¬èº«ä»½éªŒè¯ã€‚<code>iris/httptest</code></p>
<p><strong>1.</strong> æºæ–‡ä»¶å¦‚ä¸‹æ‰€ç¤ºï¼š<code>main.go</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12/middleware/basicauth&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">newApp</span>() <span style="color:#f92672">*</span><span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Application</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">opts</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">basicauth</span>.<span style="color:#a6e22e">Options</span>{
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Allow</span>: <span style="color:#a6e22e">basicauth</span>.<span style="color:#a6e22e">AllowUsers</span>(<span style="color:#66d9ef">map</span>[<span style="color:#66d9ef">string</span>]<span style="color:#66d9ef">string</span>{<span style="color:#e6db74">&#34;myusername&#34;</span>: <span style="color:#e6db74">&#34;mypassword&#34;</span>}),
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">authentication</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">basicauth</span>.<span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">opts</span>) <span style="color:#75715e">// or just: basicauth.Default(map...)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) { <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Redirect</span>(<span style="color:#e6db74">&#34;/admin&#34;</span>) })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// to party
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">needAuth</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Party</span>(<span style="color:#e6db74">&#34;/admin&#34;</span>, <span style="color:#a6e22e">authentication</span>)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">//http://localhost:8080/admin
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">needAuth</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#a6e22e">h</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// http://localhost:8080/admin/profile
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">needAuth</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/profile&#34;</span>, <span style="color:#a6e22e">h</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// http://localhost:8080/admin/settings
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#a6e22e">needAuth</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/settings&#34;</span>, <span style="color:#a6e22e">h</span>)
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">app</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">h</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// username, password, _ := ctx.Request().BasicAuth()
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// third parameter it will be always true because the middleware
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// makes sure for that, otherwise this handler will not be executed.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// OR:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">user</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">User</span>().(<span style="color:#f92672">*</span><span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">SimpleUser</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Writef</span>(<span style="color:#e6db74">&#34;%s %s:%s&#34;</span>, <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Path</span>(), <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">Username</span>, <span style="color:#a6e22e">user</span>.<span style="color:#a6e22e">Password</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// ctx.Writef(&#34;%s %s:%s&#34;, ctx.Path(), username, password)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">newApp</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>)
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>**2.**ç°åœ¨ï¼Œåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¹¶å¤åˆ¶ç²˜è´´ä»¥ä¸‹å†…å®¹ã€‚<code>main_test.go</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;testing&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12/httptest&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestNewApp</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">newApp</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">e</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">t</span>, <span style="color:#a6e22e">app</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// redirects to /admin without basic auth
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/&#34;</span>).<span style="color:#a6e22e">Expect</span>().<span style="color:#a6e22e">Status</span>(<span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">StatusUnauthorized</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// without basic auth
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/admin&#34;</span>).<span style="color:#a6e22e">Expect</span>().<span style="color:#a6e22e">Status</span>(<span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">StatusUnauthorized</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// with valid basic auth
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/admin&#34;</span>).<span style="color:#a6e22e">WithBasicAuth</span>(<span style="color:#e6db74">&#34;myusername&#34;</span>, <span style="color:#e6db74">&#34;mypassword&#34;</span>).<span style="color:#a6e22e">Expect</span>().
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Status</span>(<span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">StatusOK</span>).<span style="color:#a6e22e">Body</span>().<span style="color:#a6e22e">Equal</span>(<span style="color:#e6db74">&#34;/admin myusername:mypassword&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/admin/profile&#34;</span>).<span style="color:#a6e22e">WithBasicAuth</span>(<span style="color:#e6db74">&#34;myusername&#34;</span>, <span style="color:#e6db74">&#34;mypassword&#34;</span>).<span style="color:#a6e22e">Expect</span>().
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Status</span>(<span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">StatusOK</span>).<span style="color:#a6e22e">Body</span>().<span style="color:#a6e22e">Equal</span>(<span style="color:#e6db74">&#34;/admin/profile myusername:mypassword&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/admin/settings&#34;</span>).<span style="color:#a6e22e">WithBasicAuth</span>(<span style="color:#e6db74">&#34;myusername&#34;</span>, <span style="color:#e6db74">&#34;mypassword&#34;</span>).<span style="color:#a6e22e">Expect</span>().
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Status</span>(<span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">StatusOK</span>).<span style="color:#a6e22e">Body</span>().<span style="color:#a6e22e">Equal</span>(<span style="color:#e6db74">&#34;/admin/settings myusername:mypassword&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// with invalid basic auth
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#e6db74">&#34;/admin/settings&#34;</span>).<span style="color:#a6e22e">WithBasicAuth</span>(<span style="color:#e6db74">&#34;invalidusername&#34;</span>, <span style="color:#e6db74">&#34;invalidpassword&#34;</span>).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Expect</span>().<span style="color:#a6e22e">Status</span>(<span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">StatusUnauthorized</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>3.</strong> æ‰“å¼€å‘½ä»¤è¡Œå¹¶æ‰§è¡Œï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ go test -v
</span></span></code></pre></div><h3 id="æµ‹è¯•é¥¼å¹²httpswwwiris-gocomdocsidtesting-cookies"><a href="https://www.iris-go.com/docs/#/?id=testing-cookies">æµ‹è¯•é¥¼å¹²</a><a hidden class="anchor" aria-hidden="true" href="#æµ‹è¯•é¥¼å¹²httpswwwiris-gocomdocsidtesting-cookies">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;fmt&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;testing&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12/httptest&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">TestCookiesBasic</span>(<span style="color:#a6e22e">t</span> <span style="color:#f92672">*</span><span style="color:#a6e22e">testing</span>.<span style="color:#a6e22e">T</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">newApp</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">e</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">New</span>(<span style="color:#a6e22e">t</span>, <span style="color:#a6e22e">app</span>, <span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">URL</span>(<span style="color:#e6db74">&#34;http://example.com&#34;</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">cookieName</span>, <span style="color:#a6e22e">cookieValue</span> <span style="color:#f92672">:=</span> <span style="color:#e6db74">&#34;my_cookie_name&#34;</span>, <span style="color:#e6db74">&#34;my_cookie_value&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Test Set A Cookie.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">t1</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;/cookies/%s/%s&#34;</span>, <span style="color:#a6e22e">cookieName</span>, <span style="color:#a6e22e">cookieValue</span>)).
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">Expect</span>().<span style="color:#a6e22e">Status</span>(<span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">StatusOK</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Validate cookie&#39;s existence, it should be available now.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">t1</span>.<span style="color:#a6e22e">Cookie</span>(<span style="color:#a6e22e">cookieName</span>).<span style="color:#a6e22e">Value</span>().<span style="color:#a6e22e">Equal</span>(<span style="color:#a6e22e">cookieValue</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t1</span>.<span style="color:#a6e22e">Body</span>().<span style="color:#a6e22e">Contains</span>(<span style="color:#a6e22e">cookieValue</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">path</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">fmt</span>.<span style="color:#a6e22e">Sprintf</span>(<span style="color:#e6db74">&#34;/cookies/%s&#34;</span>, <span style="color:#a6e22e">cookieName</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Test Retrieve A Cookie.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">t2</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#a6e22e">path</span>).<span style="color:#a6e22e">Expect</span>().<span style="color:#a6e22e">Status</span>(<span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">StatusOK</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t2</span>.<span style="color:#a6e22e">Body</span>().<span style="color:#a6e22e">Equal</span>(<span style="color:#a6e22e">cookieValue</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Test Remove A Cookie.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">t3</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">DELETE</span>(<span style="color:#a6e22e">path</span>).<span style="color:#a6e22e">Expect</span>().<span style="color:#a6e22e">Status</span>(<span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">StatusOK</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t3</span>.<span style="color:#a6e22e">Body</span>().<span style="color:#a6e22e">Contains</span>(<span style="color:#a6e22e">cookieName</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t4</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">e</span>.<span style="color:#a6e22e">GET</span>(<span style="color:#a6e22e">path</span>).<span style="color:#a6e22e">Expect</span>().<span style="color:#a6e22e">Status</span>(<span style="color:#a6e22e">httptest</span>.<span style="color:#a6e22e">StatusOK</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t4</span>.<span style="color:#a6e22e">Cookies</span>().<span style="color:#a6e22e">Empty</span>()
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">t4</span>.<span style="color:#a6e22e">Body</span>().<span style="color:#a6e22e">Empty</span>()
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>$ go test -v -run=TestCookiesBasic$
</span></span></code></pre></div><p>Iris Web æ¡†æ¶æœ¬èº«ä½¿ç”¨æ­¤åŒ…æ¥æµ‹è¯•è‡ªèº«ã€‚åœ¨<a href="https://github.com/kataras/iris/tree/master/_examples">_exampleså­˜å‚¨åº“ç›®å½•ä¸­</a>ï¼Œæ‚¨è¿˜å¯ä»¥æ‰¾åˆ°ä¸€äº›æœ‰ç”¨çš„æµ‹è¯•ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·æŸ¥çœ‹å¹¶é˜…è¯» <a href="https://github.com/gavv/httpexpect">httpexpect çš„æ–‡æ¡£</a>ã€‚</p>
<h2 id="åœ°æ–¹åŒ–httpswwwiris-gocomdocsidlocalization"><a href="https://www.iris-go.com/docs/#/?id=localization">åœ°æ–¹åŒ–</a><a hidden class="anchor" aria-hidden="true" href="#åœ°æ–¹åŒ–httpswwwiris-gocomdocsidlocalization">#</a></h2>
<h3 id="ä»‹ç»httpswwwiris-gocomdocsidintroduction"><a href="https://www.iris-go.com/docs/#/?id=introduction">ä»‹ç»</a><a hidden class="anchor" aria-hidden="true" href="#ä»‹ç»httpswwwiris-gocomdocsidintroduction">#</a></h3>
<p>æœ¬åœ°åŒ–åŠŸèƒ½æä¾›äº†ä¸€ç§æ£€ç´¢å„ç§è¯­è¨€å­—ç¬¦ä¸²çš„ä¾¿æ·æ–¹æ³•ï¼Œä½¿æ‚¨å¯ä»¥åœ¨åº”ç”¨ç¨‹åºä¸­è½»æ¾æ”¯æŒå¤šç§è¯­è¨€ã€‚è¯­è¨€å­—ç¬¦ä¸²å­˜å‚¨åœ¨ç›®å½•ä¸­çš„æ–‡ä»¶ä¸­ã€‚åœ¨æ­¤ç›®å½•ä¸­ï¼Œåº”ç”¨ç¨‹åºæ”¯æŒçš„æ¯ç§è¯­è¨€éƒ½åº”è¯¥æœ‰ä¸€ä¸ªå­ç›®å½•ï¼š<code>./locales</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>â”‚   main.go
</span></span><span style="display:flex;"><span>â””â”€â”€â”€locales
</span></span><span style="display:flex;"><span>    â”œâ”€â”€â”€el-GR
</span></span><span style="display:flex;"><span>    â”‚       home.yml
</span></span><span style="display:flex;"><span>    â”œâ”€â”€â”€en-US
</span></span><span style="display:flex;"><span>    â”‚       home.yml
</span></span><span style="display:flex;"><span>    â””â”€â”€â”€zh-CN
</span></span><span style="display:flex;"><span>            home.yml
</span></span></code></pre></div><p>åº”ç”¨ç¨‹åºçš„é»˜è®¤è¯­è¨€æ˜¯ç¬¬ä¸€ä¸ªæ³¨å†Œè¯­è¨€ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>app := iris.New()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>// First parameter: Glob filpath patern,
</span></span><span style="display:flex;"><span>// Second variadic parameter: Optional language tags,
</span></span><span style="display:flex;"><span>// the first one is the default/fallback one.
</span></span><span style="display:flex;"><span>app.I18n.Load(&#34;./locales/*/*&#34;, &#34;en-US&#34;, &#34;el-GR&#34;, &#34;zh-CN&#34;)
</span></span></code></pre></div><p>æˆ–è€…ï¼Œå¦‚æœæ‚¨é€šè¿‡ä»¥ä¸‹æ–¹å¼åŠ è½½æ‰€æœ‰è¯­è¨€ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>app.I18n.Load(&#34;./locales/*/*&#34;)
</span></span><span style="display:flex;"><span>// Then set the default language using:
</span></span><span style="display:flex;"><span>app.I18n.SetDefault(&#34;en-US&#34;)
</span></span></code></pre></div><h3 id="åŠ è½½åµŒå…¥å¼åŒºåŸŸè®¾ç½®httpswwwiris-gocomdocsidload-embedded-locales"><a href="https://www.iris-go.com/docs/#/?id=load-embedded-locales">åŠ è½½åµŒå…¥å¼åŒºåŸŸè®¾ç½®</a><a hidden class="anchor" aria-hidden="true" href="#åŠ è½½åµŒå…¥å¼åŒºåŸŸè®¾ç½®httpswwwiris-gocomdocsidload-embedded-locales">#</a></h3>
<p>æ‚¨å¯èƒ½å¸Œæœ›åœ¨åº”ç”¨ç¨‹åºå¯æ‰§è¡Œæ–‡ä»¶ä¸­ä½¿ç”¨æ–°çš„åµŒå…¥<a href="https://gobyexample.com/embed-directive">æŒ‡ä»¤åµŒå…¥</a>åŒºåŸŸè®¾ç½®ã€‚</p>
<ol>
<li>å¯¼å…¥åµŒå…¥åŒ…;å¦‚æœæ‚¨ä¸ä½¿ç”¨æ­¤åŒ…ä¸­çš„ä»»ä½•å¯¼å‡ºæ ‡è¯†ç¬¦ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ _ â€œembedâ€ è¿›è¡Œç©ºç™½å¯¼å…¥ã€‚</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>import (
</span></span><span style="display:flex;"><span>    &#34;embed&#34;
</span></span><span style="display:flex;"><span>)
</span></span></code></pre></div><ol start="2">
<li>åµŒå…¥æŒ‡ä»¤æ¥å—ç›¸å¯¹äºåŒ…å« Go æºæ–‡ä»¶çš„ç›®å½•çš„è·¯å¾„ã€‚æˆ‘ä»¬å¯ä»¥åµŒå…¥å¤šä¸ªæ–‡ä»¶ï¼Œç”šè‡³æ˜¯å¸¦æœ‰é€šé…ç¬¦çš„æ–‡ä»¶å¤¹ã€‚è¿™ä½¿ç”¨åµŒå…¥çš„å˜é‡ã€‚FS ç±»å‹ï¼Œå®ƒå®ç°ä¸€ä¸ªç®€å•çš„è™šæ‹Ÿæ–‡ä»¶ç³»ç»Ÿã€‚</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>//go:embed embedded/locales/*
</span></span><span style="display:flex;"><span>var embeddedFS embed.FS
</span></span></code></pre></div><ol start="3">
<li>æˆ‘ä»¬åº”è¯¥ä½¿ç”¨æ–¹æ³•è€Œä¸æ˜¯æ–¹æ³•ã€‚<code>Load``LoadFS</code></li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>err := app.I18n.LoadFS(embeddedFS, &#34;./embedded/locales/*/*.ini&#34;, &#34;en-US&#34;, &#34;el-GR&#34;)
</span></span><span style="display:flex;"><span>// OR to load all languages by filename:
</span></span><span style="display:flex;"><span>// app.I18n.LoadFS(embeddedFS, &#34;./embedded/locales/*/*.ini&#34;)
</span></span><span style="display:flex;"><span>// Then set the default language using:
</span></span><span style="display:flex;"><span>// app.I18n.SetDefault(&#34;en-US&#34;)
</span></span></code></pre></div><h3 id="å®šä¹‰ç¿»è¯‘httpswwwiris-gocomdocsiddefining-translations"><a href="https://www.iris-go.com/docs/#/?id=defining-translations">å®šä¹‰ç¿»è¯‘</a><a hidden class="anchor" aria-hidden="true" href="#å®šä¹‰ç¿»è¯‘httpswwwiris-gocomdocsiddefining-translations">#</a></h3>
<p>è¯­è¨€ç¯å¢ƒæ–‡ä»¶å¯ä»¥ä»¥ YAMLï¼ˆæ¨èï¼‰ã€JSONã€TOML æˆ– INI å½¢å¼ç¼–å†™ã€‚</p>
<p>æ¯ä¸ªæ–‡ä»¶éƒ½åº”åŒ…å«å¯†é’¥ã€‚é”®ä¹Ÿå¯ä»¥æœ‰å­é”®ï¼ˆæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œéƒ¨åˆ†â€ï¼‰ã€‚</p>
<p>æ¯ä¸ªé”®çš„å€¼åº”å…·æœ‰å½¢å¼æˆ–åŒ…å«å…¶ç¿»è¯‘æ–‡æœ¬ï¼ˆæˆ–<strong>æ¨¡æ¿</strong>ï¼‰æˆ–/åŠå…¶å¤æ•°é”®å€¼ã€‚<code>string``map</code></p>
<p>Iris i18næ¨¡å—æ”¯æŒå¼€ç®±å³ç”¨çš„<strong>å¤æ•°</strong>ï¼Œè§ä¸‹æ–‡ã€‚</p>
<h3 id="fmt-é£æ ¼httpswwwiris-gocomdocsidfmt-style"><a href="https://www.iris-go.com/docs/#/?id=fmt-style">FMT é£æ ¼</a><a hidden class="anchor" aria-hidden="true" href="#fmt-é£æ ¼httpswwwiris-gocomdocsidfmt-style">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>hi: &#34;Hi %s!&#34;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ctx.Tr(&#34;Hi&#34;, &#34;John&#34;)
</span></span><span style="display:flex;"><span>// Outputs: Hi John!
</span></span></code></pre></div><h3 id="æ¨¡æ¿httpswwwiris-gocomdocsidtemplate"><a href="https://www.iris-go.com/docs/#/?id=template">æ¨¡æ¿</a><a hidden class="anchor" aria-hidden="true" href="#æ¨¡æ¿httpswwwiris-gocomdocsidtemplate">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>hi: &#34;Hi {{.Name}}!&#34;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ctx.Tr(&#34;Hi&#34;, iris.Map{&#34;Name&#34;: &#34;John&#34;})
</span></span><span style="display:flex;"><span>// Outputs: Hi John!
</span></span></code></pre></div><h3 id="å¤šå…ƒåŒ–httpswwwiris-gocomdocsidpluralization"><a href="https://www.iris-go.com/docs/#/?id=pluralization">å¤šå…ƒåŒ–</a><a hidden class="anchor" aria-hidden="true" href="#å¤šå…ƒåŒ–httpswwwiris-gocomdocsidpluralization">#</a></h3>
<p>Iris i18n æ”¯æŒå¤æ•°å˜é‡ã€‚è¦å®šä¹‰æ¯ä¸ªåŒºåŸŸè®¾ç½®å˜é‡ï¼Œæ‚¨å¿…é¡» å®šä¹‰é”®çš„æ–°éƒ¨åˆ†ã€‚<code>Vars</code></p>
<p>å˜é‡å¯æ¥å—çš„é”®ä¸ºï¼š</p>
<ul>
<li><code>one</code></li>
<li><code>&quot;=x&quot;</code>å…¶ä¸­ x æ˜¯ä¸€ä¸ªæ•°å­—</li>
<li><code>&quot;&lt;x&quot;</code></li>
<li><code>other</code></li>
<li><code>format</code></li>
</ul>
<p>ä¾‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Vars:
</span></span><span style="display:flex;"><span>  - Minutes:
</span></span><span style="display:flex;"><span>      one: &#34;minute&#34;
</span></span><span style="display:flex;"><span>      other: &#34;minutes&#34;
</span></span><span style="display:flex;"><span>  - Houses:
</span></span><span style="display:flex;"><span>      one: &#34;house&#34;
</span></span><span style="display:flex;"><span>      other: &#34;houses&#34;
</span></span></code></pre></div><p>ç„¶åï¼Œæ¯æ¡æ¶ˆæ¯éƒ½å¯ä»¥ä½¿ç”¨æ­¤å˜é‡ï¼Œæ–¹æ³•å¦‚ä¸‹ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span># Using variables in raw string
</span></span><span style="display:flex;"><span>YouLate: &#34;You are %[1]d ${Minutes} late.&#34;
</span></span><span style="display:flex;"><span># [x] is the argument position,
</span></span><span style="display:flex;"><span># variables always have priority other fmt-style arguments,
</span></span><span style="display:flex;"><span># that&#39;s why we see [1] for houses and [2] for the string argument.
</span></span><span style="display:flex;"><span>HouseCount: &#34;%[2]s has %[1]d ${Houses}.&#34;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ctx.Tr(&#34;YouLate&#34;, 1)
</span></span><span style="display:flex;"><span>// Outputs: You are 1 minute late.
</span></span><span style="display:flex;"><span>ctx.Tr(&#34;YouLate&#34;, 10)
</span></span><span style="display:flex;"><span>// Outputs: You are 10 minutes late.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ctx.Tr(&#34;HouseCount&#34;, 2, &#34;John&#34;)
</span></span><span style="display:flex;"><span>// Outputs: John has 2 houses.
</span></span></code></pre></div><p>æ‚¨å¯ä»¥æ ¹æ®ç»™å®šçš„å¤æ•°è®¡æ•°é€‰æ‹©å°†æ˜¾ç¤ºçš„æ¶ˆæ¯ã€‚</p>
<p>é™¤äº†å˜é‡ï¼Œæ¯æ¡æ¶ˆæ¯ä¹Ÿå¯ä»¥æœ‰å…¶å¤æ•°å½¢å¼ï¼</p>
<p>å¯æ¥å—çš„å¯†é’¥ï¼š</p>
<ul>
<li><code>zero</code></li>
<li><code>one</code></li>
<li><code>two</code></li>
<li><code>&quot;=x&quot;</code></li>
<li><code>&quot;&lt;x&quot;</code></li>
<li><code>&quot;&gt;x&quot;</code></li>
<li><code>other</code></li>
</ul>
<p>è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„å¤æ•°åŠŸèƒ½æ¶ˆæ¯ï¼Œå®ƒä¹Ÿå¯ä»¥ä½¿ç”¨æˆ‘ä»¬åœ¨ä¸Šé¢åˆ›å»ºçš„ Minutes å˜é‡ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>FreeDay:
</span></span><span style="display:flex;"><span>  &#34;=3&#34;: &#34;You have three days and %[2]d ${Minutes} off.&#34; # &#34;FreeDay&#34; 3, 15
</span></span><span style="display:flex;"><span>  one:  &#34;You have a day off.&#34; # &#34;FreeDay&#34;, 1
</span></span><span style="display:flex;"><span>  other: &#34;You have %[1]d free days.&#34; # &#34;FreeDay&#34;, 5
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ctx.Tr(&#34;FreeDay&#34;, 3, 15)
</span></span><span style="display:flex;"><span>// Outputs: You have three days and 15 minutes off.
</span></span><span style="display:flex;"><span>ctx.Tr(&#34;FreeDay&#34;, 1)
</span></span><span style="display:flex;"><span>// Outputs: You have a day off.
</span></span><span style="display:flex;"><span>ctx.Tr(&#34;FreeDay&#34;, 5)
</span></span><span style="display:flex;"><span>// Outputs: You have 5 free days.
</span></span></code></pre></div><p>è®©æˆ‘ä»¬ç»§ç»­ä½¿ç”¨æ›´é«˜çº§çš„ç¤ºä¾‹ï¼Œä½¿ç”¨æ¨¡æ¿æ–‡æœ¬ + å‡½æ•° + å¤æ•° + å˜é‡ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Vars:
</span></span><span style="display:flex;"><span>  - Houses:
</span></span><span style="display:flex;"><span>      one: &#34;house&#34;
</span></span><span style="display:flex;"><span>      other: &#34;houses&#34;
</span></span><span style="display:flex;"><span>  - Gender:
</span></span><span style="display:flex;"><span>      &#34;=1&#34;: &#34;She&#34;
</span></span><span style="display:flex;"><span>      &#34;=2&#34;: &#34;He&#34;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>VarTemplatePlural:
</span></span><span style="display:flex;"><span>  one: &#34;${Gender} is awesome!&#34;
</span></span><span style="display:flex;"><span>  other: &#34;other (${Gender}) has %[3]d ${Houses}.&#34;
</span></span><span style="display:flex;"><span>  &#34;=5&#34;: &#34;{{call .InlineJoin .Names}} are awesome.&#34;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>const (
</span></span><span style="display:flex;"><span>    female = iota + 1
</span></span><span style="display:flex;"><span>    male
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ctx.Tr(&#34;VarTemplatePlural&#34;, iris.Map{
</span></span><span style="display:flex;"><span>    &#34;PluralCount&#34;: 5,
</span></span><span style="display:flex;"><span>    &#34;Names&#34;:       []string{&#34;John&#34;, &#34;Peter&#34;},
</span></span><span style="display:flex;"><span>    &#34;InlineJoin&#34;: func(arr []string) string {
</span></span><span style="display:flex;"><span>        return strings.Join(arr, &#34;, &#34;)
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>})
</span></span><span style="display:flex;"><span>// Outputs: John, Peter are awesome
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ctx.Tr(&#34;VarTemplatePlural&#34;, 1, female)
</span></span><span style="display:flex;"><span>// Outputs: She is awesome!
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ctx.Tr(&#34;VarTemplatePlural&#34;, 2, female, 5)
</span></span><span style="display:flex;"><span>// Outputs: other (She) has 5 houses.
</span></span></code></pre></div><h3 id="éƒ¨åˆ†httpswwwiris-gocomdocsidsections"><a href="https://www.iris-go.com/docs/#/?id=sections">éƒ¨åˆ†</a><a hidden class="anchor" aria-hidden="true" href="#éƒ¨åˆ†httpswwwiris-gocomdocsidsections">#</a></h3>
<p>å¦‚æœå¯†é’¥ä¸æ˜¯ä¿ç•™å¯†é’¥ï¼ˆä¾‹å¦‚ä¸€ã€äºŒ&hellip;ï¼‰ï¼Œåˆ™å®ƒå……å½“å­éƒ¨åˆ†ã€‚è¿™äº›éƒ¨åˆ†ç”±ç‚¹å­—ç¬¦ ï¼ˆï¼‰ åˆ†éš”ã€‚<code>.</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>Welcome:
</span></span><span style="display:flex;"><span>  Message: &#34;Welcome {{.Name}}&#34;
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>ctx.Tr(&#34;Welcome.Message&#34;, iris.Map{&#34;Name&#34;: &#34;John&#34;})
</span></span><span style="display:flex;"><span>// Outputs: Welcome John
</span></span></code></pre></div><h3 id="ç¡®å®šå½“å‰åŒºåŸŸè®¾ç½®httpswwwiris-gocomdocsiddetermining-the-current-locale"><a href="https://www.iris-go.com/docs/#/?id=determining-the-current-locale">ç¡®å®šå½“å‰åŒºåŸŸè®¾ç½®</a><a hidden class="anchor" aria-hidden="true" href="#ç¡®å®šå½“å‰åŒºåŸŸè®¾ç½®httpswwwiris-gocomdocsiddetermining-the-current-locale">#</a></h3>
<p>æ‚¨å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•ç¡®å®šå½“å‰åŒºåŸŸè®¾ç½®æˆ–æ£€æŸ¥åŒºåŸŸè®¾ç½®æ˜¯å¦ä¸ºç»™å®šå€¼ï¼š<code>context.GetLocale</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    locale := ctx.GetLocale()
</span></span><span style="display:flex;"><span>    // [...]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p><strong>åŒºåŸŸè®¾ç½®</strong>ç•Œé¢å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-mysql" data-lang="mysql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Locale <span style="color:#66d9ef">is</span> the interface which returns <span style="color:#66d9ef">from</span> a <span style="color:#f92672">`</span>Localizer.GetLocale<span style="color:#f92672">`</span> metod.
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> It serves the transltions based <span style="color:#66d9ef">on</span> <span style="color:#e6db74">&#34;key&#34;</span> <span style="color:#66d9ef">or</span> format. See <span style="color:#f92672">`</span>GetMessage<span style="color:#f92672">`</span>.
</span></span><span style="display:flex;"><span>type Locale interface <span style="color:#960050;background-color:#1e0010">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> <span style="color:#66d9ef">Index</span> returns the current locale <span style="color:#66d9ef">index</span> <span style="color:#66d9ef">from</span> the languages list.
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">Index</span>() <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> Tag returns the full language Tag attached tothis Locale,
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> it should be uniue across different Locales.
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Tag</span>() <span style="color:#f92672">*</span>language.Tag
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> Language should <span style="color:#66d9ef">return</span> the exact languagecode of this <span style="color:#f92672">`</span>Locale<span style="color:#f92672">`</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span>that the <span style="color:#66d9ef">user</span> provided <span style="color:#66d9ef">on</span> <span style="color:#f92672">`</span>New<span style="color:#f92672">`</span> function.
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">//</span> Same <span style="color:#66d9ef">as</span> <span style="color:#f92672">`</span><span style="color:#a6e22e">Tag</span>().<span style="color:#a6e22e">String</span>()<span style="color:#f92672">`</span> but it<span style="color:#e6db74">&#39;s static.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    Language() string
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    // GetMessage should return translated text based n the given &#34;key&#34;.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    GetMessage(key string, args ...interface{}) string
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">}
</span></span></span></code></pre></div><h3 id="æ£€ç´¢ç¿»è¯‘httpswwwiris-gocomdocsidretrieving-translation"><a href="https://www.iris-go.com/docs/#/?id=retrieving-translation">æ£€ç´¢ç¿»è¯‘</a><a hidden class="anchor" aria-hidden="true" href="#æ£€ç´¢ç¿»è¯‘httpswwwiris-gocomdocsidretrieving-translation">#</a></h3>
<p>ä½¿ç”¨æ–¹æ³•ä½œä¸ºè·å–æ­¤è¯·æ±‚çš„ç¿»è¯‘æ–‡æœ¬çš„å¿«æ·æ–¹å¼ã€‚<code>context.Tr</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    text := ctx.Tr(&#34;hi&#34;, &#34;name&#34;)
</span></span><span style="display:flex;"><span>    // [...]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="å†…éƒ¨è§†å›¾httpswwwiris-gocomdocsidinside-views"><a href="https://www.iris-go.com/docs/#/?id=inside-views">å†…éƒ¨è§†å›¾</a><a hidden class="anchor" aria-hidden="true" href="#å†…éƒ¨è§†å›¾httpswwwiris-gocomdocsidinside-views">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>func(ctx iris.Context) {
</span></span><span style="display:flex;"><span>    err := ctx.View(&#34;index.html&#34;, iris.Map{
</span></span><span style="display:flex;"><span>        &#34;tr&#34;: ctx.Tr,
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>    if err!=nil {
</span></span><span style="display:flex;"><span>        ctx.HTML(&#34;&lt;h3&gt;%s&lt;/h3&gt;&#34;, err.Error())
</span></span><span style="display:flex;"><span>        return
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="httpswwwiris-gocomdocsidexampleä¾‹httpsgithubcomkatarasiristreemaster_examplesi18n"><a href="https://www.iris-go.com/docs/#/?id=example"></a><a href="https://github.com/kataras/iris/tree/master/_examples/i18n">ä¾‹</a><a hidden class="anchor" aria-hidden="true" href="#httpswwwiris-gocomdocsidexampleä¾‹httpsgithubcomkatarasiristreemaster_examplesi18n">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#f92672">package</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> (
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;github.com/kataras/iris/v12&#34;</span>
</span></span><span style="display:flex;"><span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">newApp</span>() <span style="color:#f92672">*</span><span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Application</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">New</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Configure i18n.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// First parameter: Glob filpath patern,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// Second variadic parameter: Optional language tags, the first one is the default/fallback one.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">I18n</span>.<span style="color:#a6e22e">Load</span>(<span style="color:#e6db74">&#34;./locales/*/*.ini&#34;</span>, <span style="color:#e6db74">&#34;en-US&#34;</span>, <span style="color:#e6db74">&#34;el-GR&#34;</span>, <span style="color:#e6db74">&#34;zh-CN&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// app.I18n.LoadAssets for go-bindata.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// Default values:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// app.I18n.URLParameter = &#34;lang&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// app.I18n.Subdomain = true
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// Set to false to disallow path (local) redirects,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// see https://github.com/kataras/iris/issues/1369.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// app.I18n.PathRedirect = true
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">hi</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Tr</span>(<span style="color:#e6db74">&#34;hi&#34;</span>, <span style="color:#e6db74">&#34;iris&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">locale</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">GetLocale</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Writef</span>(<span style="color:#e6db74">&#34;From the language %s translated output: %s&#34;</span>, <span style="color:#a6e22e">locale</span>.<span style="color:#a6e22e">Language</span>(), <span style="color:#a6e22e">hi</span>)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/some-path&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Writef</span>(<span style="color:#e6db74">&#34;%s&#34;</span>, <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Tr</span>(<span style="color:#e6db74">&#34;hi&#34;</span>, <span style="color:#e6db74">&#34;iris&#34;</span>))
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/other&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">language</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">GetLocale</span>().<span style="color:#a6e22e">Language</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fromFirstFileValue</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Tr</span>(<span style="color:#e6db74">&#34;key1&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">fromSecondFileValue</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Tr</span>(<span style="color:#e6db74">&#34;key2&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Writef</span>(<span style="color:#e6db74">&#34;From the language: %s, translated output:\n%s=%s\n%s=%s&#34;</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">language</span>, <span style="color:#e6db74">&#34;key1&#34;</span>, <span style="color:#a6e22e">fromFirstFileValue</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;key2&#34;</span>, <span style="color:#a6e22e">fromSecondFileValue</span>)
</span></span><span style="display:flex;"><span>    })
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// using in inside your views:
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">view</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">HTML</span>(<span style="color:#e6db74">&#34;./views&#34;</span>, <span style="color:#e6db74">&#34;.html&#34;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">RegisterView</span>(<span style="color:#a6e22e">view</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Get</span>(<span style="color:#e6db74">&#34;/templates&#34;</span>, <span style="color:#66d9ef">func</span>(<span style="color:#a6e22e">ctx</span> <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Context</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">View</span>(<span style="color:#e6db74">&#34;index.html&#34;</span>, <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">Map</span>{
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#34;tr&#34;</span>: <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">Tr</span>, <span style="color:#75715e">// word, arguments... {call .tr &#34;hi&#34; &#34;iris&#34;}}
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        })
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">if</span> <span style="color:#a6e22e">err</span> <span style="color:#f92672">!=</span> <span style="color:#66d9ef">nil</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">ctx</span>.<span style="color:#a6e22e">HTML</span>(<span style="color:#e6db74">&#34;&lt;h3&gt;%s&lt;/h3&gt;&#34;</span>, <span style="color:#a6e22e">err</span>.<span style="color:#a6e22e">Error</span>())
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">return</span>
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// Note that,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// Iris automatically adds a &#34;tr&#34; global template function as well,
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// the only difference is the way you call it inside your templates and
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>        <span style="color:#75715e">// that it accepts a language code as its first argument.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    })
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">app</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">main</span>() {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">app</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">newApp</span>()
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#75715e">// go to http://localhost:8080/el-gr/some-path
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// ^ (by path prefix)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// or http://el.mydomain.com8080/some-path
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// ^ (by subdomain - test locally with the hosts file)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// or http://localhost:8080/zh-CN/templates
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// ^ (by path prefix with uppercase)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// or http://localhost:8080/some-path?lang=el-GR
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// ^ (by url parameter)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// or http://localhost:8080 (default is en-US)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// or http://localhost:8080/?lang=zh-CN
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// go to http://localhost:8080/other?lang=el-GR
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// or http://localhost:8080/other (default is en-US)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// or http://localhost:8080/other?lang=en-US
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">//
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#75715e">// or use cookies to set the language.
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>    <span style="color:#a6e22e">app</span>.<span style="color:#a6e22e">Listen</span>(<span style="color:#e6db74">&#34;:8080&#34;</span>, <span style="color:#a6e22e">iris</span>.<span style="color:#a6e22e">WithSitemap</span>(<span style="color:#e6db74">&#34;http://localhost:8080&#34;</span>))
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="ç½‘ç«™åœ°å›¾httpswwwiris-gocomdocsidsitemap"><a href="https://www.iris-go.com/docs/#/?id=sitemap">ç½‘ç«™åœ°å›¾</a><a hidden class="anchor" aria-hidden="true" href="#ç½‘ç«™åœ°å›¾httpswwwiris-gocomdocsidsitemap">#</a></h3>
<p>ç«™ç‚¹åœ°å›¾ç¿»è¯‘ä¼šè‡ªåŠ¨è®¾ç½®ä¸ºæ¯ä¸ªè·¯ç”±ï¼Œå¦‚æœä¸º trueï¼Œåˆ™æŒ‰è·¯å¾„å‰ç¼€è®¾ç½®ï¼Œå¦‚æœä¸º trueï¼Œåˆ™æŒ‰å­åŸŸè‡ªåŠ¨è®¾ç½®ï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œåˆ™æŒ‰ URL æŸ¥è¯¢å‚æ•°è‡ªåŠ¨è®¾ç½®ã€‚<code>app.I18n.PathRedirect``app.I18n.Subdomain``app.I18n.URLParameter</code></p>
<p>é˜…è¯»æ›´å¤šï¼š <a href="https://support.google.com/webmasters/answer/189077?hl=en">https://support.google.com/webmasters/answer/189077?hl=en</a></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>GET http://localhost:8080/sitemap.xml
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34; standalone=&#34;yes&#34;?&gt;
</span></span><span style="display:flex;"><span>&lt;urlset xmlns=&#34;http://www.sitemaps.org/schemas/sitemap/0.9&#34; xmlns:xhtml=&#34;http://www.w3.org/1999/xhtml&#34;&gt;
</span></span><span style="display:flex;"><span>    &lt;url&gt;
</span></span><span style="display:flex;"><span>        &lt;loc&gt;http://localhost:8080/&lt;/loc&gt;
</span></span><span style="display:flex;"><span>        &lt;xhtml:link rel=&#34;alternate&#34; hreflang=&#34;en-US&#34; href=&#34;http://localhost:8080/&#34;&gt;&lt;/xhtml:link&gt;
</span></span><span style="display:flex;"><span>        &lt;xhtml:link rel=&#34;alternate&#34; hreflang=&#34;el-GR&#34; href=&#34;http://localhost:8080/el-GR/&#34;&gt;&lt;/xhtml:link&gt;
</span></span><span style="display:flex;"><span>        &lt;xhtml:link rel=&#34;alternate&#34; hreflang=&#34;zh-CN&#34; href=&#34;http://localhost:8080/zh-CN/&#34;&gt;&lt;/xhtml:link&gt;
</span></span><span style="display:flex;"><span>    &lt;/url&gt;
</span></span><span style="display:flex;"><span>    &lt;url&gt;
</span></span><span style="display:flex;"><span>        &lt;loc&gt;http://localhost:8080/some-path&lt;/loc&gt;
</span></span><span style="display:flex;"><span>        &lt;xhtml:link rel=&#34;alternate&#34; hreflang=&#34;en-US&#34; href=&#34;http://localhost:8080/some-path&#34;&gt;&lt;/xhtml:link&gt;
</span></span><span style="display:flex;"><span>        &lt;xhtml:link rel=&#34;alternate&#34; hreflang=&#34;el-GR&#34; href=&#34;http://localhost:8080/el-GR/some-path&#34;&gt;&lt;/xhtml:link&gt;
</span></span><span style="display:flex;"><span>        &lt;xhtml:link rel=&#34;alternate&#34; hreflang=&#34;zh-CN&#34; href=&#34;http://localhost:8080/zh-CN/some-path&#34;&gt;&lt;/xhtml:link&gt;
</span></span><span style="display:flex;"><span>    &lt;/url&gt;
</span></span><span style="display:flex;"><span>    &lt;url&gt;
</span></span><span style="display:flex;"><span>        &lt;loc&gt;http://localhost:8080/other&lt;/loc&gt;
</span></span><span style="display:flex;"><span>        &lt;xhtml:link rel=&#34;alternate&#34; hreflang=&#34;en-US&#34; href=&#34;http://localhost:8080/other&#34;&gt;&lt;/xhtml:link&gt;
</span></span><span style="display:flex;"><span>        &lt;xhtml:link rel=&#34;alternate&#34; hreflang=&#34;el-GR&#34; href=&#34;http://localhost:8080/el-GR/other&#34;&gt;&lt;/xhtml:link&gt;
</span></span><span style="display:flex;"><span>        &lt;xhtml:link rel=&#34;alternate&#34; hreflang=&#34;zh-CN&#34; href=&#34;http://localhost:8080/zh-CN/other&#34;&gt;&lt;/xhtml:link&gt;
</span></span><span style="display:flex;"><span>    &lt;/url&gt;
</span></span><span style="display:flex;"><span>    &lt;url&gt;
</span></span><span style="display:flex;"><span>        &lt;loc&gt;http://localhost:8080/templates&lt;/loc&gt;
</span></span><span style="display:flex;"><span>        &lt;xhtml:link rel=&#34;alternate&#34; hreflang=&#34;en-US&#34; href=&#34;http://localhost:8080/templates&#34;&gt;&lt;/xhtml:link&gt;
</span></span><span style="display:flex;"><span>        &lt;xhtml:link rel=&#34;alternate&#34; hreflang=&#34;el-GR&#34; href=&#34;http://localhost:8080/el-GR/templates&#34;&gt;&lt;/xhtml:link&gt;
</span></span><span style="display:flex;"><span>        &lt;xhtml:link rel=&#34;alternate&#34; hreflang=&#34;zh-CN&#34; href=&#34;http://localhost:8080/zh-CN/templates&#34;&gt;&lt;/xhtml:link&gt;
</span></span><span style="display:flex;"><span>    &lt;/url&gt;
</span></span><span style="display:flex;"><span>&lt;/urlset&gt;
</span></span></code></pre></div>

        </div>

        <footer class="post-footer">
            
<nav class="paginav">
  <a class="prev" href="https://liiqii.github.io/posts/tech/go/go_rpc/">
    <span class="title">Â« ä¸Šä¸€é¡µ</span>
    <br>
    <span>GO RPC å·¥ä½œåŸç†</span>
  </a>
  <a class="next" href="https://liiqii.github.io/posts/tech/go/go_interview_questions_quick_answer/">
    <span class="title">ä¸‹ä¸€é¡µ Â»</span>
    <br>
    <span>Go é¢è¯•é¢˜é›†é”¦å¿«ç­”</span>
  </a>
</nav>


<div class="share-buttons">
    <a target="_blank" rel="noopener noreferrer" aria-label="share Go æ¡†æ¶ Iris æ–‡æ¡£ on twitter"
       href="https://twitter.com/intent/tweet/?text=Go%20%e6%a1%86%e6%9e%b6%20Iris%20%e6%96%87%e6%a1%a3&amp;url=https%3a%2f%2fliiqii.github.io%2fposts%2ftech%2fgo%2fgo_iris%2f&amp;hashtags=Go%2cGo%e6%a1%86%e6%9e%b6">
    <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-253.927,424.544c135.939,0 210.268,-112.643 210.268,-210.268c0,-3.218 0,-6.437 -0.153,-9.502c14.406,-10.421 26.973,-23.448 36.935,-38.314c-13.18,5.824 -27.433,9.809 -42.452,11.648c15.326,-9.196 26.973,-23.602 32.49,-40.92c-14.252,8.429 -30.038,14.56 -46.896,17.931c-13.487,-14.406 -32.644,-23.295 -53.946,-23.295c-40.767,0 -73.87,33.104 -73.87,73.87c0,5.824 0.613,11.494 1.992,16.858c-61.456,-3.065 -115.862,-32.49 -152.337,-77.241c-6.284,10.881 -9.962,23.601 -9.962,37.088c0,25.594 13.027,48.276 32.95,61.456c-12.107,-0.307 -23.448,-3.678 -33.41,-9.196l0,0.92c0,35.862 25.441,65.594 59.311,72.49c-6.13,1.686 -12.72,2.606 -19.464,2.606c-4.751,0 -9.348,-0.46 -13.946,-1.38c9.349,29.426 36.628,50.728 68.965,51.341c-25.287,19.771 -57.164,31.571 -91.8,31.571c-5.977,0 -11.801,-0.306 -17.625,-1.073c32.337,21.15 71.264,33.41 112.95,33.41Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Go æ¡†æ¶ Iris æ–‡æ¡£ on linkedin"
       href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fliiqii.github.io%2fposts%2ftech%2fgo%2fgo_iris%2f&amp;title=Go%20%e6%a1%86%e6%9e%b6%20Iris%20%e6%96%87%e6%a1%a3&amp;summary=Go%20%e6%a1%86%e6%9e%b6%20Iris%20%e6%96%87%e6%a1%a3&amp;source=https%3a%2f%2fliiqii.github.io%2fposts%2ftech%2fgo%2fgo_iris%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-288.985,423.278l0,-225.717l-75.04,0l0,225.717l75.04,0Zm270.539,0l0,-129.439c0,-69.333 -37.018,-101.586 -86.381,-101.586c-39.804,0 -57.634,21.891 -67.617,37.266l0,-31.958l-75.021,0c0.995,21.181 0,225.717 0,225.717l75.02,0l0,-126.056c0,-6.748 0.486,-13.492 2.474,-18.315c5.414,-13.475 17.767,-27.434 38.494,-27.434c27.135,0 38.007,20.707 38.007,51.037l0,120.768l75.024,0Zm-307.552,-334.556c-25.674,0 -42.448,16.879 -42.448,39.002c0,21.658 16.264,39.002 41.455,39.002l0.484,0c26.165,0 42.452,-17.344 42.452,-39.002c-0.485,-22.092 -16.241,-38.954 -41.943,-39.002Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Go æ¡†æ¶ Iris æ–‡æ¡£ on reddit"
       href="https://reddit.com/submit?url=https%3a%2f%2fliiqii.github.io%2fposts%2ftech%2fgo%2fgo_iris%2f&title=Go%20%e6%a1%86%e6%9e%b6%20Iris%20%e6%96%87%e6%a1%a3">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-3.446,265.638c0,-22.964 -18.616,-41.58 -41.58,-41.58c-11.211,0 -21.361,4.457 -28.841,11.666c-28.424,-20.508 -67.586,-33.757 -111.204,-35.278l18.941,-89.121l61.884,13.157c0.756,15.734 13.642,28.29 29.56,28.29c16.407,0 29.706,-13.299 29.706,-29.701c0,-16.403 -13.299,-29.702 -29.706,-29.702c-11.666,0 -21.657,6.792 -26.515,16.578l-69.105,-14.69c-1.922,-0.418 -3.939,-0.042 -5.585,1.036c-1.658,1.073 -2.811,2.761 -3.224,4.686l-21.152,99.438c-44.258,1.228 -84.046,14.494 -112.837,35.232c-7.468,-7.164 -17.589,-11.591 -28.757,-11.591c-22.965,0 -41.585,18.616 -41.585,41.58c0,16.896 10.095,31.41 24.568,37.918c-0.639,4.135 -0.99,8.328 -0.99,12.576c0,63.977 74.469,115.836 166.33,115.836c91.861,0 166.334,-51.859 166.334,-115.836c0,-4.218 -0.347,-8.387 -0.977,-12.493c14.564,-6.47 24.735,-21.034 24.735,-38.001Zm-119.474,108.193c-20.27,20.241 -59.115,21.816 -70.534,21.816c-11.428,0 -50.277,-1.575 -70.522,-21.82c-3.007,-3.008 -3.007,-7.882 0,-10.889c3.003,-2.999 7.882,-3.003 10.885,0c12.777,12.781 40.11,17.317 59.637,17.317c19.522,0 46.86,-4.536 59.657,-17.321c3.016,-2.999 7.886,-2.995 10.885,0.008c3.008,3.011 3.003,7.882 -0.008,10.889Zm-5.23,-48.781c-16.373,0 -29.701,-13.324 -29.701,-29.698c0,-16.381 13.328,-29.714 29.701,-29.714c16.378,0 29.706,13.333 29.706,29.714c0,16.374 -13.328,29.698 -29.706,29.698Zm-160.386,-29.702c0,-16.381 13.328,-29.71 29.714,-29.71c16.369,0 29.689,13.329 29.689,29.71c0,16.373 -13.32,29.693 -29.689,29.693c-16.386,0 -29.714,-13.32 -29.714,-29.693Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Go æ¡†æ¶ Iris æ–‡æ¡£ on facebook"
       href="https://facebook.com/sharer/sharer.php?u=https%3a%2f%2fliiqii.github.io%2fposts%2ftech%2fgo%2fgo_iris%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-106.468,0l0,-192.915l66.6,0l12.672,-82.621l-79.272,0l0,-53.617c0,-22.603 11.073,-44.636 46.58,-44.636l36.042,0l0,-70.34c0,0 -32.71,-5.582 -63.982,-5.582c-65.288,0 -107.96,39.569 -107.96,111.204l0,62.971l-72.573,0l0,82.621l72.573,0l0,192.915l-191.104,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Go æ¡†æ¶ Iris æ–‡æ¡£ on whatsapp"
       href="https://api.whatsapp.com/send?text=Go%20%e6%a1%86%e6%9e%b6%20Iris%20%e6%96%87%e6%a1%a3%20-%20https%3a%2f%2fliiqii.github.io%2fposts%2ftech%2fgo%2fgo_iris%2f">
        <svg version="1.1" viewBox="0 0 512 512" xml:space="preserve">
            <path
                    d="M449.446,0c34.525,0 62.554,28.03 62.554,62.554l0,386.892c0,34.524 -28.03,62.554 -62.554,62.554l-386.892,0c-34.524,0 -62.554,-28.03 -62.554,-62.554l0,-386.892c0,-34.524 28.029,-62.554 62.554,-62.554l386.892,0Zm-58.673,127.703c-33.842,-33.881 -78.847,-52.548 -126.798,-52.568c-98.799,0 -179.21,80.405 -179.249,179.234c-0.013,31.593 8.241,62.428 23.927,89.612l-25.429,92.884l95.021,-24.925c26.181,14.28 55.659,21.807 85.658,21.816l0.074,0c98.789,0 179.206,-80.413 179.247,-179.243c0.018,-47.895 -18.61,-92.93 -52.451,-126.81Zm-126.797,275.782l-0.06,0c-26.734,-0.01 -52.954,-7.193 -75.828,-20.767l-5.441,-3.229l-56.386,14.792l15.05,-54.977l-3.542,-5.637c-14.913,-23.72 -22.791,-51.136 -22.779,-79.287c0.033,-82.142 66.867,-148.971 149.046,-148.971c39.793,0.014 77.199,15.531 105.329,43.692c28.128,28.16 43.609,65.592 43.594,105.4c-0.034,82.149 -66.866,148.983 -148.983,148.984Zm81.721,-111.581c-4.479,-2.242 -26.499,-13.075 -30.604,-14.571c-4.105,-1.495 -7.091,-2.241 -10.077,2.241c-2.986,4.483 -11.569,14.572 -14.182,17.562c-2.612,2.988 -5.225,3.364 -9.703,1.12c-4.479,-2.241 -18.91,-6.97 -36.017,-22.23c-13.314,-11.876 -22.304,-26.542 -24.916,-31.026c-2.612,-4.484 -0.279,-6.908 1.963,-9.14c2.016,-2.007 4.48,-5.232 6.719,-7.847c2.24,-2.615 2.986,-4.484 4.479,-7.472c1.493,-2.99 0.747,-5.604 -0.374,-7.846c-1.119,-2.241 -10.077,-24.288 -13.809,-33.256c-3.635,-8.733 -7.327,-7.55 -10.077,-7.688c-2.609,-0.13 -5.598,-0.158 -8.583,-0.158c-2.986,0 -7.839,1.121 -11.944,5.604c-4.105,4.484 -15.675,15.32 -15.675,37.364c0,22.046 16.048,43.342 18.287,46.332c2.24,2.99 31.582,48.227 76.511,67.627c10.685,4.615 19.028,7.371 25.533,9.434c10.728,3.41 20.492,2.929 28.209,1.775c8.605,-1.285 26.499,-10.833 30.231,-21.295c3.732,-10.464 3.732,-19.431 2.612,-21.298c-1.119,-1.869 -4.105,-2.99 -8.583,-5.232Z" />
        </svg>
    </a>
    <a target="_blank" rel="noopener noreferrer" aria-label="share Go æ¡†æ¶ Iris æ–‡æ¡£ on telegram"
       href="https://telegram.me/share/url?text=Go%20%e6%a1%86%e6%9e%b6%20Iris%20%e6%96%87%e6%a1%a3&amp;url=https%3a%2f%2fliiqii.github.io%2fposts%2ftech%2fgo%2fgo_iris%2f">
        <svg version="1.1" xml:space="preserve" viewBox="2 2 28 28">
            <path
                    d="M26.49,29.86H5.5a3.37,3.37,0,0,1-2.47-1,3.35,3.35,0,0,1-1-2.47V5.48A3.36,3.36,0,0,1,3,3,3.37,3.37,0,0,1,5.5,2h21A3.38,3.38,0,0,1,29,3a3.36,3.36,0,0,1,1,2.46V26.37a3.35,3.35,0,0,1-1,2.47A3.38,3.38,0,0,1,26.49,29.86Zm-5.38-6.71a.79.79,0,0,0,.85-.66L24.73,9.24a.55.55,0,0,0-.18-.46.62.62,0,0,0-.41-.17q-.08,0-16.53,6.11a.59.59,0,0,0-.41.59.57.57,0,0,0,.43.52l4,1.24,1.61,4.83a.62.62,0,0,0,.63.43.56.56,0,0,0,.4-.17L16.54,20l4.09,3A.9.9,0,0,0,21.11,23.15ZM13.8,20.71l-1.21-4q8.72-5.55,8.78-5.55c.15,0,.23,0,.23.16a.18.18,0,0,1,0,.06s-2.51,2.3-7.52,6.8Z" />
        </svg>
    </a>
</div>

        </footer>
    </div>

<style>
    .comments_details summary::marker {
        font-size: 20px;
        content: 'ğŸ‘‰å±•å¼€è¯„è®º';
        color: var(--content);
    }
    .comments_details[open] summary::marker{
        font-size: 20px;
        content: 'ğŸ‘‡å…³é—­è¯„è®º';
        color: var(--content);
    }
</style>


<div>
    <details class="comments_details">
        <summary style="cursor: pointer; margin: 50px 0 20px 0;width: 130px;">
            <span style="font-size: 20px;color: var(--content);">...</span>
        </summary>
        <div id="tcomment"></div>
    </details>
    <script src="https://cdn.staticfile.org/twikoo/1.5.8/twikoo.all.min.js">
    </script>
    <script>
        twikoo.init({
            envId:  null ,
        el: "#tcomment",
            lang: 'zh-CN',
            region:  null ,
        path: window.TWIKOO_MAGIC_PATH||window.location.pathname,
        })
    </script>
</div>
</article>
</main>

<footer class="footer">
    <span>
        &copy;
        -2023
        <a href="https://liiqii.github.io/" style="color:#939393;">liiqii</a>
    </span>
    
    <span>Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &amp;
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
    
</footer>












</body>

</html>
